<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="generator" content="pandoc" />

    <meta name="author" content="Eric Marcon" />
  
  
  <title>entropart</title>

    <script src="rd_files/jquery-1.11.3/jquery.min.js"></script>
  <link href="rd_files/bootstrap-3.3.2/css/bootstrap.min.css" rel="stylesheet" />
  <script src="rd_files/bootstrap-3.3.2/js/bootstrap.min.js"></script>
  <script src="rd_files/bootstrap-3.3.2/shim/html5shiv.min.js"></script>
  <script src="rd_files/bootstrap-3.3.2/shim/respond.min.js"></script>
  <link href="rd_files/highlight-8.4/tomorrow.css" rel="stylesheet" />
  <script src="rd_files/highlight-8.4/highlight.pack.js"></script>
  <link href="rd_files/fontawesome-4.3.0/css/font-awesome.min.css" rel="stylesheet" />
  <script src="rd_files/stickykit-1.1.1/sticky-kit.min.js"></script>
  <script src="rd_files/jqueryeasing-1.3/jquery.easing.min.js"></script>
  <link href="rd_files/recliner-0.2.2/recliner.css" rel="stylesheet" />
  <script src="rd_files/recliner-0.2.2/recliner.min.js"></script>
  <script src="rd_files/recliner-0.2.2/onload.js"></script>
  <link href="rd_files/packagedocs-0.0.1/pd.css" rel="stylesheet" />
  <script src="rd_files/packagedocs-0.0.1/pd.js"></script>
  <script src="rd_files/packagedocs-0.0.1/pd-sticky-toc.js"></script>
  
  
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>

<body>

  
  <header class="navbar navbar-white navbar-fixed-top" role="banner" id="header">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
                <a href="index.html" class="navbar-brand page-scroll">
        entropart - Entropy Partitioning to Measure Diversity
        </a>
      </div>
            <nav class="collapse navbar-collapse" role="navigation">
        <ul class="nav nav-pills pull-right">
<li>
<a href='index.html'>Docs</a>
</li>
<li class="active">
<a href='rd.html'>Package Ref</a>
</li>
<li>
<a href='https://github.com/EricMarcon/entropart'>Github<i class='fa fa-github'></i></a>
</li>
        </ul>
      </nav>
          </div>
  </header>

  <!-- Begin Body -->
  <div class="container">
    <div class="row">
            <div class="col-md-3" id="sidebar-col">
        <div id="toc">
          <ul>
          <li><a href="#summary">Summary</a><ul>
          <li><a href="#entropart-package-entropart-package-entropart">entropart-package: entropart-package, entropart</a></li>
          </ul></li>
          <li><a href="#datasets">Datasets</a><ul>
          <li><a href="#eightspabundance">EightSpAbundance</a></li>
          <li><a href="#eightsptree">EightSpTree</a></li>
          <li><a href="#paracou618.dist">Paracou618.dist</a></li>
          <li><a href="#paracou618.functional">Paracou618.Functional</a></li>
          <li><a href="#paracou618.mc">Paracou618.MC</a></li>
          <li><a href="#paracou618.taxonomy">Paracou618.Taxonomy</a></li>
          </ul></li>
          <li><a href="#generate-data">Generate data</a><ul>
          <li><a href="#rcommunity">rCommunity</a></li>
          </ul></li>
          <li><a href="#community-diversity">Community diversity</a><ul>
          <li><a href="#allenh">AllenH</a></li>
          <li><a href="#chaopd">ChaoPD</a></li>
          <li><a href="#communityprofile-communityprofile-as.communityprofile-is.communityprofile-plot.communityprofile-cenvelope">CommunityProfile: CommunityProfile, as.CommunityProfile, is.CommunityProfile, plot.CommunityProfile, CEnvelope</a></li>
          <li><a href="#coverage">Coverage</a></li>
          <li><a href="#diversity-diversity-bcdiversity-diversity.probavector-diversity.abdvector-diversity.integer-diversity.numeric">Diversity: Diversity, bcDiversity, Diversity.ProbaVector, Diversity.AbdVector, Diversity.integer, Diversity.numeric</a></li>
          <li><a href="#dqz-dqz-bcdqz-dqz.probavector-dqz.abdvector-dqz.integer-dqz.numeric">Dqz: Dqz, bcDqz, Dqz.ProbaVector, Dqz.AbdVector, Dqz.integer, Dqz.numeric</a></li>
          <li><a href="#gensimpson-gensimpson-bcgensimpson-gensimpson.probavector-gensimpson.abdvector-gensimpson.integer-gensimpson.numeric-gensimpsond-bcgensimpsond-gensimpsond.probavector-gensimpsond.abdvector-gensimpsond.integer-gensimpsond.numeric">GenSimpson: GenSimpson, bcGenSimpson, GenSimpson.ProbaVector, GenSimpson.AbdVector, GenSimpson.integer, GenSimpson.numeric, GenSimpsonD, bcGenSimpsonD, GenSimpsonD.ProbaVector, GenSimpsonD.AbdVector, GenSimpsonD.integer, GenSimpsonD.numeric</a></li>
          <li><a href="#hqz-hqz-bchqz-hqz.probavector-hqz.abdvector-hqz.integer-hqz.numeric">Hqz: Hqz, bcHqz, Hqz.ProbaVector, Hqz.AbdVector, Hqz.integer, Hqz.numeric</a></li>
          <li><a href="#hqzbeta-hqzbeta-bchqzbeta-hqzbeta.probavector-hqzbeta.abdvector-hqzbeta.integer-hqzbeta.numeric">HqzBeta: HqzBeta, bcHqzBeta, HqzBeta.ProbaVector, HqzBeta.AbdVector, HqzBeta.integer, HqzBeta.numeric</a></li>
          <li><a href="#hurlbert-hurlbert-bchurlbert-hurlbert.probavector-hurlbert.abdvector-hurlbert.integer-hurlbert.numeric-hurlbertd-bchurlbertd-hurlbertd.probavector-hurlbertd.abdvector-hurlbertd.integer-hurlbertd.numeric">Hurlbert: Hurlbert, bcHurlbert, Hurlbert.ProbaVector, Hurlbert.AbdVector, Hurlbert.integer, Hurlbert.numeric, HurlbertD, bcHurlbertD, HurlbertD.ProbaVector, HurlbertD.AbdVector, HurlbertD.integer, HurlbertD.numeric</a></li>
          <li><a href="#pdfd">PDFD</a></li>
          <li><a href="#phylobetaentropy-phylobetaentropy-bcphylobetaentropy-phylobetaentropy.probavector-phylobetaentropy.abdvector-phylobetaentropy.integer-phylobetaentropy.numeric">PhyloBetaEntropy: PhyloBetaEntropy, bcPhyloBetaEntropy, PhyloBetaEntropy.ProbaVector, PhyloBetaEntropy.AbdVector, PhyloBetaEntropy.integer, PhyloBetaEntropy.numeric</a></li>
          <li><a href="#phylodiversity-phylodiversity-bcphylodiversity-phylodiversity.probavector-phylodiversity.abdvector-phylodiversity.integer-phylodiversity.numeric-is.phylodiversity-summary.phylodiversity">PhyloDiversity: PhyloDiversity, bcPhyloDiversity, PhyloDiversity.ProbaVector, PhyloDiversity.AbdVector, PhyloDiversity.integer, PhyloDiversity.numeric, is.PhyloDiversity, summary.PhyloDiversity</a></li>
          <li><a href="#phyloentropy-phyloentropy-bcphyloentropy-phyloentropy.probavector-phyloentropy.abdvector-phyloentropy.integer-phyloentropy.numeric-is.phyloentropy-summary.phyloentropy">PhyloEntropy: PhyloEntropy, bcPhyloEntropy, PhyloEntropy.ProbaVector, PhyloEntropy.AbdVector, PhyloEntropy.integer, PhyloEntropy.numeric, is.PhyloEntropy, summary.PhyloEntropy</a></li>
          <li><a href="#rao-rao-bcrao-rao.probavector-rao.abdvector-rao.integer-rao.numeric">Rao: Rao, bcRao, Rao.ProbaVector, Rao.AbdVector, Rao.integer, Rao.numeric</a></li>
          <li><a href="#richness-bcrichness-richness-richness.probavector-richness.abdvector-richness.integer-richness.numeric">Richness: bcRichness, Richness, Richness.ProbaVector, Richness.AbdVector, Richness.integer, Richness.numeric</a></li>
          <li><a href="#shannon-bcshannon-shannon-shannon.probavector-shannon.abdvector-shannon.integer-shannon.numeric">Shannon: bcShannon, Shannon, Shannon.ProbaVector, Shannon.AbdVector, Shannon.integer, Shannon.numeric</a></li>
          <li><a href="#shannonbeta-shannonbeta-bcshannonbeta-shannonbeta.probavector-shannonbeta.abdvector-shannonbeta.integer-shannonbeta.numeric">ShannonBeta: ShannonBeta, bcShannonBeta, ShannonBeta.ProbaVector, ShannonBeta.AbdVector, ShannonBeta.integer, ShannonBeta.numeric</a></li>
          <li><a href="#simpson-simpson-bcsimpson-simpson.probavector-simpson.abdvector-simpson.integer-simpson.numeric">Simpson: Simpson, bcSimpson, Simpson.ProbaVector, Simpson.AbdVector, Simpson.integer, Simpson.numeric</a></li>
          <li><a href="#simpsonbeta-simpsonbeta-bcsimpsonbeta-simpsonbeta.probavector-simpsonbeta.abdvector-simpsonbeta.integer-simpsonbeta.numeric">SimpsonBeta: SimpsonBeta, bcSimpsonBeta, SimpsonBeta.ProbaVector, SimpsonBeta.AbdVector, SimpsonBeta.integer, SimpsonBeta.numeric</a></li>
          <li><a href="#tsallis-tsallis-bctsallis-tsallis.probavector-tsallis.abdvector-tsallis.integer-tsallis.numeric">Tsallis: Tsallis, bcTsallis, Tsallis.ProbaVector, Tsallis.AbdVector, Tsallis.integer, Tsallis.numeric</a></li>
          <li><a href="#tsallisbeta-tsallisbeta-bctsallisbeta-tsallisbeta.probavector-tsallisbeta.abdvector-tsallisbeta.integer-tsallisbeta.numeric">TsallisBeta: TsallisBeta, bcTsallisBeta, TsallisBeta.ProbaVector, TsallisBeta.AbdVector, TsallisBeta.integer, TsallisBeta.numeric</a></li>
          </ul></li>
          <li><a href="#metacommunity">Metacommunity</a><ul>
          <li><a href="#alphadiversity">AlphaDiversity</a></li>
          <li><a href="#alphaentropy">AlphaEntropy</a></li>
          <li><a href="#betadiversity">BetaDiversity</a></li>
          <li><a href="#betaentropy">BetaEntropy</a></li>
          <li><a href="#divest-divest-is.divest-plot.divest-summary.divest">DivEst: DivEst, is.DivEst, plot.DivEst, summary.DivEst</a></li>
          <li><a href="#divpart-divpart-is.divpart-plot.divpart-summary.divpart">DivPart: DivPart, is.DivPart, plot.DivPart, summary.DivPart</a></li>
          <li><a href="#divprofile-divprofile-is.divprofile-plot.divprofile-summary.divprofile">DivProfile: DivProfile, is.DivProfile, plot.DivProfile, summary.DivProfile</a></li>
          <li><a href="#gammadiversity">GammaDiversity</a></li>
          <li><a href="#gammaentropy">GammaEntropy</a></li>
          </ul></li>
          <li><a href="#metacommunity-utilities">Metacommunity utilities</a><ul>
          <li><a href="#mergemc-mergemc-mergec-shufflemc">MergeMC: MergeMC, MergeC, ShuffleMC</a></li>
          <li><a href="#metacommunity-metacommunity-is.metacommunity-plot.metacommunity-summary.metacommunity">MetaCommunity: MetaCommunity, is.MetaCommunity, plot.MetaCommunity, summary.MetaCommunity</a></li>
          </ul></li>
          <li><a href="#classes">Classes</a><ul>
          <li><a href="#mcdiversity-mcdiversity-is.mcdiversity-plot.mcdiversity-summary.mcdiversity">MCdiversity: MCdiversity, is.MCdiversity, plot.MCdiversity, summary.MCdiversity</a></li>
          <li><a href="#mcentropy-mcentropy-is.mcentropy-plot.mcentropy-summary.mcentropy">MCentropy: MCentropy, is.MCentropy, plot.MCentropy, summary.MCentropy</a></li>
          <li><a href="#phylovalue-phylovalue-is.phylovalue-plot.phylovalue-summary.phylovalue">PhyloValue: PhyloValue, is.PhyloValue, plot.PhyloValue, summary.PhyloValue</a></li>
          <li><a href="#pptree-pptree-is.pptree-plot.pptree">PPtree: PPtree, is.PPtree, plot.PPtree</a></li>
          <li><a href="#simtest-simtest-as.simtest-is.simtest-plot.simtest-summary.simtest">SimTest: SimTest, as.SimTest, is.SimTest, plot.SimTest, summary.SimTest</a></li>
          <li><a href="#speciesdistribution-speciesdistribution-as.speciesdistribution-as.speciesdistribution.data.frame-as.speciesdistribution.integer-as.speciesdistribution.numeric-is.speciesdistribution-plot.speciesdistribution-abdvector-as.abdvector-as.abdvector.data.frame-as.abdvector.integer-as.abdvector.numeric-is.abdvector-probavector-as.probavector-as.probavector.data.frame-as.probavector.integer-as.probavector.numeric-is.probavector">SpeciesDistribution: SpeciesDistribution, as.SpeciesDistribution, as.SpeciesDistribution.data.frame, as.SpeciesDistribution.integer, as.SpeciesDistribution.numeric, is.SpeciesDistribution, plot.SpeciesDistribution, AbdVector, as.AbdVector, as.AbdVector.data.frame, as.AbdVector.integer, as.AbdVector.numeric, is.AbdVector, ProbaVector, as.ProbaVector, as.ProbaVector.data.frame, as.ProbaVector.integer, as.ProbaVector.numeric, is.ProbaVector</a></li>
          </ul></li>
          <li><a href="#arithmetics">Arithmetics</a><ul>
          <li><a href="#enq">Enq</a></li>
          <li><a href="#klq">KLq</a></li>
          <li><a href="#expq-expq-expq.communityprofile">expq: expq, expq.CommunityProfile</a></li>
          <li><a href="#lnq-lnq-lnq.communityprofile">lnq: lnq, lnq.CommunityProfile</a></li>
          </ul></li>
          <li><a href="#utilities">Utilities</a><ul>
          <li><a href="#abdfreqcount">AbdFreqCount</a></li>
          <li><a href="#entropyci">EntropyCI</a></li>
          <li><a href="#mergeandlabel">mergeandlabel</a></li>
          <li><a href="#optimal.similarity">Optimal.Similarity</a></li>
          <li><a href="#phyloapply">PhyloApply</a></li>
          <li><a href="#preprocess.mc">Preprocess.MC</a></li>
          </ul></li>
          </ul>
        </div>
      </div>
      <div class="col-md-9" id="content-col">
      
<div id="content-top"></div>
<h1>
Entropy Partitioning to Measure Diversity
</h1>
<p>
<strong>Authors:</strong> <a href="mailto:eric.marcon@ecofog.gf">Eric Marcon</a> [aut, cre],<a href="mailto:bruno.herault@cirad.fr">Bruno Herault</a> [aut]
</p>
<p>
<strong>Version:</strong> 1.4-8.9007
</p>
<p>
<strong>License:</strong> GNU General Public License
</p>
<h4>
Description
</h4>
<p>
Measurement and partitioning of diversity, based on Tsallis entropy.
</p>
<h4>
Imports
</h4>
<p>
ade4, ape, EntropyEstimation, geiger, graphics, grDevices, parallel, stats, utils, vegan
</p>
<h4>
Suggests
</h4>
<p>
testthat, knitr, rmarkdown, packagedocs
</p>
<div id="summary" class="section level1">
<h1>Summary</h1>
<div id="entropart-package-entropart-package-entropart" class="section level2">
<h2>entropart-package: entropart-package, entropart</h2>
<a id="entropart-package_alias"></a>
<h3>
Entropy Partitioning to Measure Diversity
</h3>
<p class="rd-p">
Functions to calculate alpha, beta and gamma diversity of communities, including phylogenetic and functional diversity. Estimation-bias corrections are available.
</p>
<h4>
Details
</h4>
<p class="rd-p">
</p>
<p class="rd-p">
In the entropart package, individuals of different “species” are counted in several “communities” which may (or not) be agregated to define a “metacommunity”. In the metacommunity, the probability to find a species in the weighted average of probabilities in communities. This is a naming convention, which may correspond to plots in a forest inventory or any data organized the same way.
</p>
<p class="rd-p">
Basic functions allow computing diversity of a community. Data is simply a vector of probabilities (summing up to 1) or of abundances (integer values that are numbers of individuals). Calculate entropy with functions such as <code><a href=#tsallis>Tsallis</a></code>, <code><a href=#shannon>Shannon</a></code>, <code><a href=#simpson>Simpson</a></code>, <code><a href=#hurlbert>Hurlbert</a></code> or <code><a href=#gensimpson>GenSimpson</a></code> and explicit diversity (i.e. effective number of species) with <code><a href=#diversity>Diversity</a></code> and others. By default, the best available estimator of diversity will be used, according to the data.
</p>
<p class="rd-p">
Communities can be simulated by <code><a href=#rcommunity>rCommunity</a></code>, explicitely declared as a species distribution (<code><a href=#speciesdistribution>as.AbdVector</a></code> or <code><a href=#speciesdistribution>as.ProbaVector</a></code>), and plotted.
</p>
<p class="rd-p">
Phylogenetic entropy and diversity can be calculated if a phylogenetic (or functional), ultrametric tree is provided. See <code><a href=#phyloentropy>PhyloEntropy</a></code>, <code><a href=#rao>Rao</a></code> for examples of entropy and <code><a href=#phylodiversity>PhyloDiversity</a></code> to calculate phylodiversity, with the state-of-the-art estimation-bias correction. Similarity-based diversity is calculated with <code><a href=#dqz>Dqz</a></code>, based on a similarity matrix.
</p>
<p class="rd-p">
The simplest way to import data is to organize it into two text files. The first file should contain abundance data: the first column named <code>Species</code> for species names, and a column for each community.
</p>
<p class="rd-p">
The second file should contain the community weights in two columns. The first one, named <code>Communities</code> should contain their names and the second one, named <code>Weights</code>, their weights.
</p>
<p class="rd-p">
Files can be read and data imported by code such as:
</p>
<p class="rd-p">
<pre>
Abundances <- read.csv(file="Abundances.csv", row.names = 1)
Weights <- read.csv(file="Weights.csv")
MC <- MetaCommunity(Abundances, Weights)
</pre>
</p>
<p class="rd-p">
The last line of the code calls the <code><a href=#metacommunity>MetaCommunity</a></code> function to create an object that will be used by all metacommunity functions, such as <code><a href=#divpart>DivPart</a></code> (to partition diversity), <code><a href=#divest>DivEst</a></code> (to partition diversity and calculate confidence interval of its estimation) or <code><a href=#divprofile>DivProfile</a></code> (to compute diversity profiles).
</p>
<p class="rd-p">
A full documentation is available in the vignette. Type: <code>vignette(“entropart”)</code>. A quick introuction is in <code>vignette(“introduction”, “entropart”)</code>.
</p>
<p class="rd-p">
</p>
<h4>
References
</h4>
<p class="rd-p">
Grabchak, M., Marcon, E., Lang, G., and Zhang, Z. (2017). The Generalized Simpsons Entropy is a Measure of Biodiversity. <em>Plos One</em>, 12(3): e0173305.
</p>
<p class="rd-p">
Marcon, E. (2015) Practical Estimation of Diversity from Abundance Data. <em>HAL</em> 01212435: 1-27.
</p>
<p class="rd-p">
Marcon, E. and Herault, B. (2015). entropart: An R Package to Measure and Partition Diversity. <em>Journal of Statistical Software</em>, 67(8): 1-26.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannons Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Author
</h4>
<p>Eric Marcon, Bruno Herault</p>
</div>
</div>
<div id="datasets" class="section level1">
<h1>Datasets</h1>
<div id="eightspabundance" class="section level2">
<h2>EightSpAbundance</h2>
<a id="EightSpAbundance_alias"></a>
<h3>
Abundances of 8 species to run examples.
</h3>
<p class="rd-p">
This dataset is a light-weight example.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>data(Paracou618)</div></code></pre>
<h4>
Format
</h4>
<p class="rd-p">
A named vector.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>data(Paracou618)
EightSpAbundance</code></pre>
<pre><code>##  Sr Ess  Me  S1  Bg  Ef  Vm  Dg 
## 284 228 139  91 173 169 141 221</code></pre>
</div>
<div id="eightsptree" class="section level2">
<h2>EightSpTree</h2>
<a id="EightSpTree_alias"></a>
<h3>
Functional tree with 8 species.
</h3>
<p class="rd-p">
This dataset is a light-weight example.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>data(Paracou618)</div></code></pre>
<h4>
Format
</h4>
<p class="rd-p">
An object of class <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> containing a functional tree.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>data(Paracou618)
plot(EightSpTree)</code></pre>
<p><img src="rd_files/figure-html/EightSpTree_id_3-1.png" width="624" /></p>
</div>
<div id="paracou618.dist" class="section level2">
<h2>Paracou618.dist</h2>
<a id="Paracou618.dist_alias"></a>
<h3>
Functional distances between pairs of species of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.
</h3>
<p class="rd-p">
This dataset is from Paracou field station, French Guiana, managed by <a href = 'http://www.cirad.fr'>Cirad</a>. Traits are detailed in Marcon and Herault (2014), the distance matrix was built following Paine et al. (2011).
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>data(Paracou618)</div></code></pre>
<h4>
Format
</h4>
<p class="rd-p">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/dist>dist</a></code>.
</p>
<h4>
Source
</h4>
<p class="rd-p">
Permanent data census of Paracou.
</p>
<h4>
References
</h4>
<p class="rd-p">
Gourlet-Fleury, S., Guehl, J. M. and Laroussinie, O., Eds. (2004). <em>Ecology &amp; management of a neotropical rainforest. Lessons drawn from Paracou, a long-term experimental research site in French Guiana</em>. Paris, Elsevier.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Paine, C. E. T., Baraloto, C., Chave, J., and Herault, B. (2011). Functional traits of individual trees reveal ecological constraints on community assembly in tropical rain forests. <em>Oikos</em>, 120(5), 720-727.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>data(Paracou618)
plot(density(Paracou618.dist, from=0), main=&quot;Distances between species&quot;)</code></pre>
<p><img src="rd_files/figure-html/Paracou618.dist_id_4-1.png" width="624" /></p>
</div>
<div id="paracou618.functional" class="section level2">
<h2>Paracou618.Functional</h2>
<a id="Paracou618.Functional_alias"></a>
<h3>
Functional tree of species of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.
</h3>
<p class="rd-p">
This dataset is from Paracou field station, French Guiana, managed by <a href = 'http://www.cirad.fr'>Cirad</a>. Traits are detailed in Marcon and Herault (2014), the tree was built following Paine et al. (2011), based on <code><a href='Paracou618.dist.html'>Paracou618.dist</a></code>.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>data(Paracou618)</div></code></pre>
<h4>
Format
</h4>
<p class="rd-p">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>.
</p>
<h4>
Source
</h4>
<p class="rd-p">
Permanent data census of Paracou.
</p>
<h4>
References
</h4>
<p class="rd-p">
Gourlet-Fleury, S., Guehl, J. M. and Laroussinie, O., Eds. (2004). <em>Ecology &amp; management of a neotropical rainforest. Lessons drawn from Paracou, a long-term experimental research site in French Guiana</em>. Paris, Elsevier.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Paine, C. E. T., Baraloto, C., Chave, J., and Herault, B. (2011). Functional traits of individual trees reveal ecological constraints on community assembly in tropical rain forests. <em>Oikos</em>, 120(5), 720-727.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>data(Paracou618)
plot(Paracou618.Functional)</code></pre>
<p><img src="rd_files/figure-html/Paracou618.Functional_id_5-1.png" width="624" /></p>
</div>
<div id="paracou618.mc" class="section level2">
<h2>Paracou618.MC</h2>
<a id="Paracou618.MC_alias"></a>
<h3>
Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.
</h3>
<p class="rd-p">
This dataset is from Paracou field station, French Guiana, managed by <a href = 'http://www.cirad.fr'>Cirad</a>.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>data(Paracou618)</div></code></pre>
<h4>
Format
</h4>
<p class="rd-p">
An object of class <code><a href=#metacommunity>MetaCommunity</a></code> made of two communities and 425 species.
</p>
<h4>
Source
</h4>
<p class="rd-p">
Permanent data census of Paracou and Marcon et al. (2012).
</p>
<h4>
References
</h4>
<p class="rd-p">
Gourlet-Fleury, S., Guehl, J. M. and Laroussinie, O., Eds. (2004). <em>Ecology &amp; management of a neotropical rainforest. Lessons drawn from Paracou, a long-term experimental research site in French Guiana</em>. Paris, Elsevier.
</p>
<p class="rd-p">
Marcon, E., F. Puech, et al. (2012). Characterizing the relative spatial structure of point patterns. <em>International Journal of Ecology</em> 2012(Article ID 619281): 11.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>data(Paracou618)
summary(Paracou618.MC)</code></pre>
<pre><code>## Meta-community (class &#39;MetaCommunity&#39;) made of 1124 individuals in 2 
## communities and 425 species. 
## 
## Its sample coverage is 0.92266748426447 
## 
## Community weights are: 
## [1] 0.5720641 0.4279359
## Community sample numbers of individuals are: 
## P006 P018 
##  643  481 
## Community sample coverages are: 
##      P006      P018 
## 0.8943859 0.8463782</code></pre>
</div>
<div id="paracou618.taxonomy" class="section level2">
<h2>Paracou618.Taxonomy</h2>
<a id="Paracou618.Taxonomy_alias"></a>
<h3>
Taxonomy (Family - Genus - Species) of Paracou field station plots 6 and 18, two 1-ha plots inventoried by the Bridge project.
</h3>
<p class="rd-p">
This dataset is from Paracou field station, French Guiana, managed by <a href = 'http://www.cirad.fr'>Cirad</a>.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>data(Paracou618)</div></code></pre>
<h4>
Format
</h4>
<p class="rd-p">
An object of class <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code> containing a taxonomy.
</p>
<h4>
Source
</h4>
<p class="rd-p">
Permanent data census of Paracou.
</p>
<h4>
References
</h4>
<p class="rd-p">
Gourlet-Fleury, S., Guehl, J. M. and Laroussinie, O., Eds. (2004). <em>Ecology &amp; management of a neotropical rainforest. Lessons drawn from Paracou, a long-term experimental research site in French Guiana</em>. Paris, Elsevier.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>data(Paracou618)
plot(Paracou618.Taxonomy, type=&quot;fan&quot;, show.tip.label=FALSE)</code></pre>
<p><img src="rd_files/figure-html/Paracou618.Taxonomy_id_7-1.png" width="624" /></p>
</div>
</div>
<div id="generate-data" class="section level1">
<h1>Generate data</h1>
<div id="rcommunity" class="section level2">
<h2>rCommunity</h2>
<a id="rCommunity_alias"></a>
<h3>
Random Communities
</h3>
<p class="rd-p">
Draws random communities according to a probability distribution.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>rCommunity(n, size&nbsp;=&nbsp;sum(NorP), NorP&nbsp;=&nbsp;1, BootstrapMethod&nbsp;=&nbsp;"Chao2015", S&nbsp;=&nbsp;300,  Distribution&nbsp;=&nbsp;"lnorm",  sd&nbsp;=&nbsp;1, prob&nbsp;=&nbsp;0.1, alpha&nbsp;=&nbsp;40, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
n
</dt>
<dd class="rd-dd">
The number of communities to draw.
</dd>
<dt>
size
</dt>
<dd class="rd-dd">
The number of individuals to draw in each community.
</dd>
<dt>
BootstrapMethod
</dt>
<dd class="rd-dd">
The method used to obtain the probabilities to generate bootstrapped communities from observed abundances. If <code>“Marcon”</code>, the probabilities are simply the abundances divided by the total number of individuals (Marcon <em>et al.</em>, 2012). If <code>“Chao2013”</code> or <code>“Chao2015”</code> (by default), a more sophisticated approach is used (see <code><a href=#speciesdistribution>as.ProbaVector</a></code>) following Chao <em>et al.</em> (2013) or Chao <em>et al.</em> (2015).
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector or a two-column matrix. Contains either abundances or probabilities. Two-column matrices should contain the observed abundances (or probabilities) in the first column and the expected ones in the second column, to allow using beta diversity functions.
</dd>
<dt>
S
</dt>
<dd class="rd-dd">
The number of species.
</dd>
<dt>
Distribution
</dt>
<dd class="rd-dd">
The distribution of species frequencies. May be <code>“lnorm”</code> (log-normal), <code>“lseries”</code> (log-series), <code>“geom”</code> (geometric) or <code>“bstick”</code> (broken stick).
</dd>
<dt>
sd
</dt>
<dd class="rd-dd">
The simulated distribution standard deviation. For the log-normal distribution, this is the standard deviation on the log scale.
</dd>
<dt>
prob
</dt>
<dd class="rd-dd">
The probability of success in each trial.
</dd>
<dt>
alpha
</dt>
<dd class="rd-dd">
Fishers alpha.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Communities of fixed <code>size</code> are drawn in a multinomial distribution according to the distribution of probabilities provided by <code>NorP</code>.
</p>
<p class="rd-p">
An abundance vector may be used instead of probabilities, then <code>size</code> is by default the total number of individuals in the vector. Random communities are built by drawing in a multinomial law following Marcon <em>et al.</em> (2012), or trying to estimate the distribution of the actual community with <code><a href=#speciesdistribution>as.ProbaVector</a></code>. If <code>BootstrapMethod = “Chao2013”</code>, the distribution is estimated by a single parameter model and unobserved species are given equal probabilities. If <code>BootstrapMethod = “Chao2015”</code>, a two-parameter model is used and unobserved species follow a geometric distribution.
</p>
<p class="rd-p">
Alternatively, the probabilities may be drawn following a classical distribution: either a lognormal (<code>“lnorm”</code>) one (Preston, 1948) with given standard deviation (<code>sd</code>; note that the mean is actually a normalizing constant. Its values is set equal to 0 for the simulation of the normal distribution of unnormalized log-abundances), a log-series (<code>“lseries”</code>) one (Fisher <em>et al.</em>, 1943) with parameter <code>alpha</code>, a geometric (<code>“geom”</code>) one (Motomura, 1932) with parameter <code>prob</code>, or a broken stick (<code>“bstick”</code>) one (MacArthur, 1957). The number of simulated species is fixed by <code>S</code>, except for <code>“lseries”</code> where it is obtained from <code>alpha</code> and <code>size</code>: <span class="math inline">$S=\alpha \ln(1 + \frac{size}{\alpha})$</span>.
</p>
<p class="rd-p">
Log-normal, log-series and broken-stick distributions are stochastic. The geometric distribution is completely determined by its parameters.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A vector of species abundances (<code><a href=#speciesdistribution>AbdVector</a></code>) if a single community has been drawn, or a <code><a href=#metacommunity>MetaCommunity</a></code> containing simulated communities.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11): 1091-1100.
</p>
<p class="rd-p">
Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<p class="rd-p">
Fisher R.A., Corbet A.S., Williams C.B. (1943) The Relation Between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population. <em>Journal of Animal Ecology</em> 12: 42-58.
</p>
<p class="rd-p">
MacArthur R.H. (1957) On the Relative Abundance of Bird Species. <em>PNAS</em> 43(3): 293-295.
</p>
<p class="rd-p">
Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannons Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p class="rd-p">
Motomura I. (1932) On the statistical treatment of communities. <em>Zoological Magazine</em> 44: 379-383.
</p>
<p class="rd-p">
Preston, F.W. (1948). The commonness, and rarity, of species. <em>Ecology</em> 29(3): 254-283.
</p>
<p class="rd-p">
Reese G. C., Wilson K. R., Flather C. H. (2013) Program SimAssem: Software for simulating species assemblages and estimating species richness. <em>Methods in Ecology and Evolution</em> 4: 891-896.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Generate communities made of 100000 individuals among 300 species and fit them
par(mfrow = c(2,2))
for (d in c(&quot;lnorm&quot;, &quot;lseries&quot;, &quot;geom&quot;, &quot;bstick&quot;)) {  
rCommunity(n = 1, size = 1E5, S = 300, Distribution = d) -&gt; AbdVec
plot(AbdVec, Distribution = d, main = d)
}</code></pre>
<p><img src="rd_files/figure-html/rCommunity_id_8-1.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#speciesdistribution>SpeciesDistribution</a></code> and the program <code>SimAssem</code> (Reese <em>et al.</em>, 2013; not an R package) for more distributions.</p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
</div>
<div id="community-diversity" class="section level1">
<h1>Community diversity</h1>
<div id="allenh" class="section level2">
<h2>AllenH</h2>
<a id="AllenH_alias"></a>
<h3>
Phylogenetic Entropy of a Community
</h3>
<p class="rd-p">
Calculates the phylogenetic diversity of order <span class="math inline"><em>q</em></span> of a probability vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>AllenH(Ps, q&nbsp;=&nbsp;1, PhyloTree, Normalize&nbsp;=&nbsp;TRUE, Prune&nbsp;=&nbsp;FALSE, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of entropy. Default is 1.
</dd>
<dt>
PhyloTree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree is not necessarily ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), diversity is not affected by the height of the tree. If <code>FALSE</code>, it is proportional to the height of the tree.
</dd>
<dt>
Prune
</dt>
<dd class="rd-dd">
What to do when somes species are in the tree but not in <code>Ps</code>? If <code>TRUE</code>, the tree is pruned to keep species of <code>Ps</code> only. The height of the tree may be changed if a pruned branch is related to the root. If <code>FALSE</code> (default), species with probability 0 are added in <code>Ps</code>.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The phylogenetic entropy is calculated following Allen <em>et al.</em> (2009) for order <span class="math inline"><em>q</em> = 1</span> and Leinster and Cobold (2011) for other orders.The result is identical to the total entropy calculated by <code><a href=#phyloentropy>PhyloEntropy</a></code> but it is much faster. A single value is returned instead of a <code><a href=#phyloentropy>PhyloEntropy</a></code> object, and no bias correction is available.
</p>
<p class="rd-p">
The <code>Normalize</code> argument allows normalizing entropy by the height of the tree, similarly to <code><a href=#chaopd>ChaoPD</a></code>.
</p>
<p class="rd-p">
Diversity can be calculated for non ultrametric trees following Leinster and Cobold (2011) even though the meaning of the result is not so clear.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal the entropy of the community. The name is “None” to recall that no bias correction is available.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Allen, B., Kon, M. and Bar-Yam, Y. (2009). A New Phylogenetic Diversity Measure Generalizing the Shannon Index and Its Application to Phyllostomid Bats. <em>American Naturalist</em> 174(2): 236-243.
</p>
<p class="rd-p">
Leinster, T. and Cobbold, C. (2011). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)

# Calculate the phylogenetic Shannon diversity of the plot
AllenH(Ps, 1, Paracou618.Taxonomy, Normalize=TRUE)</code></pre>
<pre><code>##     None 
## 3.919941</code></pre>
<pre class="r"><code># Calculate it using PhyloEntropy: more powerful but much slower is the tree has many periods
PhyloEntropy(Ps, 1, Paracou618.Taxonomy, Normalize=TRUE) -&gt; phyE
summary(phyE)</code></pre>
<pre><code>## alpha or gamma phylogenetic or functional entropy of order 1 
## of distribution 
## structure(c(0.00266903914590747, 0, 0.00266903914590747, 0.00355871886120996,  
## 0.000889679715302491, 0.00177935943060498, 0, 0, 0, 0.00177935943060498,  
## 0, 0.0355871886120996, 0, 0, 0.000889679715302491, 0.00533807829181495,  
## 0.00533807829181495, 0.000889679715302491, 0.00177935943060498,  
## 0.000889679715302491, 0.00355871886120997, 0, 0, 0.00266903914590747,  
## 0, 0.00177935943060498, 0, 0.000889679715302491, 0.00355871886120996,  
## 0.000889679715302491, 0.0124555160142349, 0.00355871886120997,  
## 0.00444839857651246, 0, 0, 0.000889679715302491, 0, 0, 0, 0,  
## 0.00177935943060498, 0, 0, 0, 0, 0, 0, 0.00711743772241993, 0.00266903914590747,  
## 0.00177935943060498, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.00355871886120996, 0, 0.00355871886120996, 0.00177935943060498,  
## 0.00800711743772242, 0, 0.00355871886120996, 0, 0.000889679715302491,  
## 0.00444839857651246, 0.000889679715302491, 0.00177935943060498,  
## 0.00266903914590747, 0, 0.000889679715302491, 0.000889679715302491,  
## 0, 0.000889679715302491, 0.000889679715302491, 0, 0, 0, 0.0160142348754448,  
## 0.0186832740213523, 0.00622775800711744, 0, 0.0186832740213523,  
## 0.00177935943060498, 0, 0.00711743772241993, 0.00177935943060498,  
## 0, 0.00444839857651246, 0, 0.000889679715302491, 0.00355871886120997,  
## 0.00177935943060498, 0, 0, 0.0124555160142349, 0.000889679715302491,  
## 0.0097864768683274, 0, 0.0231316725978648, 0.000889679715302491,  
## 0.00533807829181495, 0.0249110320284698, 0.00444839857651246,  
## 0.00444839857651246, 0.00177935943060498, 0.000889679715302491,  
## 0.000889679715302491, 0, 0.00177935943060498, 0, 0, 0.00177935943060498,  
## 0, 0.000889679715302491, 0.0231316725978648, 0.000889679715302491,  
## 0.00800711743772242, 0.000889679715302491, 0, 0, 0.00266903914590747,  
## 0.000889679715302491, 0, 0.00177935943060498, 0, 0.00533807829181495,  
## 0.00177935943060498, 0.00444839857651246, 0.0097864768683274,  
## 0.000889679715302491, 0.000889679715302491, 0.00800711743772242,  
## 0, 0.000889679715302491, 0.0275800711743772, 0.0338078291814947,  
## 0.00177935943060498, 0.00177935943060498, 0, 0.00622775800711744,  
## 0.000889679715302491, 0.0115658362989324, 0, 0.000889679715302491,  
## 0.000889679715302491, 0.00177935943060498, 0.0400355871886121,  
## 0.0222419928825623, 0, 0, 0, 0.000889679715302491, 0, 0, 0, 0,  
## 0, 0.000889679715302491, 0, 0, 0.000889679715302491, 0.00177935943060498,  
## 0, 0, 0.00622775800711744, 0.00266903914590747, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0.00177935943060498,  
## 0, 0, 0, 0.000889679715302491, 0.000889679715302491, 0, 0, 0,  
## 0.00444839857651246, 0, 0, 0.00266903914590747, 0.000889679715302491,  
## 0.00266903914590747, 0, 0, 0, 0.00177935943060498, 0, 0, 0.00177935943060498,  
## 0, 0.00889679715302491, 0, 0.00177935943060498, 0.000889679715302491,  
## 0.00177935943060498, 0.000889679715302491, 0, 0.00177935943060498,  
## 0.00355871886120996, 0, 0, 0, 0, 0, 0.000889679715302491, 0,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000889679715302491, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0, 0, 0, 0,  
## 0.000889679715302491, 0, 0, 0, 0, 0.00177935943060498, 0, 0,  
## 0.00355871886120996, 0.00177935943060498, 0.000889679715302491,  
## 0.000889679715302491, 0.00711743772241993, 0, 0, 0.00355871886120997,  
## 0.0293594306049822, 0.0204626334519573, 0, 0, 0, 0, 0.0275800711743772,  
## 0, 0, 0.0258007117437722, 0.00177935943060498, 0.00177935943060498,  
## 0.0097864768683274, 0.000889679715302491, 0, 0.0160142348754448,  
## 0.00355871886120997, 0, 0.00444839857651246, 0, 0.000889679715302491,  
## 0, 0.00444839857651246, 0.00177935943060498, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0, 0, 0.00177935943060498, 0.00266903914590747, 0, 0, 0.00266903914590747,  
## 0.00266903914590747, 0.00711743772241993, 0, 0.000889679715302491,  
## 0.00444839857651246, 0, 0.000889679715302491, 0.00533807829181495,  
## 0.000889679715302491, 0.0177935943060498, 0.000889679715302491,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.00355871886120997, 0, 0.00177935943060498,  
## 0, 0, 0, 0, 0.00266903914590747, 0.000889679715302491, 0, 0,  
## 0.000889679715302491, 0, 0.0124555160142349, 0.0231316725978648,  
## 0, 0.00266903914590747, 0, 0, 0.000889679715302491, 0, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0.000889679715302491,  
## 0, 0, 0.00533807829181495, 0, 0, 0, 0.00266903914590747, 0.000889679715302491,  
## 0, 0, 0, 0.000889679715302491, 0, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.00266903914590747, 0, 0, 0.00177935943060498, 0.000889679715302491,  
## 0, 0.000889679715302491, 0.00266903914590747, 0, 0.000889679715302491,  
## 0.00177935943060498, 0, 0, 0, 0.00177935943060498, 0.00177935943060498,  
## 0.000889679715302491, 0, 0.00177935943060498, 0.00266903914590747,  
## 0, 0.00444839857651246, 0, 0, 0.00355871886120997, 0.000889679715302491,  
## 0, 0, 0.000889679715302491, 0.000889679715302491, 0.00355871886120996,  
## 0, 0, 0.00177935943060498, 0.00355871886120996, 0, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.00177935943060498, 0.00355871886120996,  
## 0, 0.00177935943060498, 0, 0, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.0133451957295374, 0.000889679715302491, 0.000889679715302491,  
## 0, 0.00177935943060498, 0, 0, 0, 0, 0, 0, 0, 0, 0.0097864768683274,  
## 0, 0.00800711743772242, 0.000889679715302491, 0, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.00266903914590747, 0.00177935943060498,  
## 0, 0.00355871886120996, 0.000889679715302491, 0.00177935943060498,  
## 0, 0, 0.000889679715302491, 0, 0.00444839857651246), class = c(&quot;ProbaVector&quot;,  
## &quot;SpeciesDistribution&quot;, &quot;numeric&quot;), .Names = c(&quot;Anac_Anac_spru&quot;,  
## &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;, &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;,  
## &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;, &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;,  
## &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;, &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;,  
## &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;, &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;,  
## &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;, &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;,  
## &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;, &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;,  
## &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;, &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;,  
## &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;, &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;,  
## &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;, &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;,  
## &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;, &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;,  
## &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;, &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;,  
## &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;, &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;,  
## &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;, &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;,  
## &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;, &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;,  
## &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;, &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;,  
## &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;, &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;,  
## &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;, &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;,  
## &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;, &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;,  
## &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;, &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;,  
## &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;, &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;,  
## &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;, &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;,  
## &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;, &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;,  
## &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;, &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;,  
## &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;, &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;,  
## &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;, &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;,  
## &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;, &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;,  
## &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;, &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;,  
## &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;, &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;,  
## &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;, &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;,  
## &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;, &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;,  
## &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;, &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;,  
## &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;, &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;,  
## &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;, &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;,  
## &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;, &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;,  
## &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;, &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;,  
## &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;, &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;,  
## &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;, &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;,  
## &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;, &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;,  
## &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;, &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;,  
## &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;, &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;,  
## &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;, &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;,  
## &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;, &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;,  
## &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;, &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;,  
## &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;, &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;,  
## &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;, &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;,  
## &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;, &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;,  
## &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;, &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;,  
## &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;, &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;,  
## &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;, &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;,  
## &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;, &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;,  
## &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;, &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;,  
## &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;, &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;,  
## &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;, &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;,  
## &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;, &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;,  
## &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;, &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;,  
## &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;, &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;,  
## &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;, &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;,  
## &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;, &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;,  
## &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;, &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;,  
## &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;, &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;,  
## &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;, &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;,  
## &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;, &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;,  
## &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;, &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;,  
## &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;, &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;,  
## &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;, &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;,  
## &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;, &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;,  
## &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;, &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;,  
## &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;, &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;,  
## &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;, &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;,  
## &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;, &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;,  
## &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;, &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;,  
## &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;, &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;,  
## &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;, &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;,  
## &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;, &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;,  
## &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;, &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;,  
## &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;, &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;,  
## &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;, &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;,  
## &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;, &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;,  
## &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;, &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;,  
## &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;, &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;,  
## &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;, &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;,  
## &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;, &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;,  
## &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;, &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;,  
## &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;, &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;,  
## &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;, &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;,  
## &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;, &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;,  
## &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;, &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;,  
## &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;, &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;,  
## &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;, &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;,  
## &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;, &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;,  
## &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;, &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;,  
## &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;, &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;,  
## &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;, &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;,  
## &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;, &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;,  
## &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;, &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;,  
## &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;, &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;,  
## &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;, &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;,  
## &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;, &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;,  
## &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;, &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;,  
## &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;, &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;,  
## &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;, &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;,  
## &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;, &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;,  
## &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;, &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;,  
## &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;, &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;,  
## &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;, &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;,  
## &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;, &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot; ))
##  with correction: None
## Phylogenetic or functional entropy was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Entropy is normalized
## 
## Entropy equals: 3.919941</code></pre>
<h4>
See also
</h4>
<p><code><a href=#phyloentropy>PhyloEntropy</a></code>, <code><a href=#chaopd>ChaoPD</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="chaopd" class="section level2">
<h2>ChaoPD</h2>
<a id="ChaoPD_alias"></a>
<h3>
Phylogenetic Diversity of a Community
</h3>
<p class="rd-p">
Calculates the phylogenetic diversity of order <span class="math inline"><em>q</em></span> of a probability vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>ChaoPD(Ps, q&nbsp;=&nbsp;1, PhyloTree, Normalize&nbsp;=&nbsp;TRUE, Prune&nbsp;=&nbsp;FALSE, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1.
</dd>
<dt>
PhyloTree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree is not necessarily ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), diversity is not affected by the height of the tree. If <code>FALSE</code>, it is proportional to the height of the tree.
</dd>
<dt>
Prune
</dt>
<dd class="rd-dd">
What to do when somes species are in the tree but not in <code>Ps</code>? If <code>TRUE</code>, the tree is pruned to keep species of <code>Ps</code> only. The height of the tree may be changed if a pruned branch is related to the root. If <code>FALSE</code> (default), species with probability 0 are added in <code>Ps</code>.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The phylogenetic diversity is calculated following Chao <em>et al.</em> (2010). The result is identical to the total diversity calculated by <code><a href=#phylodiversity>PhyloDiversity</a></code> but it is much faster. A single value is returned instead of a <code><a href=#phylodiversity>PhyloDiversity</a></code> object, and no bias correction is available.
</p>
<p class="rd-p">
The <code>Normalize</code> arguments allows calculating either <span class="math inline">$^{q}\bar{D}(T)$</span> (if <code>TRUE</code>) or <span class="math inline"><em></em><sup><em>q</em></sup><em>P</em><em>D</em>(<em>T</em>)</span> if <code>FALSE</code>.
</p>
<p class="rd-p">
Diversity can be calculated for non ultrametric trees following Chao <em>et al.</em> (2010) even though the meaning of the result is not so clear (Leinster and Cobold, 2011).
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal the diversity of the community. The name is “None” to recall that no bias correction is available.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Chao, A., Chiu, C.-H. and Jost, L. (2010). Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society B</em> 365(1558): 3599-609.
</p>
<p class="rd-p">
Leinster, T. and Cobbold, C. (2011). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps

# Calculate the phylogenetic Simpson diversity of the plot
(ChaoPD(Paracou618.MC$Ps, 2, Paracou618.Taxonomy, Normalize=TRUE))</code></pre>
<pre><code>##     None 
## 24.61698</code></pre>
<pre class="r"><code># Calculate it using PhyloDiversity
# (more powerful but much slower if the tree has many periods)
PhyloDiversity(Paracou618.MC$Ps, 2, Paracou618.Taxonomy, Normalize=TRUE) -&gt; phyD
summary(phyD)</code></pre>
<pre><code>## alpha or gamma phylogenetic or functional diversity of order 2 
## of distribution 
## Paracou618.MC$structure(c(0.00266903914590747, 0, 0.00266903914590747,  
## 0.00355871886120996, 0.000889679715302491, 0.00177935943060498,  
## 0, 0, 0, 0.00177935943060498, 0, 0.0355871886120996, 0, 0, 0.000889679715302491,  
## 0.00533807829181495, 0.00533807829181495, 0.000889679715302491,  
## 0.00177935943060498, 0.000889679715302491, 0.00355871886120997,  
## 0, 0, 0.00266903914590747, 0, 0.00177935943060498, 0, 0.000889679715302491,  
## 0.00355871886120996, 0.000889679715302491, 0.0124555160142349,  
## 0.00355871886120997, 0.00444839857651246, 0, 0, 0.000889679715302491,  
## 0, 0, 0, 0, 0.00177935943060498, 0, 0, 0, 0, 0, 0, 0.00711743772241993,  
## 0.00266903914590747, 0.00177935943060498, 0.000889679715302491,  
## 0, 0.000889679715302491, 0.00355871886120996, 0, 0.00355871886120996,  
## 0.00177935943060498, 0.00800711743772242, 0, 0.00355871886120996,  
## 0, 0.000889679715302491, 0.00444839857651246, 0.000889679715302491,  
## 0.00177935943060498, 0.00266903914590747, 0, 0.000889679715302491,  
## 0.000889679715302491, 0, 0.000889679715302491, 0.000889679715302491,  
## 0, 0, 0, 0.0160142348754448, 0.0186832740213523, 0.00622775800711744,  
## 0, 0.0186832740213523, 0.00177935943060498, 0, 0.00711743772241993,  
## 0.00177935943060498, 0, 0.00444839857651246, 0, 0.000889679715302491,  
## 0.00355871886120997, 0.00177935943060498, 0, 0, 0.0124555160142349,  
## 0.000889679715302491, 0.0097864768683274, 0, 0.0231316725978648,  
## 0.000889679715302491, 0.00533807829181495, 0.0249110320284698,  
## 0.00444839857651246, 0.00444839857651246, 0.00177935943060498,  
## 0.000889679715302491, 0.000889679715302491, 0, 0.00177935943060498,  
## 0, 0, 0.00177935943060498, 0, 0.000889679715302491, 0.0231316725978648,  
## 0.000889679715302491, 0.00800711743772242, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.000889679715302491, 0, 0.00177935943060498,  
## 0, 0.00533807829181495, 0.00177935943060498, 0.00444839857651246,  
## 0.0097864768683274, 0.000889679715302491, 0.000889679715302491,  
## 0.00800711743772242, 0, 0.000889679715302491, 0.0275800711743772,  
## 0.0338078291814947, 0.00177935943060498, 0.00177935943060498,  
## 0, 0.00622775800711744, 0.000889679715302491, 0.0115658362989324,  
## 0, 0.000889679715302491, 0.000889679715302491, 0.00177935943060498,  
## 0.0400355871886121, 0.0222419928825623, 0, 0, 0, 0.000889679715302491,  
## 0, 0, 0, 0, 0, 0.000889679715302491, 0, 0, 0.000889679715302491,  
## 0.00177935943060498, 0, 0, 0.00622775800711744, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0, 0, 0.00177935943060498, 0, 0, 0, 0.000889679715302491, 0.000889679715302491,  
## 0, 0, 0, 0.00444839857651246, 0, 0, 0.00266903914590747, 0.000889679715302491,  
## 0.00266903914590747, 0, 0, 0, 0.00177935943060498, 0, 0, 0.00177935943060498,  
## 0, 0.00889679715302491, 0, 0.00177935943060498, 0.000889679715302491,  
## 0.00177935943060498, 0.000889679715302491, 0, 0.00177935943060498,  
## 0.00355871886120996, 0, 0, 0, 0, 0, 0.000889679715302491, 0,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000889679715302491, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0, 0, 0, 0,  
## 0.000889679715302491, 0, 0, 0, 0, 0.00177935943060498, 0, 0,  
## 0.00355871886120996, 0.00177935943060498, 0.000889679715302491,  
## 0.000889679715302491, 0.00711743772241993, 0, 0, 0.00355871886120997,  
## 0.0293594306049822, 0.0204626334519573, 0, 0, 0, 0, 0.0275800711743772,  
## 0, 0, 0.0258007117437722, 0.00177935943060498, 0.00177935943060498,  
## 0.0097864768683274, 0.000889679715302491, 0, 0.0160142348754448,  
## 0.00355871886120997, 0, 0.00444839857651246, 0, 0.000889679715302491,  
## 0, 0.00444839857651246, 0.00177935943060498, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0, 0, 0.00177935943060498, 0.00266903914590747, 0, 0, 0.00266903914590747,  
## 0.00266903914590747, 0.00711743772241993, 0, 0.000889679715302491,  
## 0.00444839857651246, 0, 0.000889679715302491, 0.00533807829181495,  
## 0.000889679715302491, 0.0177935943060498, 0.000889679715302491,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.00355871886120997, 0, 0.00177935943060498,  
## 0, 0, 0, 0, 0.00266903914590747, 0.000889679715302491, 0, 0,  
## 0.000889679715302491, 0, 0.0124555160142349, 0.0231316725978648,  
## 0, 0.00266903914590747, 0, 0, 0.000889679715302491, 0, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0.000889679715302491,  
## 0, 0, 0.00533807829181495, 0, 0, 0, 0.00266903914590747, 0.000889679715302491,  
## 0, 0, 0, 0.000889679715302491, 0, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.00266903914590747, 0, 0, 0.00177935943060498, 0.000889679715302491,  
## 0, 0.000889679715302491, 0.00266903914590747, 0, 0.000889679715302491,  
## 0.00177935943060498, 0, 0, 0, 0.00177935943060498, 0.00177935943060498,  
## 0.000889679715302491, 0, 0.00177935943060498, 0.00266903914590747,  
## 0, 0.00444839857651246, 0, 0, 0.00355871886120997, 0.000889679715302491,  
## 0, 0, 0.000889679715302491, 0.000889679715302491, 0.00355871886120996,  
## 0, 0, 0.00177935943060498, 0.00355871886120996, 0, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.00177935943060498, 0.00355871886120996,  
## 0, 0.00177935943060498, 0, 0, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.0133451957295374, 0.000889679715302491, 0.000889679715302491,  
## 0, 0.00177935943060498, 0, 0, 0, 0, 0, 0, 0, 0, 0.0097864768683274,  
## 0, 0.00800711743772242, 0.000889679715302491, 0, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.00266903914590747, 0.00177935943060498,  
## 0, 0.00355871886120996, 0.000889679715302491, 0.00177935943060498,  
## 0, 0, 0.000889679715302491, 0, 0.00444839857651246), .Names = c(&quot;Anac_Anac_spru&quot;,  
## &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;, &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;,  
## &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;, &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;,  
## &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;, &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;,  
## &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;, &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;,  
## &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;, &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;,  
## &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;, &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;,  
## &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;, &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;,  
## &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;, &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;,  
## &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;, &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;,  
## &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;, &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;,  
## &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;, &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;,  
## &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;, &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;,  
## &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;, &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;,  
## &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;, &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;,  
## &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;, &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;,  
## &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;, &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;,  
## &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;, &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;,  
## &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;, &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;,  
## &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;, &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;,  
## &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;, &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;,  
## &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;, &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;,  
## &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;, &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;,  
## &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;, &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;,  
## &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;, &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;,  
## &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;, &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;,  
## &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;, &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;,  
## &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;, &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;,  
## &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;, &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;,  
## &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;, &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;,  
## &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;, &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;,  
## &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;, &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;,  
## &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;, &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;,  
## &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;, &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;,  
## &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;, &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;,  
## &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;, &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;,  
## &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;, &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;,  
## &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;, &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;,  
## &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;, &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;,  
## &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;, &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;,  
## &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;, &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;,  
## &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;, &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;,  
## &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;, &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;,  
## &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;, &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;,  
## &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;, &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;,  
## &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;, &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;,  
## &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;, &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;,  
## &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;, &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;,  
## &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;, &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;,  
## &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;, &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;,  
## &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;, &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;,  
## &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;, &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;,  
## &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;, &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;,  
## &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;, &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;,  
## &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;, &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;,  
## &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;, &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;,  
## &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;, &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;,  
## &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;, &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;,  
## &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;, &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;,  
## &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;, &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;,  
## &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;, &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;,  
## &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;, &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;,  
## &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;, &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;,  
## &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;, &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;,  
## &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;, &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;,  
## &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;, &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;,  
## &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;, &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;,  
## &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;, &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;,  
## &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;, &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;,  
## &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;, &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;,  
## &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;, &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;,  
## &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;, &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;,  
## &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;, &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;,  
## &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;, &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;,  
## &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;, &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;,  
## &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;, &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;,  
## &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;, &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;,  
## &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;, &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;,  
## &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;, &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;,  
## &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;, &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;,  
## &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;, &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;,  
## &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;, &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;,  
## &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;, &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;,  
## &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;, &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;,  
## &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;, &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;,  
## &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;, &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;,  
## &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;, &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;,  
## &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;, &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;,  
## &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;, &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;,  
## &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;, &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;,  
## &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;, &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;,  
## &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;, &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;,  
## &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;, &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;,  
## &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;, &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;,  
## &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;, &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;,  
## &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;, &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;,  
## &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;, &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;,  
## &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;, &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;,  
## &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;, &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;,  
## &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;, &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;,  
## &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;, &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;,  
## &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;, &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;,  
## &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;, &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;,  
## &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;, &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;,  
## &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;, &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;,  
## &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;, &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;,  
## &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;, &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot; ))
##  with correction: None
## Phylogenetic or functional diversity was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Diversity is normalized
## 
## Diversity equals: 24.61698</code></pre>
<h4>
See also
</h4>
<p><code><a href=#phylodiversity>PhyloDiversity</a></code>, <code><a href=#allenh>AllenH</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="communityprofile-communityprofile-as.communityprofile-is.communityprofile-plot.communityprofile-cenvelope" class="section level2">
<h2>CommunityProfile: CommunityProfile, as.CommunityProfile, is.CommunityProfile, plot.CommunityProfile, CEnvelope</h2>
<a id="CommunityProfile_alias"></a>
<h3>
Diversity or Entropy Profile of a community
</h3>
<p class="rd-p">
Calculates the diversity or entropy profile of a community, applying a community function to a vector of orders.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>CommunityProfile(FUN, NorP, q.seq&nbsp;=&nbsp;seq(0, 2, 0.1),  NumberOfSimulations&nbsp;=&nbsp;0, Alpha&nbsp;=&nbsp;0.05, BootstrapMethod&nbsp;=&nbsp;"Chao2015",  size&nbsp;=&nbsp;1, ..., CheckArguments&nbsp;=&nbsp;TRUE)
as.CommunityProfile(x, y, low&nbsp;=&nbsp;NULL, high&nbsp;=&nbsp;NULL)
is.CommunityProfile(x)
"plot"(x, ..., main&nbsp;=&nbsp;NULL,  xlab&nbsp;=&nbsp;"Order of Diversity", ylab&nbsp;=&nbsp;"Diversity", ylim&nbsp;=&nbsp;NULL, LineWidth&nbsp;=&nbsp;2, ShadeColor&nbsp;=&nbsp;"grey75", BorderColor&nbsp;=&nbsp;"red")
CEnvelope(Profile, LineWidth&nbsp;=&nbsp;2, ShadeColor&nbsp;=&nbsp;"grey75", BorderColor&nbsp;=&nbsp;"red", ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
FUN
</dt>
<dd class="rd-dd">
The function to be applied to each value of <span class="math inline"><em>q</em>.<em>s</em><em>e</em><em>q</em></span>. Any function accepting a numeric vector (or a two-column matrix) and a number as first two arguments and an argument named <code>CheckArguments</code> is acceptable (other arguments of the functions are passed by <code>…</code>). See <em>Details</em> for useful entropy and diversity functions and <em>Examples</em> for an ad-hoc one.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector. Contains either abundances or probabilities.
</dd>
<dt>
q.seq
</dt>
<dd class="rd-dd">
A numeric vector: the sequence of diversity orders to address. Default is from 0 to 2.
</dd>
<dt>
NumberOfSimulations
</dt>
<dd class="rd-dd">
The number of simulations to run, 0 by default.
</dd>
<dt>
Alpha
</dt>
<dd class="rd-dd">
The risk level, 5% by default.
</dd>
<dt>
BootstrapMethod
</dt>
<dd class="rd-dd">
The method used to obtain the probabilities to generate bootstrapped communities from observed abundances. See <code><a href=#rcommunity>rCommunity</a></code>.
</dd>
<dt>
size
</dt>
<dd class="rd-dd">
The size of simulated communities used to compute the bootstrap confidence envelope. 1 (default) means that the actual size must be used.
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted or the vector of orders of community profiles in <code>as.CommunityProfile</code>.
</dd>
<dt>
y
</dt>
<dd class="rd-dd">
Entropy or diversity values of each order, corresponding to <code>x</code> values.
</dd>
<dt>
low
</dt>
<dd class="rd-dd">
Entropy or diversity lower bound of the confidence envelope, corresponding to <code>x</code> values.
</dd>
<dt>
high
</dt>
<dd class="rd-dd">
Entropy or diversity higher bound of the confidence envelope, corresponding to <code>x</code> values.
</dd>
<dt>
Profile
</dt>
<dd class="rd-dd">
An <code>CommunityProfile</code> to be plotted.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to <code>FUN</code> in <code>CommunityProfile</code>, to <code>plot</code> in <code>plot.CommunityProfile</code> or to <code>lines</code> in <code>CEnvelope</code>.
</dd>
<dt>
main
</dt>
<dd class="rd-dd">
The main title of the plot.
</dd>
<dt>
xlab
</dt>
<dd class="rd-dd">
The x axis label of the plots.
</dd>
<dt>
ylab
</dt>
<dd class="rd-dd">
The y axis label of the plot.
</dd>
<dt>
ylim
</dt>
<dd class="rd-dd">
The interval of y values plotted.
</dd>
<dt>
LineWidth
</dt>
<dd class="rd-dd">
The width of the line that represents the actual profile.
</dd>
<dt>
ShadeColor
</dt>
<dd class="rd-dd">
The color of the shaded confidence envelope.
</dd>
<dt>
BorderColor
</dt>
<dd class="rd-dd">
The color of the bounds of the confidence envelope.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The function <code>CommunityProfile</code> is used to calculate diversity or entropy profiles based on community functions such as <code><a href=#tsallis>Tsallis</a></code> or <code><a href=#chaopd>ChaoPD</a></code>. The first two arguments of the function must be a probability or abundance vector and a number (<span class="math inline"><em>q</em></span>). Additional arguments cannot be checked. Unexpected results may be returned if <code>FUN</code> is not used properly.
</p>
<p class="rd-p">
If <code>NumberOfSimulations</code> is greater than 0, a bootstrap confidence interval is produced by simulating communities with <code><a href=#rcommunity>rCommunity</a></code> and calculating their profiles. The size of those communities may be that of the actual community or specified by <code>size</code>.
</p>
<p class="rd-p">
<code>CommunityProfile</code> objects can be plotted. They can also be added to the current plot by <code>CEnvelope</code>.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A <code>CommunityProfile</code>, which is a list:
<dt>
x
</dt>
<dd>
The order <span class="math inline"><em>q</em></span> values
</dd>
</p>
<p class="rd-p">
<dt>
y
</dt>
<dd>
The entropy or diversity values returned by <code>FUN</code>
</dd>
</p>
<p class="rd-p">
<dt>
low
</dt>
<dd>
The lower bound of the confidence interval
</dd>
</p>
<p class="rd-p">
<dt>
high
</dt>
<dd>
The upper bound of the confidence interval
</dd>
</p>
<p class="rd-p">
</dl>
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Plot diversity estimated without bias correction
plot(CommunityProfile(Diversity, Paracou618.MC$Ps, seq(0, 2, 0.2)), 
lty=3, ylim=c(50, 350))
# Estimate diversity, with a condidence envelope 
# (only 10 simulations to save time, should be 1000)
Profile &lt;- CommunityProfile(Diversity, as.AbdVector(Paracou618.MC$Ns), 
          seq(0, 2, 0.2), Correction=&quot;UnveilJ&quot;, NumberOfSimulations=10)</code></pre>
<pre><code>## ===========================================================================</code></pre>
<pre class="r"><code># Complete the plot, and add the legend
CEnvelope(Profile, main=&quot;Paracou Plots Diversity&quot;)
legend(&quot;topright&quot;, c(&quot;Bias Corrected&quot;, &quot;Biased&quot;), lty=c(1,3), inset=0.01)</code></pre>
<p><img src="rd_files/figure-html/CommunityProfile_id_11-1.png" width="624" /></p>
<pre class="r"><code># Advanced use with beta-diversity functions :
# Profile of the beta entropy of the first community of Paracou618.
# Observed and expected probabilities are bound into a 2-column matrix
# An intermediate function is necessary to separate them before calling TsallisBeta
# The CheckArguments is mandatory but does not need to be set: CommunityProfile() sets it to FALSE
CommunityProfile(function(PandPexp, q, CheckArguments) 
  {TsallisBeta(PandPexp[, 1], PandPexp[, 2], q)}, 
  NorP=cbind(Paracou618.MC$Psi[, 1], Paracou618.MC$Ps), q.seq=seq(0, 2, 0.2))</code></pre>
<pre><code>## $x
##  [1] 0.0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0
## 
## $y
##  [1] 53.42961065 16.60496236  5.55701448  2.02871915  0.80974134
##  [6]  0.34993577  0.16100624  0.07750741  0.03849038  0.01952232
## [11]  0.01004705
## 
## attr(,&quot;class&quot;)
## [1] &quot;CommunityProfile&quot;</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a>, Bruno Herault <a href="mailto:Bruno.Herault@ecofog.gf">Bruno.Herault@ecofog.gf</a></p>
</div>
<div id="coverage" class="section level2">
<h2>Coverage</h2>
<a id="Coverage_alias"></a>
<h3>
Sample coverage of a community
</h3>
<p class="rd-p">
Calculates an estimator of the sample coverage of a community described by its abundance vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Coverage(Ns, Estimator&nbsp;=&nbsp;"ZhangHuang", CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
Estimator
</dt>
<dd class="rd-dd">
A string containing one of the possible estimators: <code>“ZhangHuang”</code> (default), <code>“Chao”</code>, <code>“Turing”</code>.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The sample coverage <span class="math inline"><em>C</em></span> of a community is the total probability of occurence of the species observed in the sample. <span class="math inline">1 − <em>C</em></span> is the probability for an individual of the whole community to belong to a species that has not been sampled.
</p>
<p class="rd-p">
The historical estimator is due to Turing (Good, 1953). It only relies on singletons (species observed only once). Chaos (Chao and Shen, 2010) estimator uses doubletons too and Zhang-Huangs (Chao et al., 1988; Zhang and Huang, 2007) uses the whole distribution.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated sample coverage. The name is that of the estimator used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Chao, A., Lee, S.-M. and Chen, T.-C. (1988). A generalized Goods nonparametric coverage estimator. <em>Chinese Journal of Mathematics</em> 16: 189-199.
</p>
<p class="rd-p">
Chao, A. and Shen, T.-J. (2010). <em>Program SPADE: Species Prediction And Diversity Estimation. Program and users guide</em>. CARE, Hsin-Chu, Taiwan.
</p>
<p class="rd-p">
Good, I. J. (1953). On the Population Frequency of Species and the Estimation of Population Parameters. <em>Biometrika</em> 40(3/4): 237-264.
</p>
<p class="rd-p">
Zhang, Z. and Huang, H. (2007). Turings formula revisited. <em>Journal of Quantitative Linguistics</em> 14(2-3): 222-241.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the vector of abundances of the metacommunity
Ns &lt;- Paracou618.MC$Ns
# Calculate the sample coverage of the metacommunity
Coverage(Ns)    # Stored in Paracou618.SampleCoverage</code></pre>
<pre><code>## ZhangHuang 
##  0.9226675</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="diversity-diversity-bcdiversity-diversity.probavector-diversity.abdvector-diversity.integer-diversity.numeric" class="section level2">
<h2>Diversity: Diversity, bcDiversity, Diversity.ProbaVector, Diversity.AbdVector, Diversity.integer, Diversity.numeric</h2>
<a id="Diversity_alias"></a>
<h3>
HCDT diversity of a community
</h3>
<p class="rd-p">
Calculates the HCDT (generalized) diversity of order <span class="math inline"><em>q</em></span> of a probability vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Diversity(NorP, q&nbsp;=&nbsp;1, ...)
bcDiversity(Ns, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"Diversity"(NorP, q&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"Diversity"(NorP, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Diversity"(NorP, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Diversity"(NorP, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: <code>“None”</code> (no correction), <code>“ChaoShen”</code>, <code>“GenCov”</code>, <code>“Grassberger”</code>, <code>“Holste”</code>, <code>“Bonachela”</code>, <code>“ZhangGrabchak”</code>, or <code>“ChaoWangJost”</code>, <code>“Marcon”</code>, <code>“UnveilC”</code>, <code>“UnveiliC”</code>, <code>“UnveilJ”</code> or <code>“Best”</code>, the default value. Currently, <code>“Best”</code> is <code>“ChaoWangJost”</code>.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
<code>Diversity</code> calls <code><a href=#tsallis>Tsallis</a></code> to calculate entropy and transforms it into diversity by calculating its deformed exponential.
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcDiversity</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Diversity</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcDiversity</code> is called. Explicit calls to <code>bcDiversity</code> (with bias correction) or to <code>Diversity.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated diversity. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)</code></pre>
<p><img src="rd_files/figure-html/Diversity_id_13-1.png" width="624" /></p>
<pre class="r"><code># Calculate diversity of order 1, i.e. Shannon&#39;s diversity
Diversity(Ps, 1)</code></pre>
<pre><code>##   None 
## 113.98</code></pre>
<pre class="r"><code># Calculate it with estimation bias correction
Diversity(Ns, 1)</code></pre>
<pre><code>## ChaoWangJost 
##     133.2409</code></pre>
<h4>
See also
</h4>
<p><code><a href=#tsallis>Tsallis</a></code>, <code><a href=#expq>expq</a></code>, <code><a href=#speciesdistribution>AbdVector</a></code>, <code><a href=#speciesdistribution>ProbaVector</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="dqz-dqz-bcdqz-dqz.probavector-dqz.abdvector-dqz.integer-dqz.numeric" class="section level2">
<h2>Dqz: Dqz, bcDqz, Dqz.ProbaVector, Dqz.AbdVector, Dqz.integer, Dqz.numeric</h2>
<a id="Dqz_alias"></a>
<h3>
Similarity-based diversity of a community
</h3>
<p class="rd-p">
Calculates the diversity of order <span class="math inline"><em>q</em></span> of a probability vector according to a similarity matrix.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Dqz(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), ...)
bcDqz(Ns, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(Ns)), Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"Dqz"(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"Dqz"(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Dqz"(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Dqz"(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1. Default is the identity matrix to calculate neutral diversity.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: <code>“None”</code> (no correction), <code>“HorvitzThomson”</code>, <code>“MarconZhang”</code> or <code>“Best”</code>, the default value. The <code>“MarconZhang”</code> correction assumes a similarity matrix.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Diversity is calculated following Leinster and Cobbold (2012): it is the reciprocal of the (generalized) average (of order <code>q</code>) of the community species ordinariness.
</p>
<p class="rd-p">
A similarity matrix is used (as for <code><a href=#dqz>Dqz</a></code>), not a distance matrix as in Ricotta and Szeidl (2006). See the example.
</p>
<p class="rd-p">
Bias correction requires the number of individuals. Use <code>bcHqz</code> and choose the <code>Correction</code>. Correction techniques are from Marcon <em>et al.</em> (2014).
</p>
<p class="rd-p">
Currently, the <code>“Best”</code> correction is the max value of <code>“HorvitzThomson”</code> and <code>“MarconZhang”</code>.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Dqz</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcDqz</code> is called. Explicit calls to <code>bcDqz</code> (with bias correction) or to <code>Dqz.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated diversity. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Leinster, T. and Cobbold, C. (2012). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Prepare the similarity matrix
DistanceMatrix &lt;- as.matrix(Paracou618.dist)
# Similarity can be 1 minus normalized distances between species
Z &lt;- 1 - DistanceMatrix/max(DistanceMatrix)
# Calculate diversity of order 2
Dqz(Paracou618.MC$Ns, 2, Z)</code></pre>
<pre><code>##    Best 
## 1.48295</code></pre>
<h4>
See also
</h4>
<p><code><a href=#hqz>Hqz</a></code>, <code><a href=#phylodiversity>PhyloDiversity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="gensimpson-gensimpson-bcgensimpson-gensimpson.probavector-gensimpson.abdvector-gensimpson.integer-gensimpson.numeric-gensimpsond-bcgensimpsond-gensimpsond.probavector-gensimpsond.abdvector-gensimpsond.integer-gensimpsond.numeric" class="section level2">
<h2>GenSimpson: GenSimpson, bcGenSimpson, GenSimpson.ProbaVector, GenSimpson.AbdVector, GenSimpson.integer, GenSimpson.numeric, GenSimpsonD, bcGenSimpsonD, GenSimpsonD.ProbaVector, GenSimpsonD.AbdVector, GenSimpsonD.integer, GenSimpsonD.numeric</h2>
<a id="GenSimpson_alias"></a>
<h3>
Generalized Simpson’s Entropy and Diversity
</h3>
<p class="rd-p">
Calculates the Generalized Simpson’s entropy of order <span class="math inline"><em>r</em></span> of a probability or abundance vector, and its effective number of species.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>GenSimpson(NorP, r&nbsp;=&nbsp;1, ...)
bcGenSimpson(Ns, r&nbsp;=&nbsp;1, CheckArguments&nbsp;=&nbsp;TRUE)
"GenSimpson"(NorP, r&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"GenSimpson"(NorP, r&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"GenSimpson"(NorP, r&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"GenSimpson"(NorP, r&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL) 
GenSimpsonD(NorP, r&nbsp;=&nbsp;1, ...)
bcGenSimpsonD(Ns, r&nbsp;=&nbsp;1, CheckArguments&nbsp;=&nbsp;TRUE)
"GenSimpsonD"(NorP, r&nbsp;=&nbsp;1, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"GenSimpsonD"(NorP, r&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"GenSimpsonD"(NorP, r&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"GenSimpsonD"(NorP, r&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
r
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1 for Simpsons diversity.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The Generalized Simpsons Entropy (Zhang and Zhou, 2010) of order <span class="math inline"><em>r</em></span> is, in the species accumulation curve, the probability for the individual sampled in rank <span class="math inline"><em>r</em> + 1</span> to belong to a new species. It is a measure of diversity so long as <span class="math inline"><em>r</em></span> is lower than the number of species (Grabchak <em>et al.</em>, 2016).
</p>
<p class="rd-p">
Bias correction requires the number of individuals. Use <code>bcGenSimpson</code>. It is limited to orders <span class="math inline"><em>r</em></span> less than or equal to the number of individuals in the community.
</p>
<p class="rd-p">
The effective number of species <code>GenSimpsonD</code> (explicit diversity) has been derived by Grabchak <em>et al.</em> (2016).
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>GenSimpson</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcGenSimpson</code> is called. Explicit calls to <code>bcGenSimpson</code> (with bias correction) or to <code>GenSimpson.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated index or diversity. The name is either “Biased” or “Unbiased”, depending on the estimator used.
</dl>
</p>
<h4>
Note
</h4>
<p class="rd-p">
The unbiased estimator is calculated by the <code><a href=http://www.rdocumentation.org/packages/EntropyEstimation/topics/GenSimp.z>GenSimp.z</a></code> function of the <code>EntropyEstimation</code> package.
</p>
<h4>
References
</h4>
<p class="rd-p">
Grabchak, M., Marcon, E., Lang, G., and Zhang, Z. (2017). The Generalized Simpsons Entropy is a Measure of Biodiversity. <em>Plos One</em>, 12(3): e0173305.
</p>
<p class="rd-p">
Zhang Z. and Zhou J. (2010). Re-parameterization of multinomial distributions and diversity indices. <em>Journal of Statistical Planning and Inference</em> 140(7): 1731-1738.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)</code></pre>
<p><img src="rd_files/figure-html/GenSimpson_id_15-1.png" width="624" /></p>
<pre class="r"><code># Calculate GenSimpson entropy of order 1, equal to Simpson&#39;s index of diversity
GenSimpson(Ps, 1) </code></pre>
<pre><code>##    Biased 
## 0.9854485</code></pre>
<pre class="r"><code># Calculate an unbiased estimator of GenSimpson entropy of order 100
GenSimpson(Ns, 100)</code></pre>
<pre><code>##  Unbiased 
## 0.4205852</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="hqz-hqz-bchqz-hqz.probavector-hqz.abdvector-hqz.integer-hqz.numeric" class="section level2">
<h2>Hqz: Hqz, bcHqz, Hqz.ProbaVector, Hqz.AbdVector, Hqz.integer, Hqz.numeric</h2>
<a id="Hqz_alias"></a>
<h3>
Similarity-based entropy of a community
</h3>
<p class="rd-p">
Calculates the entropy of order <span class="math inline"><em>q</em></span> of a probability vector according to a similarity matrix.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Hqz(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)),  ...)
bcHqz(Ns, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(Ns)), Correction&nbsp;=&nbsp;"Best", SampleCoverage&nbsp;=&nbsp;NULL,  CheckArguments&nbsp;=&nbsp;TRUE)
"Hqz"(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)),  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"Hqz"(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Hqz"(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best",  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Hqz"(NorP, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best",  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of entropy. Default is 1.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1. Default is the identity matrix to calculate neutral entropy.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: <code>“None”</code> (no correction), <code>“ChaoShen”</code>, <code>“MarconZhang”</code> or <code>“Best”</code>, the default value. The <code>“MarconZhang”</code> correction assumes a similarity matrix.
</dd>
<dt>
SampleCoverage
</dt>
<dd class="rd-dd">
The sample coverage of <code>Ns</code> calculated elsewhere. Used to calculate the gamma diversity of meta-communities, see details.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Entropy is calculated following Leinster and Cobbold (2012) after Ricotta and Szeidl (2006): it is the entropy of order <code>q</code> of the community, using species ordinariness as the information function.
</p>
<p class="rd-p">
A similarity matrix is used (as for <code><a href=#dqz>Dqz</a></code>), not a distance matrix as in Ricotta and Szeidl (2006). See the example.
</p>
<p class="rd-p">
Bias correction requires the number of individuals. Use <code>bcHqz</code> and choose the <code>Correction</code>. Correction techniques are from Marcon <em>et al.</em> (2014).
</p>
<p class="rd-p">
Currently, the <code>“Best”</code> correction is the max value of <code>“ChaoShen”</code> and <code>“MarconZhang”</code>.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Hqz</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcHqz</code> is called. Explicit calls to <code>bcHqz</code> (with bias correction) or to <code>Hqz.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<p class="rd-p">
The size of a metacommunity (see <code><a href=#metacommunity>MetaCommunity</a></code>) is unknown so it has to be set according to a rule which does not ensure that its abundances are integer values. Then, classical bias-correction methods do not apply. Providing the <code>SampleCoverage</code> argument allows applying the <code>“ChaoShen”</code> correction to estimate quite well the entropy. <code><a href=#divpart>DivPart</a></code> and <code><a href=#gammaentropy>GammaEntropy</a></code> functions use this tweak.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated entropy. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Leinster, T. and Cobbold, C. (2012). Measuring diversity: the importance of species similarity. <em>Ecology</em> 93(3): 477-489.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<p class="rd-p">
Ricotta, C. and Szeidl, L. (2006). Towards a unifying approach to diversity measures: Bridging the gap between the Shannon entropy and Raos quadratic index. <em>Theoretical Population Biology</em> 70(3): 237-243.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Prepare the similarity matrix
DistanceMatrix &lt;- as.matrix(EightSpTree$Wdist^2/2)
# Similarity can be 1 minus normalized distances between species
Z &lt;- 1 - DistanceMatrix/max(DistanceMatrix)
# Calculate diversity of order 2
Ps &lt;- EightSpAbundance/sum(EightSpAbundance)
Hqz(Ps, 2, Z)</code></pre>
<pre><code>##      None 
## 0.6033223</code></pre>
<pre class="r"><code># Equal to normalized Rao quadratic entropy when q=2
Rao(Ps, EightSpTree)/max(DistanceMatrix)</code></pre>
<pre><code>##      None 
## 0.6033223</code></pre>
<pre class="r"><code># But different from PhyloEntropy for all other q, e.g. 1
Hqz(Ps, 1, Z)</code></pre>
<pre><code>##      None 
## 0.9348275</code></pre>
<pre class="r"><code>summary(PhyloEntropy(Ps, 1, EightSpTree))</code></pre>
<pre><code>## alpha or gamma phylogenetic or functional entropy of order 1 
## of distribution 
## structure(c(0.19640387275242, 0.157676348547718, 0.0961272475795297,  
## 0.0629322268326418, 0.119640387275242, 0.116874135546335, 0.0975103734439834,  
## 0.15283540802213), .Names = c(&quot;Sr&quot;, &quot;Ess&quot;, &quot;Me&quot;, &quot;S1&quot;, &quot;Bg&quot;,  
## &quot;Ef&quot;, &quot;Vm&quot;, &quot;Dg&quot;))
##  with correction: None
## Phylogenetic or functional entropy was calculated according to the tree 
## EightSpTree 
## 
## Entropy is normalized
## 
## Entropy equals: 1.034531</code></pre>
<h4>
See also
</h4>
<p><code><a href=#dqz>Dqz</a></code>, <code><a href=#phyloentropy>PhyloEntropy</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="hqzbeta-hqzbeta-bchqzbeta-hqzbeta.probavector-hqzbeta.abdvector-hqzbeta.integer-hqzbeta.numeric" class="section level2">
<h2>HqzBeta: HqzBeta, bcHqzBeta, HqzBeta.ProbaVector, HqzBeta.AbdVector, HqzBeta.integer, HqzBeta.numeric</h2>
<a id="HqzBeta_alias"></a>
<h3>
Similarity-based beta entropy of a community
</h3>
<p class="rd-p">
Calculates the similarity-based beta entropy of order <span class="math inline"><em>q</em></span> of a community belonging to a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>HqzBeta(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), ...)
bcHqzBeta(Ns, Nexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(Ns)), Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"HqzBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL)
"HqzBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best",  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"HqzBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best",  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"HqzBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Z&nbsp;=&nbsp;diag(length(NorP)), Correction&nbsp;=&nbsp;"Best",  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
The probability vector of species of the community.
</dd>
<dt>
Pexp
</dt>
<dd class="rd-dd">
The probability vector of species of the metacommunity.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the community.
</dd>
<dt>
Nexp
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the metacommunity.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</dd>
<dt>
NorPexp
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number, the order of diversity. Default is 1.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1. Default is the identity matrix to calculate neutral entropy.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: currently, no correction is available so <code>“Best”</code>, the default value, is equivalent to <code>“None”</code>.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The derivation of similarity-based beta entropy can be found in Marcon <em>et al.</em> (2014).
</p>
<p class="rd-p">
Bias correction requires the number of individuals.
</p>
<p class="rd-p">
Note that beta entropy value is related to alpha entropy (if <span class="math inline"><em>q</em></span> is not 1) and cannot be compared accross communities (Jost, 2007). Beta entropy of a community is not meaningful in general, do rather calculate the <code><a href=#betadiversity>BetaDiversity</a></code> of the metacommunity.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>HqzBeta</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcHqzBeta</code> is called. Explicit calls to <code>bcHqzBeta</code> (with bias correction) or to <code>HqzBeta.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated entropy. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Jost (2007), Partitioning diversity into independent alpha and beta components. <em>Ecology</em> 88(10): 2427-2439.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Probability distribution of the first plot
Ps1 &lt;- as.ProbaVector(Paracou618.MC$Psi[, 1])
# Prepare the similarity matrix
DistanceMatrix &lt;- as.matrix(Paracou618.dist)
# Similarity can be 1 minus normalized distances between species
Z &lt;- 1 - DistanceMatrix/max(DistanceMatrix)
# Divergence of order 2 between plot 1 and the whole forest
HqzBeta(Ps1, Ps, q=2, Z)</code></pre>
<pre><code>##        None 
## 0.004107207</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="hurlbert-hurlbert-bchurlbert-hurlbert.probavector-hurlbert.abdvector-hurlbert.integer-hurlbert.numeric-hurlbertd-bchurlbertd-hurlbertd.probavector-hurlbertd.abdvector-hurlbertd.integer-hurlbertd.numeric" class="section level2">
<h2>Hurlbert: Hurlbert, bcHurlbert, Hurlbert.ProbaVector, Hurlbert.AbdVector, Hurlbert.integer, Hurlbert.numeric, HurlbertD, bcHurlbertD, HurlbertD.ProbaVector, HurlbertD.AbdVector, HurlbertD.integer, HurlbertD.numeric</h2>
<a id="Hurlbert_alias"></a>
<h3>
Hurlbert’s Index and Explicit Diversity
</h3>
<p class="rd-p">
Calculates the Hurlbert entropy of order <span class="math inline"><em>k</em></span> of a probability or abundance vector, and its effective number of species.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Hurlbert(NorP, k&nbsp;=&nbsp;2, ...)
bcHurlbert(Ns, k&nbsp;=&nbsp;2, CheckArguments&nbsp;=&nbsp;TRUE)
"Hurlbert"(NorP, k&nbsp;=&nbsp;2, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"Hurlbert"(NorP, k&nbsp;=&nbsp;2, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Hurlbert"(NorP, k&nbsp;=&nbsp;2, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Hurlbert"(NorP, k&nbsp;=&nbsp;2, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL) 
HurlbertD(NorP, k&nbsp;=&nbsp;2, ...)
bcHurlbertD(Ns, k&nbsp;=&nbsp;2, CheckArguments&nbsp;=&nbsp;TRUE)
"HurlbertD"(NorP, k&nbsp;=&nbsp;2, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"HurlbertD"(NorP, k&nbsp;=&nbsp;2, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"HurlbertD"(NorP, k&nbsp;=&nbsp;2, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"HurlbertD"(NorP, k&nbsp;=&nbsp;2, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
k
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 2 for Simpsons diversity.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Hurlberts index of diversity (1971) of order <span class="math inline"><em>k</em></span> is the expected number of species in a sample of size <span class="math inline"><em>k</em></span>.
</p>
<p class="rd-p">
Bias correction requires the number of individuals. Use <code>bcHurlbert</code>. It is limited to orders <span class="math inline"><em>k</em></span> less than or equal to the number of individuals in the community.
</p>
<p class="rd-p">
The effective number of species <code>HurlbertD</code> (explicit diversity) has been derived by Dauby &amp; Hardy (2012). It is calculated numerically. <code>bcHurlbertD</code> calculates it from the bias-corrected index <code>bcHurlbert</code>.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Hurlbert</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcHurlbert</code> is called. Explicit calls to <code>bcHurlbert</code> (with bias correction) or to <code>Hurlbert.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated index or diversity. The name is either “Biased” or “Unbiased”, depending on the estimator used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Dauby G. &amp; Hardy O.J. (2012) Sampled-based estimation of diversity sensu stricto by transforming Hurlbert diversities into effective number of species. <em>Ecography</em> 35(7): 661-672.
</p>
<p class="rd-p">
Hurlbert (1971) The Nonconcept of Species Diversity: A Critique and Alternative Parameters. <em>Ecology</em> 52(4): 577-586.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)</code></pre>
<p><img src="rd_files/figure-html/Hurlbert_id_18-1.png" width="624" /></p>
<pre class="r"><code># Calculate Hurlbert entropy of order 2, equal to Simpson&#39;s index of diversity
Hurlbert(Ps, 2) </code></pre>
<pre><code>##   Biased 
## 1.985449</code></pre>
<pre class="r"><code># Calculate an unbiased estimator of Hurlbert entropy of order 2
Hurlbert(Ns, 2)</code></pre>
<pre><code>## Unbiased 
## 1.986326</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="pdfd" class="section level2">
<h2>PDFD</h2>
<a id="PDFD_alias"></a>
<h3>
Phylogenetic Diversity / Functional Diversity of a Community
</h3>
<p class="rd-p">
Calculates Faith’s PD / Petchey and Gaston’ FD of a community described by a probability vector and a phylogenetic / functional tree.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>PDFD(Ps, Tree, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
PD and FD are defined as the total legth of the branches of the tree.
</p>
<p class="rd-p">
The probability vector is used to select branches: branches with probability 0 are eliminated.
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>.
</p>
<p class="rd-p">
Use <code><a href=#phylodiversity>bcPhyloDiversity</a></code><code>(Ps, 0, Tree)</code> and choose the <code>Correction</code>.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated diversity. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Faith, D. P. (1992). Conservation evaluation and phylogenetic diversity. <em>Biological Conservation</em> 61(1): 1-10.
</p>
<p class="rd-p">
Petchey, O. L. and Gaston, K. J. (2002). Functional diversity (FD), species richness and community composition. <em>Ecology Letters</em> 5: 402-411.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps
# Calculate the phylogenetic Shannon diversity of the plot
PDFD(Ps, Paracou618.Taxonomy)</code></pre>
<pre><code>## None 
##  395</code></pre>
<h4>
See also
</h4>
<p><code><a href=#phylodiversity>bcPhyloDiversity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="phylobetaentropy-phylobetaentropy-bcphylobetaentropy-phylobetaentropy.probavector-phylobetaentropy.abdvector-phylobetaentropy.integer-phylobetaentropy.numeric" class="section level2">
<h2>PhyloBetaEntropy: PhyloBetaEntropy, bcPhyloBetaEntropy, PhyloBetaEntropy.ProbaVector, PhyloBetaEntropy.AbdVector, PhyloBetaEntropy.integer, PhyloBetaEntropy.numeric</h2>
<a id="PhyloBetaEntropy_alias"></a>
<h3>
Phylogenetic Beta Entropy of a community
</h3>
<p class="rd-p">
Calculates the phylogenetic beta entropy of order <span class="math inline"><em>q</em></span> of a a community belonging to a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>PhyloBetaEntropy(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE, ...)
bcPhyloBetaEntropy(Ns, Nexp, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"PhyloBetaEntropy"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL)
"PhyloBetaEntropy"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"PhyloBetaEntropy"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"PhyloBetaEntropy"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL,  Pexp&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
The probability vector of species of the community.
</dd>
<dt>
Pexp
</dt>
<dd class="rd-dd">
The probability vector of species of the metacommunity.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the community.
</dd>
<dt>
Nexp
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the metacommunity.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</dd>
<dt>
NorPexp
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of entropy. Default is 1.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), the entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice). If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: currently, only <code>“ChaoShen”</code>. <code>“Best”</code> is the default value, it is equivalent to <code>“ChaoShen”</code>.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The phylogenetic entropy is the generalization of HCDT entropy to unequal species distances (Pavoine et al., 2009).
</p>
<p class="rd-p">
Calculation relies on <code><a href=#tsallisbeta>TsallisBeta</a></code> and <code><a href=#phyloapply>PhyloApply</a></code>.
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcPhyloBetaEntropy</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
Note that beta entropy value is related to alpha entropy (if <span class="math inline"><em>q</em></span> is not 1) and cannot be compared accross communities (Jost, 2007). Beta entropy of a community is not meaningful in general, do rather calculate the <code><a href=#phylodiversity>PhyloDiversity</a></code> of the metacommunity.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>PhyloBetaEntropy</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcPhyloBetaEntropy</code> is called. Explicit calls to <code>bcPhyloBetaEntropy</code> (with bias correction) or to <code>PhyloBetaEntropy.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A <code><a href=#phyloentropy>PhyloEntropy</a></code> object containing entropy values at each cut of the tree.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Jost (2007), Partitioning diversity into independent alpha and beta components. <em>Ecology</em> 88(10): 2427-2439.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Pavoine, S., Love, M. S. and Bonsall, M. B. (2009). Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: Application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em> 12(9): 898-908.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Probability distribution of the first plot
Ps1 &lt;- as.ProbaVector(Paracou618.MC$Psi[, 1])
# Calculate the phylogenetic Shannon beta entropy of the plot
summary(PhyloBetaEntropy(Ps1, Ps, 1, Paracou618.Taxonomy) -&gt; e)</code></pre>
<pre><code>## beta phylogenetic or functional entropy of order 1 of distribution 
## structure(c(0, 0, 0, 0.00622083981337481, 0, 0.0031104199066874,  
## 0, 0, 0, 0, 0, 0.0606531881804044, 0, 0, 0, 0.0031104199066874,  
## 0.0015552099533437, 0.0015552099533437, 0.0015552099533437, 0,  
## 0.0046656298600311, 0, 0, 0, 0, 0.0031104199066874, 0, 0, 0,  
## 0, 0.00622083981337481, 0.0046656298600311, 0.00622083981337481,  
## 0, 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0046656298600311,  
## 0, 0.0015552099533437, 0.0015552099533437, 0, 0, 0.0031104199066874,  
## 0, 0.0015552099533437, 0.0015552099533437, 0.0015552099533437,  
## 0, 0.0031104199066874, 0, 0.0015552099533437, 0.00777604976671851,  
## 0.0015552099533437, 0.0031104199066874, 0.0046656298600311, 0,  
## 0, 0.0015552099533437, 0, 0.0015552099533437, 0.0015552099533437,  
## 0, 0, 0, 0.0108864696734059, 0.0295489891135303, 0.00622083981337481,  
## 0, 0.0326594090202177, 0.0015552099533437, 0, 0.00777604976671851,  
## 0.0031104199066874, 0, 0.0046656298600311, 0, 0.0015552099533437,  
## 0.0046656298600311, 0.0031104199066874, 0, 0, 0.0217729393468118,  
## 0, 0, 0, 0.0248833592534992, 0, 0.00777604976671851, 0.0015552099533437,  
## 0.0015552099533437, 0, 0.0031104199066874, 0.0015552099533437,  
## 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0.0404354587869362,  
## 0, 0, 0.0015552099533437, 0, 0, 0.0046656298600311, 0.0015552099533437,  
## 0, 0.0015552099533437, 0, 0.00933125972006221, 0.0031104199066874,  
## 0.0031104199066874, 0, 0, 0, 0.0139968895800933, 0, 0.0015552099533437,  
## 0.0482115085536547, 0.0590979782270607, 0.0015552099533437, 0.0031104199066874,  
## 0, 0.00933125972006221, 0, 0.015552099533437, 0, 0.0015552099533437,  
## 0.0015552099533437, 0.0031104199066874, 0.0699844479004666, 0.0388802488335925,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0.0015552099533437,  
## 0, 0, 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0.0031104199066874,  
## 0, 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0.00777604976671851,  
## 0, 0, 0.0031104199066874, 0.0015552099533437, 0.0031104199066874,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.015552099533437, 0, 0.0031104199066874,  
## 0.0015552099533437, 0.0031104199066874, 0, 0, 0, 0, 0, 0, 0,  
## 0, 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015552099533437,  
## 0, 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  
## 0, 0, 0, 0, 0.0015552099533437, 0.0031104199066874, 0.0015552099533437,  
## 0, 0.0108864696734059, 0, 0, 0.0046656298600311, 0.0046656298600311,  
## 0.0357698289269051, 0, 0, 0, 0, 0.046656298600311, 0, 0, 0.00777604976671851,  
## 0, 0, 0, 0.0015552099533437, 0, 0.0202177293934681, 0.0046656298600311,  
## 0, 0.00777604976671851, 0, 0, 0, 0.0046656298600311, 0, 0.0015552099533437,  
## 0, 0.0015552099533437, 0.0015552099533437, 0, 0, 0, 0.0046656298600311,  
## 0, 0, 0.0031104199066874, 0.0031104199066874, 0.00933125972006221,  
## 0, 0.0015552099533437, 0.00777604976671851, 0, 0.0015552099533437,  
## 0.0015552099533437, 0, 0.00622083981337481, 0.0015552099533437,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.0046656298600311, 0, 0.0015552099533437,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015552099533437, 0.0108864696734059,  
## 0, 0.0031104199066874, 0, 0, 0.0015552099533437, 0, 0.0031104199066874,  
## 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0031104199066874,  
## 0.0015552099533437, 0, 0, 0, 0, 0, 0.0015552099533437, 0, 0.0015552099533437,  
## 0, 0, 0, 0.0015552099533437, 0.0015552099533437, 0, 0.0015552099533437,  
## 0.0015552099533437, 0, 0.0015552099533437, 0.0031104199066874,  
## 0, 0, 0, 0, 0.0031104199066874, 0, 0, 0, 0.0031104199066874,  
## 0, 0.0015552099533437, 0, 0, 0.0046656298600311, 0.0015552099533437,  
## 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0.0031104199066874, 0.0015552099533437,  
## 0, 0.0015552099533437, 0, 0, 0.0015552099533437, 0, 0, 0, 0.0031104199066874,  
## 0, 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0.0015552099533437,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.0108864696734059, 0, 0.00777604976671851,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0,  
## 0, 0.0015552099533437), class = c(&quot;ProbaVector&quot;, &quot;SpeciesDistribution&quot;,  
## &quot;numeric&quot;), .Names = c(&quot;Anac_Anac_spru&quot;, &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;,  
## &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;, &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;,  
## &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;, &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;,  
## &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;, &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;,  
## &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;, &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;,  
## &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;, &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;,  
## &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;, &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;,  
## &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;, &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;,  
## &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;, &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;,  
## &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;, &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;,  
## &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;, &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;,  
## &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;, &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;,  
## &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;, &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;,  
## &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;, &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;,  
## &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;, &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;,  
## &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;, &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;,  
## &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;, &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;,  
## &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;, &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;,  
## &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;, &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;,  
## &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;, &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;,  
## &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;, &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;,  
## &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;, &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;,  
## &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;, &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;,  
## &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;, &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;,  
## &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;, &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;,  
## &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;, &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;,  
## &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;, &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;,  
## &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;, &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;,  
## &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;, &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;,  
## &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;, &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;,  
## &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;, &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;,  
## &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;, &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;,  
## &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;, &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;,  
## &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;, &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;,  
## &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;, &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;,  
## &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;, &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;,  
## &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;, &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;,  
## &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;, &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;,  
## &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;, &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;,  
## &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;, &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;,  
## &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;, &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;,  
## &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;, &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;,  
## &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;, &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;,  
## &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;, &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;,  
## &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;, &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;,  
## &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;, &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;,  
## &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;, &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;,  
## &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;, &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;,  
## &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;, &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;,  
## &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;, &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;,  
## &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;, &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;,  
## &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;, &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;,  
## &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;, &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;,  
## &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;, &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;,  
## &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;, &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;,  
## &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;, &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;,  
## &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;, &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;,  
## &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;, &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;,  
## &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;, &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;,  
## &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;, &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;,  
## &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;, &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;,  
## &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;, &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;,  
## &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;, &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;,  
## &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;, &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;,  
## &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;, &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;,  
## &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;, &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;,  
## &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;, &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;,  
## &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;, &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;,  
## &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;, &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;,  
## &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;, &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;,  
## &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;, &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;,  
## &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;, &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;,  
## &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;, &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;,  
## &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;, &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;,  
## &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;, &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;,  
## &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;, &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;,  
## &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;, &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;,  
## &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;, &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;,  
## &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;, &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;,  
## &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;, &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;,  
## &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;, &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;,  
## &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;, &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;,  
## &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;, &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;,  
## &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;, &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;,  
## &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;, &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;,  
## &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;, &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;,  
## &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;, &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;,  
## &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;, &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;,  
## &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;, &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;,  
## &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;, &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;,  
## &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;, &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;,  
## &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;, &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;,  
## &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;, &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;,  
## &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;, &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;,  
## &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;, &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;,  
## &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;, &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;,  
## &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;, &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;,  
## &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;, &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;,  
## &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;, &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;,  
## &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;, &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;,  
## &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;, &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;,  
## &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;, &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;,  
## &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;, &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;,  
## &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;, &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;,  
## &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;, &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;,  
## &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;, &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;,  
## &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot;)) compared to 
## structure(c(0, 0, 0, 0.00622083981337481, 0, 0.0031104199066874,  
## 0, 0, 0, 0, 0, 0.0606531881804044, 0, 0, 0, 0.0031104199066874,  
## 0.0015552099533437, 0.0015552099533437, 0.0015552099533437, 0,  
## 0.0046656298600311, 0, 0, 0, 0, 0.0031104199066874, 0, 0, 0,  
## 0, 0.00622083981337481, 0.0046656298600311, 0.00622083981337481,  
## 0, 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0046656298600311,  
## 0, 0.0015552099533437, 0.0015552099533437, 0, 0, 0.0031104199066874,  
## 0, 0.0015552099533437, 0.0015552099533437, 0.0015552099533437,  
## 0, 0.0031104199066874, 0, 0.0015552099533437, 0.00777604976671851,  
## 0.0015552099533437, 0.0031104199066874, 0.0046656298600311, 0,  
## 0, 0.0015552099533437, 0, 0.0015552099533437, 0.0015552099533437,  
## 0, 0, 0, 0.0108864696734059, 0.0295489891135303, 0.00622083981337481,  
## 0, 0.0326594090202177, 0.0015552099533437, 0, 0.00777604976671851,  
## 0.0031104199066874, 0, 0.0046656298600311, 0, 0.0015552099533437,  
## 0.0046656298600311, 0.0031104199066874, 0, 0, 0.0217729393468118,  
## 0, 0, 0, 0.0248833592534992, 0, 0.00777604976671851, 0.0015552099533437,  
## 0.0015552099533437, 0, 0.0031104199066874, 0.0015552099533437,  
## 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0.0404354587869362,  
## 0, 0, 0.0015552099533437, 0, 0, 0.0046656298600311, 0.0015552099533437,  
## 0, 0.0015552099533437, 0, 0.00933125972006221, 0.0031104199066874,  
## 0.0031104199066874, 0, 0, 0, 0.0139968895800933, 0, 0.0015552099533437,  
## 0.0482115085536547, 0.0590979782270607, 0.0015552099533437, 0.0031104199066874,  
## 0, 0.00933125972006221, 0, 0.015552099533437, 0, 0.0015552099533437,  
## 0.0015552099533437, 0.0031104199066874, 0.0699844479004666, 0.0388802488335925,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0.0015552099533437,  
## 0, 0, 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0.0031104199066874,  
## 0, 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0.00777604976671851,  
## 0, 0, 0.0031104199066874, 0.0015552099533437, 0.0031104199066874,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.015552099533437, 0, 0.0031104199066874,  
## 0.0015552099533437, 0.0031104199066874, 0, 0, 0, 0, 0, 0, 0,  
## 0, 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015552099533437,  
## 0, 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  
## 0, 0, 0, 0, 0.0015552099533437, 0.0031104199066874, 0.0015552099533437,  
## 0, 0.0108864696734059, 0, 0, 0.0046656298600311, 0.0046656298600311,  
## 0.0357698289269051, 0, 0, 0, 0, 0.046656298600311, 0, 0, 0.00777604976671851,  
## 0, 0, 0, 0.0015552099533437, 0, 0.0202177293934681, 0.0046656298600311,  
## 0, 0.00777604976671851, 0, 0, 0, 0.0046656298600311, 0, 0.0015552099533437,  
## 0, 0.0015552099533437, 0.0015552099533437, 0, 0, 0, 0.0046656298600311,  
## 0, 0, 0.0031104199066874, 0.0031104199066874, 0.00933125972006221,  
## 0, 0.0015552099533437, 0.00777604976671851, 0, 0.0015552099533437,  
## 0.0015552099533437, 0, 0.00622083981337481, 0.0015552099533437,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.0046656298600311, 0, 0.0015552099533437,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015552099533437, 0.0108864696734059,  
## 0, 0.0031104199066874, 0, 0, 0.0015552099533437, 0, 0.0031104199066874,  
## 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0031104199066874,  
## 0.0015552099533437, 0, 0, 0, 0, 0, 0.0015552099533437, 0, 0.0015552099533437,  
## 0, 0, 0, 0.0015552099533437, 0.0015552099533437, 0, 0.0015552099533437,  
## 0.0015552099533437, 0, 0.0015552099533437, 0.0031104199066874,  
## 0, 0, 0, 0, 0.0031104199066874, 0, 0, 0, 0.0031104199066874,  
## 0, 0.0015552099533437, 0, 0, 0.0046656298600311, 0.0015552099533437,  
## 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0.0031104199066874, 0.0015552099533437,  
## 0, 0.0015552099533437, 0, 0, 0.0015552099533437, 0, 0, 0, 0.0031104199066874,  
## 0, 0, 0.0015552099533437, 0, 0, 0, 0, 0, 0, 0.0015552099533437,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.0108864696734059, 0, 0.00777604976671851,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015552099533437, 0, 0, 0, 0,  
## 0, 0.0015552099533437), class = c(&quot;ProbaVector&quot;, &quot;SpeciesDistribution&quot;,  
## &quot;numeric&quot;), .Names = c(&quot;Anac_Anac_spru&quot;, &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;,  
## &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;, &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;,  
## &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;, &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;,  
## &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;, &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;,  
## &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;, &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;,  
## &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;, &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;,  
## &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;, &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;,  
## &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;, &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;,  
## &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;, &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;,  
## &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;, &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;,  
## &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;, &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;,  
## &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;, &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;,  
## &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;, &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;,  
## &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;, &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;,  
## &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;, &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;,  
## &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;, &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;,  
## &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;, &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;,  
## &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;, &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;,  
## &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;, &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;,  
## &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;, &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;,  
## &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;, &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;,  
## &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;, &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;,  
## &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;, &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;,  
## &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;, &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;,  
## &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;, &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;,  
## &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;, &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;,  
## &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;, &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;,  
## &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;, &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;,  
## &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;, &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;,  
## &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;, &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;,  
## &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;, &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;,  
## &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;, &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;,  
## &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;, &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;,  
## &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;, &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;,  
## &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;, &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;,  
## &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;, &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;,  
## &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;, &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;,  
## &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;, &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;,  
## &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;, &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;,  
## &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;, &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;,  
## &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;, &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;,  
## &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;, &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;,  
## &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;, &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;,  
## &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;, &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;,  
## &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;, &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;,  
## &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;, &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;,  
## &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;, &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;,  
## &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;, &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;,  
## &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;, &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;,  
## &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;, &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;,  
## &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;, &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;,  
## &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;, &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;,  
## &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;, &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;,  
## &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;, &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;,  
## &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;, &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;,  
## &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;, &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;,  
## &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;, &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;,  
## &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;, &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;,  
## &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;, &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;,  
## &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;, &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;,  
## &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;, &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;,  
## &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;, &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;,  
## &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;, &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;,  
## &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;, &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;,  
## &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;, &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;,  
## &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;, &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;,  
## &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;, &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;,  
## &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;, &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;,  
## &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;, &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;,  
## &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;, &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;,  
## &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;, &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;,  
## &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;, &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;,  
## &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;, &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;,  
## &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;, &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;,  
## &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;, &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;,  
## &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;, &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;,  
## &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;, &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;,  
## &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;, &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;,  
## &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;, &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;,  
## &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;, &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;,  
## &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;, &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;,  
## &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;, &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;,  
## &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;, &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;,  
## &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;, &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;,  
## &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;, &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;,  
## &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;, &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;,  
## &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;, &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;,  
## &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;, &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;,  
## &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;, &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;,  
## &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;, &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;,  
## &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;, &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;,  
## &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;, &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;,  
## &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;, &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;,  
## &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;, &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;,  
## &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;, &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;,  
## &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;, &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;,  
## &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;, &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;,  
## &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;, &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;,  
## &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;, &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;,  
## &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;, &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;,  
## &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;, &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;,  
## &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;, &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;,  
## &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;, &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;,  
## &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;, &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;,  
## &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;, &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;,  
## &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;, &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;,  
## &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot;))
## 
## Phylogenetic or functional entropy was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Entropy is normalized
## 
## Entropy equals: 0.2323112</code></pre>
<pre class="r"><code>plot(e)</code></pre>
<p><img src="rd_files/figure-html/PhyloBetaEntropy_id_20-1.png" width="624" /></p>
<pre class="r"><code># Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Abundances in the first plot
Ns1 &lt;- as.AbdVector(Paracou618.MC$Nsi[, 1])
# Calculate the phylogenetic Shannon beta entropy of the plot
summary(bcPhyloBetaEntropy(Ns1, Ns, 1, Paracou618.Taxonomy, Correction = &quot;Best&quot;) -&gt; e)</code></pre>
<pre><code>## beta phylogenetic or functional entropy of order 1 of distribution 
## structure(c(0L, 0L, 0L, 4L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 39L,  
## 0L, 0L, 0L, 2L, 1L, 1L, 1L, 0L, 3L, 0L, 0L, 0L, 0L, 2L, 0L, 0L,  
## 0L, 0L, 4L, 3L, 4L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 0L, 0L, 3L, 0L, 1L, 1L, 0L, 0L, 2L, 0L, 1L, 1L, 1L, 0L, 2L,  
## 0L, 1L, 5L, 1L, 2L, 3L, 0L, 0L, 1L, 0L, 1L, 1L, 0L, 0L, 0L, 7L,  
## 19L, 4L, 0L, 21L, 1L, 0L, 5L, 2L, 0L, 3L, 0L, 1L, 3L, 2L, 0L,  
## 0L, 14L, 0L, 0L, 0L, 16L, 0L, 5L, 1L, 1L, 0L, 2L, 1L, 1L, 0L,  
## 0L, 0L, 0L, 0L, 0L, 0L, 26L, 0L, 0L, 1L, 0L, 0L, 3L, 1L, 0L,  
## 1L, 0L, 6L, 2L, 2L, 0L, 0L, 0L, 9L, 0L, 1L, 31L, 38L, 1L, 2L,  
## 0L, 6L, 0L, 10L, 0L, 1L, 1L, 2L, 45L, 25L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 1L, 0L,  
## 0L, 0L, 2L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 5L, 0L, 0L, 2L, 1L,  
## 2L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 10L, 0L, 2L, 1L, 2L, 0L,  
## 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 1L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 2L, 1L, 0L, 7L, 0L, 0L, 3L,  
## 3L, 23L, 0L, 0L, 0L, 0L, 30L, 0L, 0L, 5L, 0L, 0L, 0L, 1L, 0L,  
## 13L, 3L, 0L, 5L, 0L, 0L, 0L, 3L, 0L, 1L, 0L, 1L, 1L, 0L, 0L,  
## 0L, 3L, 0L, 0L, 2L, 2L, 6L, 0L, 1L, 5L, 0L, 1L, 1L, 0L, 4L, 1L,  
## 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 3L, 0L, 1L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 0L, 1L, 7L, 0L, 2L, 0L, 0L, 1L, 0L, 2L, 0L, 1L,  
## 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 2L, 1L, 0L, 0L, 0L, 0L, 0L,  
## 1L, 0L, 1L, 0L, 0L, 0L, 1L, 1L, 0L, 1L, 1L, 0L, 1L, 2L, 0L, 0L,  
## 0L, 0L, 2L, 0L, 0L, 0L, 2L, 0L, 1L, 0L, 0L, 3L, 1L, 0L, 0L, 0L,  
## 1L, 0L, 0L, 0L, 2L, 1L, 0L, 1L, 0L, 0L, 1L, 0L, 0L, 0L, 2L, 0L,  
## 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 7L, 0L, 5L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L,  
## 0L, 0L, 0L, 0L, 1L), class = c(&quot;AbdVector&quot;, &quot;SpeciesDistribution&quot;,  
## &quot;integer&quot;), .Names = c(&quot;Anac_Anac_spru&quot;, &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;,  
## &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;, &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;,  
## &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;, &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;,  
## &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;, &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;,  
## &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;, &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;,  
## &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;, &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;,  
## &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;, &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;,  
## &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;, &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;,  
## &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;, &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;,  
## &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;, &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;,  
## &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;, &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;,  
## &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;, &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;,  
## &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;, &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;,  
## &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;, &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;,  
## &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;, &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;,  
## &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;, &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;,  
## &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;, &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;,  
## &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;, &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;,  
## &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;, &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;,  
## &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;, &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;,  
## &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;, &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;,  
## &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;, &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;,  
## &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;, &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;,  
## &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;, &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;,  
## &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;, &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;,  
## &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;, &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;,  
## &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;, &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;,  
## &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;, &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;,  
## &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;, &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;,  
## &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;, &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;,  
## &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;, &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;,  
## &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;, &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;,  
## &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;, &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;,  
## &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;, &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;,  
## &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;, &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;,  
## &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;, &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;,  
## &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;, &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;,  
## &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;, &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;,  
## &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;, &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;,  
## &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;, &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;,  
## &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;, &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;,  
## &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;, &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;,  
## &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;, &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;,  
## &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;, &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;,  
## &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;, &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;,  
## &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;, &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;,  
## &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;, &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;,  
## &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;, &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;,  
## &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;, &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;,  
## &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;, &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;,  
## &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;, &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;,  
## &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;, &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;,  
## &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;, &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;,  
## &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;, &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;,  
## &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;, &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;,  
## &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;, &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;,  
## &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;, &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;,  
## &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;, &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;,  
## &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;, &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;,  
## &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;, &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;,  
## &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;, &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;,  
## &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;, &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;,  
## &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;, &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;,  
## &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;, &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;,  
## &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;, &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;,  
## &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;, &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;,  
## &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;, &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;,  
## &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;, &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;,  
## &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;, &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;,  
## &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;, &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;,  
## &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;, &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;,  
## &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;, &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;,  
## &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;, &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;,  
## &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;, &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;,  
## &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;, &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;,  
## &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;, &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;,  
## &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;, &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;,  
## &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;, &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;,  
## &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;, &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;,  
## &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;, &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;,  
## &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;, &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;,  
## &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;, &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;,  
## &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;, &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;,  
## &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;, &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;,  
## &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;, &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;,  
## &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;, &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;,  
## &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;, &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;,  
## &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;, &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;,  
## &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;, &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;,  
## &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;, &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;,  
## &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;, &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;,  
## &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;, &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;,  
## &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;, &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;,  
## &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;, &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;,  
## &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;, &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;,  
## &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;, &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;,  
## &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;, &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;,  
## &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;, &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;,  
## &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;, &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;,  
## &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;, &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;,  
## &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;, &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;,  
## &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;, &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;,  
## &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;, &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;,  
## &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;, &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;,  
## &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;, &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;,  
## &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;, &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;,  
## &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot;))
##  with correction: Best
## Phylogenetic or functional entropy was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Entropy is normalized
## 
## Entropy equals: 0.2049819</code></pre>
<pre class="r"><code>plot(e)</code></pre>
<p><img src="rd_files/figure-html/PhyloBetaEntropy_id_20-2.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#tsallisbeta>TsallisBeta</a></code>, <code><a href=#phylobetaentropy>bcPhyloBetaEntropy</a></code>, <code><a href=#phylodiversity>PhyloDiversity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="phylodiversity-phylodiversity-bcphylodiversity-phylodiversity.probavector-phylodiversity.abdvector-phylodiversity.integer-phylodiversity.numeric-is.phylodiversity-summary.phylodiversity" class="section level2">
<h2>PhyloDiversity: PhyloDiversity, bcPhyloDiversity, PhyloDiversity.ProbaVector, PhyloDiversity.AbdVector, PhyloDiversity.integer, PhyloDiversity.numeric, is.PhyloDiversity, summary.PhyloDiversity</h2>
<a id="PhyloDiversity_alias"></a>
<h3>
Phylogenetic Diversity of a Community
</h3>
<p class="rd-p">
Calculates the phylogenetic diversity of order <span class="math inline"><em>q</em></span> of a probability vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>PhyloDiversity(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE, ...)
bcPhyloDiversity(Ns, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE, Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"PhyloDiversity"(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,   ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"PhyloDiversity"(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"PhyloDiversity"(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"PhyloDiversity"(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL) 
is.PhyloDiversity(x)
"summary"(object, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), the <code>Total</code> diversity is not affected by the height of the tree. If <code>FALSE</code>, it is proportional to the height of the tree.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: <code>“None”</code> (no correction), <code>“ChaoShen”</code>, <code>“Grassberger”</code>, <code>“Holste”</code>, <code>“Bonachela”</code> or <code>“Best”</code>, the default value.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>PhyloDiversity</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The phylogenetic entropy is its generalization of HCDT entropy to unequal species distances (Pavoine et al., 2009).
</p>
<p class="rd-p">
Diversity is obtained by transforming generalized entropy.
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcPhyloDiversity</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>PhyloDiversity</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcPhyloDiversity</code> is called. Explicit calls to <code>bcPhyloDiversity</code> (with bias correction) or to <code>PhyloDiversity.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Note
</h4>
<p class="rd-p">
The tree must contain all species of the probability vector. If it contains extra species, computation time will just be increased.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An object of class <code>PhyloDiversity</code> is a list:
<dt>
Distribution
</dt>
<dd>
The distribution used to calculate diversity
</dd>
</p>
<p class="rd-p">
<dt>
Function
</dt>
<dd>
The function used to calculate diversity
</dd>
</p>
<p class="rd-p">
<dt>
Tree
</dt>
<dd>
The functional or phylogenetic tree used to calculate diversity
</dd>
</p>
<p class="rd-p">
<dt>
Normalized
</dt>
<dd>
Logical. Indicates whether phylodiversity is normalized or proportional to the height of the tree.
</dd>
</p>
<p class="rd-p">
<dt>
Type
</dt>
<dd>
The type of diversity (“alpha”, “beta” or “gamma”).
</dd>
</p>
<p class="rd-p">
<dt>
Order
</dt>
<dd>
The order of diversity <span class="math inline"><em>q</em></span>.
</dd>
</p>
<p class="rd-p">
<dt>
Cuts
</dt>
<dd>
A named vector containing values of neutral diversity along the tree. Names are cut ends, <em>i.e.</em> the ends of intervals (the first interval starts at 0 for leaves, the max value is the height of the tree).
</dd>
</p>
<p class="rd-p">
<dt>
Total
</dt>
<dd>
A value equal the total diversity (obtained by transforming the total normalized entropy), multiplied by the tree height if <code>Normalize</code> is FALSE.
</dd>
</p>
<p class="rd-p">
<code>is.PhyloDiversity</code> returns <code>TRUE</code> if the object is of class <code>PhyloDiversity</code>.
</p>
<p class="rd-p">
<code>summary.PhyloDiversity</code> returns a summary of the objects value.
</p>
<p class="rd-p">
<code>PhyloDiversity</code> objects can be plotted by <code><a href=#phylovalue>plot.PhyloValue</a></code> because <code>PhyloDiversity</code> objects are also of class <code>PhyloValue</code>.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Chao, A., Chiu, C.-H. and Jost, L. (2010). Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society B</em> 365(1558): 3599-609.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Pavoine, S., Love, M. S. and Bonsall, M. B. (2009). Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: Application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em> 12(9): 898-908.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Calculate the phylogenetic Shannon diversity of the plot
summary(PhyloDiversity(Ps, 1, Paracou618.Taxonomy) -&gt; d)</code></pre>
<pre><code>## alpha or gamma phylogenetic or functional diversity of order 1 
## of distribution 
## structure(c(0.00266903914590747, 0, 0.00266903914590747, 0.00355871886120996,  
## 0.000889679715302491, 0.00177935943060498, 0, 0, 0, 0.00177935943060498,  
## 0, 0.0355871886120996, 0, 0, 0.000889679715302491, 0.00533807829181495,  
## 0.00533807829181495, 0.000889679715302491, 0.00177935943060498,  
## 0.000889679715302491, 0.00355871886120997, 0, 0, 0.00266903914590747,  
## 0, 0.00177935943060498, 0, 0.000889679715302491, 0.00355871886120996,  
## 0.000889679715302491, 0.0124555160142349, 0.00355871886120997,  
## 0.00444839857651246, 0, 0, 0.000889679715302491, 0, 0, 0, 0,  
## 0.00177935943060498, 0, 0, 0, 0, 0, 0, 0.00711743772241993, 0.00266903914590747,  
## 0.00177935943060498, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.00355871886120996, 0, 0.00355871886120996, 0.00177935943060498,  
## 0.00800711743772242, 0, 0.00355871886120996, 0, 0.000889679715302491,  
## 0.00444839857651246, 0.000889679715302491, 0.00177935943060498,  
## 0.00266903914590747, 0, 0.000889679715302491, 0.000889679715302491,  
## 0, 0.000889679715302491, 0.000889679715302491, 0, 0, 0, 0.0160142348754448,  
## 0.0186832740213523, 0.00622775800711744, 0, 0.0186832740213523,  
## 0.00177935943060498, 0, 0.00711743772241993, 0.00177935943060498,  
## 0, 0.00444839857651246, 0, 0.000889679715302491, 0.00355871886120997,  
## 0.00177935943060498, 0, 0, 0.0124555160142349, 0.000889679715302491,  
## 0.0097864768683274, 0, 0.0231316725978648, 0.000889679715302491,  
## 0.00533807829181495, 0.0249110320284698, 0.00444839857651246,  
## 0.00444839857651246, 0.00177935943060498, 0.000889679715302491,  
## 0.000889679715302491, 0, 0.00177935943060498, 0, 0, 0.00177935943060498,  
## 0, 0.000889679715302491, 0.0231316725978648, 0.000889679715302491,  
## 0.00800711743772242, 0.000889679715302491, 0, 0, 0.00266903914590747,  
## 0.000889679715302491, 0, 0.00177935943060498, 0, 0.00533807829181495,  
## 0.00177935943060498, 0.00444839857651246, 0.0097864768683274,  
## 0.000889679715302491, 0.000889679715302491, 0.00800711743772242,  
## 0, 0.000889679715302491, 0.0275800711743772, 0.0338078291814947,  
## 0.00177935943060498, 0.00177935943060498, 0, 0.00622775800711744,  
## 0.000889679715302491, 0.0115658362989324, 0, 0.000889679715302491,  
## 0.000889679715302491, 0.00177935943060498, 0.0400355871886121,  
## 0.0222419928825623, 0, 0, 0, 0.000889679715302491, 0, 0, 0, 0,  
## 0, 0.000889679715302491, 0, 0, 0.000889679715302491, 0.00177935943060498,  
## 0, 0, 0.00622775800711744, 0.00266903914590747, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0.00177935943060498,  
## 0, 0, 0, 0.000889679715302491, 0.000889679715302491, 0, 0, 0,  
## 0.00444839857651246, 0, 0, 0.00266903914590747, 0.000889679715302491,  
## 0.00266903914590747, 0, 0, 0, 0.00177935943060498, 0, 0, 0.00177935943060498,  
## 0, 0.00889679715302491, 0, 0.00177935943060498, 0.000889679715302491,  
## 0.00177935943060498, 0.000889679715302491, 0, 0.00177935943060498,  
## 0.00355871886120996, 0, 0, 0, 0, 0, 0.000889679715302491, 0,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000889679715302491, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0, 0, 0, 0,  
## 0.000889679715302491, 0, 0, 0, 0, 0.00177935943060498, 0, 0,  
## 0.00355871886120996, 0.00177935943060498, 0.000889679715302491,  
## 0.000889679715302491, 0.00711743772241993, 0, 0, 0.00355871886120997,  
## 0.0293594306049822, 0.0204626334519573, 0, 0, 0, 0, 0.0275800711743772,  
## 0, 0, 0.0258007117437722, 0.00177935943060498, 0.00177935943060498,  
## 0.0097864768683274, 0.000889679715302491, 0, 0.0160142348754448,  
## 0.00355871886120997, 0, 0.00444839857651246, 0, 0.000889679715302491,  
## 0, 0.00444839857651246, 0.00177935943060498, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0, 0, 0.00177935943060498, 0.00266903914590747, 0, 0, 0.00266903914590747,  
## 0.00266903914590747, 0.00711743772241993, 0, 0.000889679715302491,  
## 0.00444839857651246, 0, 0.000889679715302491, 0.00533807829181495,  
## 0.000889679715302491, 0.0177935943060498, 0.000889679715302491,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.00355871886120997, 0, 0.00177935943060498,  
## 0, 0, 0, 0, 0.00266903914590747, 0.000889679715302491, 0, 0,  
## 0.000889679715302491, 0, 0.0124555160142349, 0.0231316725978648,  
## 0, 0.00266903914590747, 0, 0, 0.000889679715302491, 0, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0.000889679715302491,  
## 0, 0, 0.00533807829181495, 0, 0, 0, 0.00266903914590747, 0.000889679715302491,  
## 0, 0, 0, 0.000889679715302491, 0, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.00266903914590747, 0, 0, 0.00177935943060498, 0.000889679715302491,  
## 0, 0.000889679715302491, 0.00266903914590747, 0, 0.000889679715302491,  
## 0.00177935943060498, 0, 0, 0, 0.00177935943060498, 0.00177935943060498,  
## 0.000889679715302491, 0, 0.00177935943060498, 0.00266903914590747,  
## 0, 0.00444839857651246, 0, 0, 0.00355871886120997, 0.000889679715302491,  
## 0, 0, 0.000889679715302491, 0.000889679715302491, 0.00355871886120996,  
## 0, 0, 0.00177935943060498, 0.00355871886120996, 0, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.00177935943060498, 0.00355871886120996,  
## 0, 0.00177935943060498, 0, 0, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.0133451957295374, 0.000889679715302491, 0.000889679715302491,  
## 0, 0.00177935943060498, 0, 0, 0, 0, 0, 0, 0, 0, 0.0097864768683274,  
## 0, 0.00800711743772242, 0.000889679715302491, 0, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.00266903914590747, 0.00177935943060498,  
## 0, 0.00355871886120996, 0.000889679715302491, 0.00177935943060498,  
## 0, 0, 0.000889679715302491, 0, 0.00444839857651246), class = c(&quot;ProbaVector&quot;,  
## &quot;SpeciesDistribution&quot;, &quot;numeric&quot;), .Names = c(&quot;Anac_Anac_spru&quot;,  
## &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;, &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;,  
## &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;, &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;,  
## &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;, &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;,  
## &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;, &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;,  
## &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;, &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;,  
## &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;, &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;,  
## &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;, &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;,  
## &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;, &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;,  
## &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;, &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;,  
## &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;, &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;,  
## &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;, &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;,  
## &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;, &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;,  
## &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;, &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;,  
## &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;, &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;,  
## &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;, &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;,  
## &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;, &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;,  
## &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;, &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;,  
## &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;, &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;,  
## &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;, &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;,  
## &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;, &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;,  
## &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;, &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;,  
## &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;, &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;,  
## &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;, &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;,  
## &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;, &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;,  
## &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;, &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;,  
## &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;, &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;,  
## &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;, &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;,  
## &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;, &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;,  
## &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;, &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;,  
## &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;, &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;,  
## &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;, &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;,  
## &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;, &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;,  
## &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;, &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;,  
## &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;, &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;,  
## &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;, &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;,  
## &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;, &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;,  
## &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;, &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;,  
## &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;, &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;,  
## &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;, &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;,  
## &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;, &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;,  
## &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;, &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;,  
## &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;, &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;,  
## &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;, &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;,  
## &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;, &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;,  
## &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;, &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;,  
## &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;, &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;,  
## &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;, &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;,  
## &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;, &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;,  
## &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;, &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;,  
## &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;, &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;,  
## &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;, &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;,  
## &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;, &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;,  
## &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;, &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;,  
## &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;, &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;,  
## &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;, &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;,  
## &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;, &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;,  
## &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;, &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;,  
## &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;, &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;,  
## &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;, &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;,  
## &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;, &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;,  
## &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;, &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;,  
## &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;, &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;,  
## &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;, &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;,  
## &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;, &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;,  
## &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;, &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;,  
## &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;, &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;,  
## &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;, &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;,  
## &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;, &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;,  
## &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;, &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;,  
## &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;, &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;,  
## &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;, &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;,  
## &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;, &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;,  
## &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;, &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;,  
## &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;, &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;,  
## &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;, &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;,  
## &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;, &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;,  
## &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;, &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;,  
## &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;, &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;,  
## &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;, &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;,  
## &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;, &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;,  
## &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;, &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;,  
## &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;, &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;,  
## &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;, &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;,  
## &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;, &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;,  
## &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;, &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;,  
## &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;, &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;,  
## &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;, &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;,  
## &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;, &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;,  
## &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;, &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;,  
## &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;, &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;,  
## &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;, &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;,  
## &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;, &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;,  
## &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;, &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;,  
## &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;, &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;,  
## &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;, &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;,  
## &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;, &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;,  
## &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;, &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;,  
## &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;, &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;,  
## &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;, &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;,  
## &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;, &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;,  
## &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;, &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;,  
## &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;, &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;,  
## &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;, &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;,  
## &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;, &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;,  
## &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;, &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;,  
## &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;, &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot; ))
##  with correction: None
## Phylogenetic or functional diversity was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Diversity is normalized
## 
## Diversity equals: 50.39747</code></pre>
<pre class="r"><code>plot(d)</code></pre>
<p><img src="rd_files/figure-html/PhyloDiversity_id_21-1.png" width="624" /></p>
<pre class="r"><code># Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Calculate the phylogenetic Shannon diversity of the plot
summary(bcPhyloDiversity(Ns, 1, Paracou618.Taxonomy, Correction = &quot;Best&quot;) -&gt; d)</code></pre>
<pre><code>## alpha or gamma phylogenetic or functional diversity of order 1 
## of distribution 
## structure(c(3L, 0L, 3L, 4L, 1L, 2L, 0L, 0L, 0L, 2L, 0L, 40L,  
## 0L, 0L, 1L, 6L, 6L, 1L, 2L, 1L, 4L, 0L, 0L, 3L, 0L, 2L, 0L, 1L,  
## 4L, 1L, 14L, 4L, 5L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 2L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 8L, 3L, 2L, 1L, 0L, 1L, 4L, 0L, 4L, 2L, 9L, 0L,  
## 4L, 0L, 1L, 5L, 1L, 2L, 3L, 0L, 1L, 1L, 0L, 1L, 1L, 0L, 0L, 0L,  
## 18L, 21L, 7L, 0L, 21L, 2L, 0L, 8L, 2L, 0L, 5L, 0L, 1L, 4L, 2L,  
## 0L, 0L, 14L, 1L, 11L, 0L, 26L, 1L, 6L, 28L, 5L, 5L, 2L, 1L, 1L,  
## 0L, 2L, 0L, 0L, 2L, 0L, 1L, 26L, 1L, 9L, 1L, 0L, 0L, 3L, 1L,  
## 0L, 2L, 0L, 6L, 2L, 5L, 11L, 1L, 1L, 9L, 0L, 1L, 31L, 38L, 2L,  
## 2L, 0L, 7L, 1L, 13L, 0L, 1L, 1L, 2L, 45L, 25L, 0L, 0L, 0L, 1L,  
## 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 1L, 2L, 0L, 0L, 7L, 3L, 1L, 1L,  
## 1L, 0L, 0L, 2L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L, 5L, 0L, 0L, 3L,  
## 1L, 3L, 0L, 0L, 0L, 2L, 0L, 0L, 2L, 0L, 10L, 0L, 2L, 1L, 2L,  
## 1L, 0L, 2L, 4L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 1L, 0L, 0L, 0L, 0L, 2L, 0L, 0L, 4L, 2L, 1L, 1L, 8L, 0L, 0L,  
## 4L, 33L, 23L, 0L, 0L, 0L, 0L, 31L, 0L, 0L, 29L, 2L, 2L, 11L,  
## 1L, 0L, 18L, 4L, 0L, 5L, 0L, 1L, 0L, 5L, 2L, 3L, 1L, 1L, 1L,  
## 0L, 0L, 2L, 3L, 0L, 0L, 3L, 3L, 8L, 0L, 1L, 5L, 0L, 1L, 6L, 1L,  
## 20L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 4L, 0L, 2L, 0L, 0L,  
## 0L, 0L, 3L, 1L, 0L, 0L, 1L, 0L, 14L, 26L, 0L, 3L, 0L, 0L, 1L,  
## 0L, 3L, 1L, 1L, 0L, 0L, 1L, 0L, 0L, 6L, 0L, 0L, 0L, 3L, 1L, 0L,  
## 0L, 0L, 1L, 0L, 1L, 0L, 1L, 3L, 0L, 0L, 2L, 1L, 0L, 1L, 3L, 0L,  
## 1L, 2L, 0L, 0L, 0L, 2L, 2L, 1L, 0L, 2L, 3L, 0L, 5L, 0L, 0L, 4L,  
## 1L, 0L, 0L, 1L, 1L, 4L, 0L, 0L, 2L, 4L, 0L, 1L, 0L, 0L, 3L, 2L,  
## 4L, 0L, 2L, 0L, 0L, 1L, 0L, 1L, 15L, 1L, 1L, 0L, 2L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 0L, 0L, 11L, 0L, 9L, 1L, 0L, 1L, 0L, 0L, 3L,  
## 3L, 2L, 0L, 4L, 1L, 2L, 0L, 0L, 1L, 0L, 5L), class = c(&quot;AbdVector&quot;,  
## &quot;SpeciesDistribution&quot;, &quot;integer&quot;), .Names = c(&quot;Anac_Anac_spru&quot;,  
## &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;, &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;,  
## &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;, &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;,  
## &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;, &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;,  
## &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;, &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;,  
## &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;, &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;,  
## &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;, &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;,  
## &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;, &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;,  
## &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;, &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;,  
## &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;, &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;,  
## &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;, &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;,  
## &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;, &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;,  
## &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;, &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;,  
## &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;, &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;,  
## &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;, &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;,  
## &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;, &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;,  
## &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;, &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;,  
## &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;, &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;,  
## &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;, &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;,  
## &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;, &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;,  
## &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;, &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;,  
## &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;, &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;,  
## &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;, &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;,  
## &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;, &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;,  
## &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;, &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;,  
## &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;, &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;,  
## &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;, &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;,  
## &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;, &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;,  
## &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;, &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;,  
## &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;, &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;,  
## &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;, &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;,  
## &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;, &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;,  
## &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;, &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;,  
## &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;, &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;,  
## &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;, &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;,  
## &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;, &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;,  
## &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;, &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;,  
## &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;, &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;,  
## &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;, &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;,  
## &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;, &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;,  
## &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;, &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;,  
## &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;, &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;,  
## &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;, &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;,  
## &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;, &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;,  
## &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;, &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;,  
## &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;, &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;,  
## &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;, &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;,  
## &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;, &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;,  
## &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;, &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;,  
## &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;, &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;,  
## &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;, &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;,  
## &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;, &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;,  
## &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;, &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;,  
## &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;, &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;,  
## &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;, &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;,  
## &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;, &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;,  
## &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;, &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;,  
## &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;, &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;,  
## &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;, &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;,  
## &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;, &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;,  
## &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;, &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;,  
## &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;, &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;,  
## &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;, &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;,  
## &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;, &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;,  
## &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;, &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;,  
## &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;, &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;,  
## &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;, &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;,  
## &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;, &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;,  
## &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;, &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;,  
## &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;, &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;,  
## &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;, &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;,  
## &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;, &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;,  
## &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;, &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;,  
## &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;, &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;,  
## &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;, &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;,  
## &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;, &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;,  
## &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;, &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;,  
## &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;, &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;,  
## &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;, &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;,  
## &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;, &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;,  
## &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;, &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;,  
## &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;, &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;,  
## &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;, &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;,  
## &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;, &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;,  
## &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;, &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;,  
## &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;, &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;,  
## &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;, &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;,  
## &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;, &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;,  
## &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;, &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;,  
## &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;, &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;,  
## &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;, &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;,  
## &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;, &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;,  
## &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;, &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;,  
## &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;, &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;,  
## &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;, &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;,  
## &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;, &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;,  
## &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;, &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;,  
## &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;, &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;,  
## &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;, &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;,  
## &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;, &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;,  
## &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;, &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;,  
## &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;, &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;,  
## &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;, &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;,  
## &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;, &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;,  
## &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;, &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;,  
## &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;, &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;,  
## &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;, &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot; ))
##  with correction: Best
## Phylogenetic or functional diversity was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Diversity is normalized
## 
## Diversity equals: 54.78324</code></pre>
<pre class="r"><code>plot(d)</code></pre>
<p><img src="rd_files/figure-html/PhyloDiversity_id_21-2.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#phyloentropy>PhyloEntropy</a></code>, <code><a href=#diversity>Diversity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="phyloentropy-phyloentropy-bcphyloentropy-phyloentropy.probavector-phyloentropy.abdvector-phyloentropy.integer-phyloentropy.numeric-is.phyloentropy-summary.phyloentropy" class="section level2">
<h2>PhyloEntropy: PhyloEntropy, bcPhyloEntropy, PhyloEntropy.ProbaVector, PhyloEntropy.AbdVector, PhyloEntropy.integer, PhyloEntropy.numeric, is.PhyloEntropy, summary.PhyloEntropy</h2>
<a id="PhyloEntropy_alias"></a>
<h3>
Phylogenetic Entropy of a community
</h3>
<p class="rd-p">
Calculates the phylogenetic entropy of order <span class="math inline"><em>q</em></span> of a probability vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>PhyloEntropy(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE, ...)
bcPhyloEntropy(Ns, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE, Correction&nbsp;=&nbsp;"Best",  SampleCoverage&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)
"PhyloEntropy"(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE,  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"PhyloEntropy"(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE, Correction&nbsp;=&nbsp;"Best",  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"PhyloEntropy"(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE, Correction&nbsp;=&nbsp;"Best",  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"PhyloEntropy"(NorP, q&nbsp;=&nbsp;1, Tree, Normalize&nbsp;=&nbsp;TRUE, Correction&nbsp;=&nbsp;"Best",  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL) 
is.PhyloEntropy(x)
"summary"(object, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of entropy. Default is 1.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), the <code>Total</code> entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice). If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: <code>“None”</code> (no correction), <code>“ChaoShen”</code>, <code>“Grassberger”</code>, <code>“Holste”</code>, <code>“Bonachela”</code> or <code>“Best”</code>, the default value.
</dd>
<dt>
SampleCoverage
</dt>
<dd class="rd-dd">
The sample coverage of <code>Ns</code> calculated elsewhere. Used to calculate the gamma diversity of meta-communities, see details.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>PhyloEntropy</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The phylogenetic entropy is its generalization of HCDT entropy to unequal species distances (Pavoine et al., 2009).
</p>
<p class="rd-p">
Calculation relies on <code><a href=#tsallis>Tsallis</a></code> and <code><a href=#phyloapply>PhyloApply</a></code>.
</p>
<p class="rd-p">
Intervals separate two cuts in a tree: no node is found at heights contained in an interval.
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcPhyloEntropy</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>PhyloEntropy</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcPhyloEntropy</code> is called. Explicit calls to <code>bcPhyloEntropy</code> (with bias correction) or to <code>PhyloEntropy.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<p class="rd-p">
The size of a metacommunity (see <code><a href=#metacommunity>MetaCommunity</a></code>) is unknown so it has to be set according to a rule which does not ensure that its abundances are integer values. Then, classical bias-correction methods do not apply. Providing the <code>SampleCoverage</code> argument allows applying the <code>“ChaoShen”</code> and <code>“Grassberger”</code> corrections to estimate quite well the entropy. <code><a href=#divpart>DivPart</a></code> and <code><a href=#gammaentropy>GammaEntropy</a></code> functions use this tweak.
</p>
<h4>
Note
</h4>
<p class="rd-p">
The tree must contain all species of the probability vector. If it contains extra species, computation time will just be increased.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An object of class <code>PhyloEntropy</code> is a list:
<dt>
Distribution
</dt>
<dd>
The distribution used to calculate entropy
</dd>
</p>
<p class="rd-p">
<dt>
Function
</dt>
<dd>
The function used to calculate entropy
</dd>
</p>
<p class="rd-p">
<dt>
Tree
</dt>
<dd>
The functional or phylogenetic tree used to calculate entropy
</dd>
</p>
<p class="rd-p">
<dt>
Normalized
</dt>
<dd>
Logical. Indicates whether phyloentropy is normalized or proportional to the height of the tree.
</dd>
</p>
<p class="rd-p">
<dt>
Type
</dt>
<dd>
The type of entropy (“alpha”, “beta” or “gamma”).
</dd>
</p>
<p class="rd-p">
<dt>
Order
</dt>
<dd>
The order of entropy <span class="math inline"><em>q</em></span>.
</dd>
</p>
<p class="rd-p">
<dt>
Cuts
</dt>
<dd>
A named vector containing values of neutral entropy along the tree. Names are cut ends, <em>i.e.</em> the ends of intervals (the first interval starts at 0 for leaves, the max value is the height of the tree).
</dd>
</p>
<p class="rd-p">
<dt>
Total
</dt>
<dd>
A value equal the total entropy multiplied by the tree height if <code>Normalize</code> is FALSE.
</dd>
</p>
<p class="rd-p">
<code>is.PhyloEntropy</code> returns <code>TRUE</code> if the object is of class <code>PhyloEntropy</code>.
</p>
<p class="rd-p">
<code>summary.PhyloEntropy</code> returns a summary of the objects value.
</p>
<p class="rd-p">
<code>PhyloEntropy</code> objects can be plotted by <code><a href=#phylovalue>plot.PhyloValue</a></code> because <code>PhyloEntropy</code> objects are also of class <code>PhyloValue</code>.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Pavoine, S., Love, M. S. and Bonsall, M. B. (2009). Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: Application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em> 12(9): 898-908.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Calculate the phylogenetic Shannon entropy of the plot
summary(PhyloEntropy(Ps, 1, Paracou618.Taxonomy) -&gt; e)</code></pre>
<pre><code>## alpha or gamma phylogenetic or functional entropy of order 1 
## of distribution 
## structure(c(0.00266903914590747, 0, 0.00266903914590747, 0.00355871886120996,  
## 0.000889679715302491, 0.00177935943060498, 0, 0, 0, 0.00177935943060498,  
## 0, 0.0355871886120996, 0, 0, 0.000889679715302491, 0.00533807829181495,  
## 0.00533807829181495, 0.000889679715302491, 0.00177935943060498,  
## 0.000889679715302491, 0.00355871886120997, 0, 0, 0.00266903914590747,  
## 0, 0.00177935943060498, 0, 0.000889679715302491, 0.00355871886120996,  
## 0.000889679715302491, 0.0124555160142349, 0.00355871886120997,  
## 0.00444839857651246, 0, 0, 0.000889679715302491, 0, 0, 0, 0,  
## 0.00177935943060498, 0, 0, 0, 0, 0, 0, 0.00711743772241993, 0.00266903914590747,  
## 0.00177935943060498, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.00355871886120996, 0, 0.00355871886120996, 0.00177935943060498,  
## 0.00800711743772242, 0, 0.00355871886120996, 0, 0.000889679715302491,  
## 0.00444839857651246, 0.000889679715302491, 0.00177935943060498,  
## 0.00266903914590747, 0, 0.000889679715302491, 0.000889679715302491,  
## 0, 0.000889679715302491, 0.000889679715302491, 0, 0, 0, 0.0160142348754448,  
## 0.0186832740213523, 0.00622775800711744, 0, 0.0186832740213523,  
## 0.00177935943060498, 0, 0.00711743772241993, 0.00177935943060498,  
## 0, 0.00444839857651246, 0, 0.000889679715302491, 0.00355871886120997,  
## 0.00177935943060498, 0, 0, 0.0124555160142349, 0.000889679715302491,  
## 0.0097864768683274, 0, 0.0231316725978648, 0.000889679715302491,  
## 0.00533807829181495, 0.0249110320284698, 0.00444839857651246,  
## 0.00444839857651246, 0.00177935943060498, 0.000889679715302491,  
## 0.000889679715302491, 0, 0.00177935943060498, 0, 0, 0.00177935943060498,  
## 0, 0.000889679715302491, 0.0231316725978648, 0.000889679715302491,  
## 0.00800711743772242, 0.000889679715302491, 0, 0, 0.00266903914590747,  
## 0.000889679715302491, 0, 0.00177935943060498, 0, 0.00533807829181495,  
## 0.00177935943060498, 0.00444839857651246, 0.0097864768683274,  
## 0.000889679715302491, 0.000889679715302491, 0.00800711743772242,  
## 0, 0.000889679715302491, 0.0275800711743772, 0.0338078291814947,  
## 0.00177935943060498, 0.00177935943060498, 0, 0.00622775800711744,  
## 0.000889679715302491, 0.0115658362989324, 0, 0.000889679715302491,  
## 0.000889679715302491, 0.00177935943060498, 0.0400355871886121,  
## 0.0222419928825623, 0, 0, 0, 0.000889679715302491, 0, 0, 0, 0,  
## 0, 0.000889679715302491, 0, 0, 0.000889679715302491, 0.00177935943060498,  
## 0, 0, 0.00622775800711744, 0.00266903914590747, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0.00177935943060498,  
## 0, 0, 0, 0.000889679715302491, 0.000889679715302491, 0, 0, 0,  
## 0.00444839857651246, 0, 0, 0.00266903914590747, 0.000889679715302491,  
## 0.00266903914590747, 0, 0, 0, 0.00177935943060498, 0, 0, 0.00177935943060498,  
## 0, 0.00889679715302491, 0, 0.00177935943060498, 0.000889679715302491,  
## 0.00177935943060498, 0.000889679715302491, 0, 0.00177935943060498,  
## 0.00355871886120996, 0, 0, 0, 0, 0, 0.000889679715302491, 0,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000889679715302491, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0, 0, 0, 0,  
## 0.000889679715302491, 0, 0, 0, 0, 0.00177935943060498, 0, 0,  
## 0.00355871886120996, 0.00177935943060498, 0.000889679715302491,  
## 0.000889679715302491, 0.00711743772241993, 0, 0, 0.00355871886120997,  
## 0.0293594306049822, 0.0204626334519573, 0, 0, 0, 0, 0.0275800711743772,  
## 0, 0, 0.0258007117437722, 0.00177935943060498, 0.00177935943060498,  
## 0.0097864768683274, 0.000889679715302491, 0, 0.0160142348754448,  
## 0.00355871886120997, 0, 0.00444839857651246, 0, 0.000889679715302491,  
## 0, 0.00444839857651246, 0.00177935943060498, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0.000889679715302491,  
## 0, 0, 0.00177935943060498, 0.00266903914590747, 0, 0, 0.00266903914590747,  
## 0.00266903914590747, 0.00711743772241993, 0, 0.000889679715302491,  
## 0.00444839857651246, 0, 0.000889679715302491, 0.00533807829181495,  
## 0.000889679715302491, 0.0177935943060498, 0.000889679715302491,  
## 0, 0, 0, 0, 0, 0, 0, 0, 0.00355871886120997, 0, 0.00177935943060498,  
## 0, 0, 0, 0, 0.00266903914590747, 0.000889679715302491, 0, 0,  
## 0.000889679715302491, 0, 0.0124555160142349, 0.0231316725978648,  
## 0, 0.00266903914590747, 0, 0, 0.000889679715302491, 0, 0.00266903914590747,  
## 0.000889679715302491, 0.000889679715302491, 0, 0, 0.000889679715302491,  
## 0, 0, 0.00533807829181495, 0, 0, 0, 0.00266903914590747, 0.000889679715302491,  
## 0, 0, 0, 0.000889679715302491, 0, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.00266903914590747, 0, 0, 0.00177935943060498, 0.000889679715302491,  
## 0, 0.000889679715302491, 0.00266903914590747, 0, 0.000889679715302491,  
## 0.00177935943060498, 0, 0, 0, 0.00177935943060498, 0.00177935943060498,  
## 0.000889679715302491, 0, 0.00177935943060498, 0.00266903914590747,  
## 0, 0.00444839857651246, 0, 0, 0.00355871886120997, 0.000889679715302491,  
## 0, 0, 0.000889679715302491, 0.000889679715302491, 0.00355871886120996,  
## 0, 0, 0.00177935943060498, 0.00355871886120996, 0, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.00177935943060498, 0.00355871886120996,  
## 0, 0.00177935943060498, 0, 0, 0.000889679715302491, 0, 0.000889679715302491,  
## 0.0133451957295374, 0.000889679715302491, 0.000889679715302491,  
## 0, 0.00177935943060498, 0, 0, 0, 0, 0, 0, 0, 0, 0.0097864768683274,  
## 0, 0.00800711743772242, 0.000889679715302491, 0, 0.000889679715302491,  
## 0, 0, 0.00266903914590747, 0.00266903914590747, 0.00177935943060498,  
## 0, 0.00355871886120996, 0.000889679715302491, 0.00177935943060498,  
## 0, 0, 0.000889679715302491, 0, 0.00444839857651246), class = c(&quot;ProbaVector&quot;,  
## &quot;SpeciesDistribution&quot;, &quot;numeric&quot;), .Names = c(&quot;Anac_Anac_spru&quot;,  
## &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;, &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;,  
## &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;, &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;,  
## &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;, &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;,  
## &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;, &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;,  
## &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;, &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;,  
## &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;, &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;,  
## &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;, &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;,  
## &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;, &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;,  
## &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;, &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;,  
## &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;, &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;,  
## &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;, &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;,  
## &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;, &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;,  
## &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;, &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;,  
## &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;, &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;,  
## &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;, &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;,  
## &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;, &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;,  
## &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;, &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;,  
## &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;, &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;,  
## &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;, &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;,  
## &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;, &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;,  
## &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;, &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;,  
## &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;, &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;,  
## &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;, &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;,  
## &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;, &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;,  
## &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;, &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;,  
## &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;, &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;,  
## &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;, &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;,  
## &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;, &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;,  
## &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;, &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;,  
## &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;, &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;,  
## &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;, &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;,  
## &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;, &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;,  
## &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;, &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;,  
## &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;, &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;,  
## &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;, &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;,  
## &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;, &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;,  
## &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;, &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;,  
## &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;, &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;,  
## &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;, &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;,  
## &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;, &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;,  
## &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;, &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;,  
## &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;, &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;,  
## &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;, &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;,  
## &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;, &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;,  
## &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;, &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;,  
## &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;, &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;,  
## &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;, &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;,  
## &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;, &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;,  
## &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;, &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;,  
## &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;, &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;,  
## &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;, &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;,  
## &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;, &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;,  
## &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;, &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;,  
## &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;, &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;,  
## &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;, &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;,  
## &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;, &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;,  
## &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;, &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;,  
## &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;, &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;,  
## &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;, &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;,  
## &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;, &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;,  
## &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;, &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;,  
## &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;, &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;,  
## &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;, &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;,  
## &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;, &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;,  
## &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;, &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;,  
## &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;, &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;,  
## &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;, &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;,  
## &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;, &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;,  
## &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;, &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;,  
## &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;, &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;,  
## &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;, &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;,  
## &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;, &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;,  
## &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;, &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;,  
## &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;, &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;,  
## &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;, &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;,  
## &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;, &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;,  
## &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;, &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;,  
## &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;, &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;,  
## &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;, &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;,  
## &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;, &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;,  
## &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;, &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;,  
## &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;, &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;,  
## &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;, &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;,  
## &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;, &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;,  
## &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;, &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;,  
## &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;, &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;,  
## &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;, &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;,  
## &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;, &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;,  
## &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;, &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;,  
## &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;, &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;,  
## &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;, &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;,  
## &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;, &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;,  
## &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;, &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;,  
## &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;, &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;,  
## &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;, &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;,  
## &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;, &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;,  
## &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;, &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;,  
## &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;, &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;,  
## &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;, &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;,  
## &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;, &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;,  
## &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;, &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;,  
## &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;, &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;,  
## &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;, &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;,  
## &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;, &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;,  
## &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;, &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;,  
## &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;, &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot; ))
##  with correction: None
## Phylogenetic or functional entropy was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Entropy is normalized
## 
## Entropy equals: 3.919941</code></pre>
<pre class="r"><code>plot(e)</code></pre>
<p><img src="rd_files/figure-html/PhyloEntropy_id_22-1.png" width="624" /></p>
<pre class="r"><code># Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Calculate the phylogenetic Shannon entropy of the plot
summary(bcPhyloEntropy(Ns, 1, Paracou618.Taxonomy, Correction = &quot;Best&quot;) -&gt; e)</code></pre>
<pre><code>## alpha or gamma phylogenetic or functional entropy of order 1 
## of distribution 
## structure(c(3L, 0L, 3L, 4L, 1L, 2L, 0L, 0L, 0L, 2L, 0L, 40L,  
## 0L, 0L, 1L, 6L, 6L, 1L, 2L, 1L, 4L, 0L, 0L, 3L, 0L, 2L, 0L, 1L,  
## 4L, 1L, 14L, 4L, 5L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 2L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 8L, 3L, 2L, 1L, 0L, 1L, 4L, 0L, 4L, 2L, 9L, 0L,  
## 4L, 0L, 1L, 5L, 1L, 2L, 3L, 0L, 1L, 1L, 0L, 1L, 1L, 0L, 0L, 0L,  
## 18L, 21L, 7L, 0L, 21L, 2L, 0L, 8L, 2L, 0L, 5L, 0L, 1L, 4L, 2L,  
## 0L, 0L, 14L, 1L, 11L, 0L, 26L, 1L, 6L, 28L, 5L, 5L, 2L, 1L, 1L,  
## 0L, 2L, 0L, 0L, 2L, 0L, 1L, 26L, 1L, 9L, 1L, 0L, 0L, 3L, 1L,  
## 0L, 2L, 0L, 6L, 2L, 5L, 11L, 1L, 1L, 9L, 0L, 1L, 31L, 38L, 2L,  
## 2L, 0L, 7L, 1L, 13L, 0L, 1L, 1L, 2L, 45L, 25L, 0L, 0L, 0L, 1L,  
## 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 1L, 2L, 0L, 0L, 7L, 3L, 1L, 1L,  
## 1L, 0L, 0L, 2L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L, 5L, 0L, 0L, 3L,  
## 1L, 3L, 0L, 0L, 0L, 2L, 0L, 0L, 2L, 0L, 10L, 0L, 2L, 1L, 2L,  
## 1L, 0L, 2L, 4L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 0L, 0L, 0L, 0L, 0L,  
## 0L, 1L, 0L, 0L, 0L, 0L, 2L, 0L, 0L, 4L, 2L, 1L, 1L, 8L, 0L, 0L,  
## 4L, 33L, 23L, 0L, 0L, 0L, 0L, 31L, 0L, 0L, 29L, 2L, 2L, 11L,  
## 1L, 0L, 18L, 4L, 0L, 5L, 0L, 1L, 0L, 5L, 2L, 3L, 1L, 1L, 1L,  
## 0L, 0L, 2L, 3L, 0L, 0L, 3L, 3L, 8L, 0L, 1L, 5L, 0L, 1L, 6L, 1L,  
## 20L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 4L, 0L, 2L, 0L, 0L,  
## 0L, 0L, 3L, 1L, 0L, 0L, 1L, 0L, 14L, 26L, 0L, 3L, 0L, 0L, 1L,  
## 0L, 3L, 1L, 1L, 0L, 0L, 1L, 0L, 0L, 6L, 0L, 0L, 0L, 3L, 1L, 0L,  
## 0L, 0L, 1L, 0L, 1L, 0L, 1L, 3L, 0L, 0L, 2L, 1L, 0L, 1L, 3L, 0L,  
## 1L, 2L, 0L, 0L, 0L, 2L, 2L, 1L, 0L, 2L, 3L, 0L, 5L, 0L, 0L, 4L,  
## 1L, 0L, 0L, 1L, 1L, 4L, 0L, 0L, 2L, 4L, 0L, 1L, 0L, 0L, 3L, 2L,  
## 4L, 0L, 2L, 0L, 0L, 1L, 0L, 1L, 15L, 1L, 1L, 0L, 2L, 0L, 0L,  
## 0L, 0L, 0L, 0L, 0L, 0L, 11L, 0L, 9L, 1L, 0L, 1L, 0L, 0L, 3L,  
## 3L, 2L, 0L, 4L, 1L, 2L, 0L, 0L, 1L, 0L, 5L), class = c(&quot;AbdVector&quot;,  
## &quot;SpeciesDistribution&quot;, &quot;integer&quot;), .Names = c(&quot;Anac_Anac_spru&quot;,  
## &quot;Anac_Astr_ulei&quot;, &quot;Anac_Tapi_guia&quot;, &quot;Anac_Thyr_guia&quot;, &quot;Anac_Thyr_pube&quot;,  
## &quot;Anno_Dugu_caly&quot;, &quot;Anno_Dugu_suri&quot;, &quot;Anno_Fusa_long&quot;, &quot;Anno_Guat_anth&quot;,  
## &quot;Anno_Guat_guia&quot;, &quot;Anno_Guat_wach&quot;, &quot;Anno_Oxan_asbe&quot;, &quot;Anno_Roll_elli&quot;,  
## &quot;Anno_Unon_perr&quot;, &quot;Anno_Unon_rufe&quot;, &quot;Anno_Xylo_niti&quot;, &quot;Apoc_Ambe_acid&quot;,  
## &quot;Apoc_Anar_meye&quot;, &quot;Apoc_Aspi_albu&quot;, &quot;Apoc_Aspi_crue&quot;, &quot;Apoc_Aspi_marc&quot;,  
## &quot;Apoc_Aspi_oblo&quot;, &quot;Apoc_Aspi_spru&quot;, &quot;Apoc_Coum_guia&quot;, &quot;Apoc_Hima_sp_&quot;,  
## &quot;Apoc_Lacm_acul&quot;, &quot;Aqui_Ilex_sp_&quot;, &quot;Aral_Sche_deca&quot;, &quot;Arec_Astr_scio&quot;,  
## &quot;Arec_Eute_oler&quot;, &quot;Arec_Jess_bata&quot;, &quot;Arec_Oeno_baca&quot;, &quot;Bign_Jaca_copa&quot;,  
## &quot;Bign_Tabe_sp_&quot;, &quot;Bora_Cord_IND&quot;, &quot;Bora_Cord_sago&quot;, &quot;Bora_Cord_sp_&quot;,  
## &quot;Bras_Capp_maro&quot;, &quot;Burs_Crep_goud&quot;, &quot;Burs_Dacr_cusp&quot;, &quot;Burs_Dacr_nite&quot;,  
## &quot;Burs_Dacr_sp_&quot;, &quot;Burs_Prot_apic&quot;, &quot;Burs_Prot_deca&quot;, &quot;Burs_Prot_gall&quot;,  
## &quot;Burs_Prot_guia&quot;, &quot;Burs_Prot_mori&quot;, &quot;Burs_Prot_opac&quot;, &quot;Burs_Prot_sago&quot;,  
## &quot;Burs_Prot_subs&quot;, &quot;Burs_Prot_tenu&quot;, &quot;Burs_Prot_trif&quot;, &quot;Burs_Tetr_alti&quot;,  
## &quot;Burs_Tetr_pana&quot;, &quot;Burs_Trat_deme&quot;, &quot;Cary_Cary_glab&quot;, &quot;Cela_Chei_cogn&quot;,  
## &quot;Cela_Goup_glab&quot;, &quot;Cela_IND_sp_&quot;, &quot;Cela_Mayt_oblo&quot;, &quot;Cela_Mayt_sp_1&quot;,  
## &quot;Cela_Mayt_sp_2&quot;, &quot;Chry_Coue_brac&quot;, &quot;Chry_Coue_cary&quot;, &quot;Chry_Coue_guia&quot;,  
## &quot;Chry_Coue_habr&quot;, &quot;Chry_Coue_joaq&quot;, &quot;Chry_Coue_magn&quot;, &quot;Chry_Coue_pari&quot;,  
## &quot;Chry_Hirt_arag&quot;, &quot;Chry_Hirt_glandi&quot;, &quot;Chry_Hirt_glandu&quot;, &quot;Chry_Hirt_IND&quot;,  
## &quot;Chry_Hirt_suff&quot;, &quot;Chry_IND_IND&quot;, &quot;Chry_Lica_alba&quot;, &quot;Chry_Lica_cane&quot;,  
## &quot;Chry_Lica_hete&quot;, &quot;Chry_Lica_IND&quot;, &quot;Chry_Lica_laxi&quot;, &quot;Chry_Lica_lica&quot;,  
## &quot;Chry_Lica_maju&quot;, &quot;Chry_Lica_memb&quot;, &quot;Chry_Lica_micr&quot;, &quot;Chry_Lica_minu&quot;,  
## &quot;Chry_Lica_oval&quot;, &quot;Chry_Lica_sp_1&quot;, &quot;Chry_Lica_sp_2&quot;, &quot;Chry_Lica_spru&quot;,  
## &quot;Chry_Pari_camp&quot;, &quot;Chry_Pari_mont&quot;, &quot;Clus_Clus_gran&quot;, &quot;Clus_Moro_cocc&quot;,  
## &quot;Clus_Plat_insi&quot;, &quot;Clus_Rhee_madr&quot;, &quot;Clus_Symp_glob&quot;, &quot;Clus_Symp_sp_&quot;,  
## &quot;Clus_Tovo_IND&quot;, &quot;Clus_Tovo_sp_1&quot;, &quot;Clus_Tovo_sp_2&quot;, &quot;Clus_Tovo_sp_3&quot;,  
## &quot;Clus_Tovo_sp_4&quot;, &quot;Clus_Tovo_sp_5&quot;, &quot;Clus_Tovo_sp_6&quot;, &quot;Clus_Tovo_sp_7&quot;,  
## &quot;Clus_Vism_caye&quot;, &quot;Comb_Buch_gran&quot;, &quot;Comb_Buch_guia&quot;, &quot;Comb_Buch_IND&quot;,  
## &quot;Comb_Buch_tetr&quot;, &quot;Comb_Term_guia&quot;, &quot;Dich_Tapu_amaz&quot;, &quot;Dich_Tapu_capi&quot;,  
## &quot;Eben_Dios_capr&quot;, &quot;Eben_Dios_carb&quot;, &quot;Elae_Sloa_brev&quot;, &quot;Elae_Sloa_garc&quot;,  
## &quot;Elae_Sloa_guia&quot;, &quot;Elae_Sloa_lati&quot;, &quot;Elae_Sloa_sp_1&quot;, &quot;Elae_Sloa_sp_2&quot;,  
## &quot;Elae_Sloa_sp_3&quot;, &quot;Elae_Sloa_sp_4&quot;, &quot;Euph_Chae_scho&quot;, &quot;Euph_Chae_sp_&quot;,  
## &quot;Euph_Conc_guia&quot;, &quot;Euph_Dryp_fans&quot;, &quot;Euph_Dryp_vari&quot;, &quot;Euph_Glyc_amaz&quot;,  
## &quot;Euph_Heve_guia&quot;, &quot;Euph_Hyer_alch&quot;, &quot;Euph_Mabe_piri&quot;, &quot;Euph_Pogo_scho&quot;,  
## &quot;Euph_Sand_guia&quot;, &quot;Faba_Abar_jupu&quot;, &quot;Faba_Abar_mata&quot;, &quot;Faba_Andi_IND&quot;,  
## &quot;Faba_Boco_prou&quot;, &quot;Faba_Cass_spru&quot;, &quot;Faba_Dico_guia&quot;, &quot;Faba_Dipl_purp&quot;,  
## &quot;Faba_Dipt_odor&quot;, &quot;Faba_Dipt_punc&quot;, &quot;Faba_Ente_scho&quot;, &quot;Faba_Eper_falc&quot;,  
## &quot;Faba_Eper_gran&quot;, &quot;Faba_Hyme_cour&quot;, &quot;Faba_Hyme_flav&quot;, &quot;Faba_IND_sp_&quot;,  
## &quot;Faba_Inga_acre&quot;, &quot;Faba_Inga_acro&quot;, &quot;Faba_Inga_alba&quot;, &quot;Faba_Inga_albi&quot;,  
## &quot;Faba_Inga_brac&quot;, &quot;Faba_Inga_fanc&quot;, &quot;Faba_Inga_grac&quot;, &quot;Faba_Inga_hube&quot;,  
## &quot;Faba_Inga_leio&quot;, &quot;Faba_Inga_long&quot;, &quot;Faba_Inga_loub&quot;, &quot;Faba_Inga_nour&quot;,  
## &quot;Faba_Inga_para&quot;, &quot;Faba_Inga_pezi&quot;, &quot;Faba_Inga_rubi&quot;, &quot;Faba_Inga_sarm&quot;,  
## &quot;Faba_Inga_stip&quot;, &quot;Faba_Ormo_stip&quot;, &quot;Faba_Papi_IND&quot;, &quot;Faba_Park_giga&quot;,  
## &quot;Faba_Park_niti&quot;, &quot;Faba_Park_pend&quot;, &quot;Faba_Park_sp_&quot;, &quot;Faba_Park_ulei&quot;,  
## &quot;Faba_Park_velu&quot;, &quot;Faba_Pelt_pani&quot;, &quot;Faba_Plat_pinn&quot;, &quot;Faba_Pseu_psil&quot;,  
## &quot;Faba_Pseu_suav&quot;, &quot;Faba_Reco_spec&quot;, &quot;Faba_Stry_mori&quot;, &quot;Faba_Swar_cane&quot;,  
## &quot;Faba_Swar_lebl&quot;, &quot;Faba_Swar_pana&quot;, &quot;Faba_Swar_poly&quot;, &quot;Faba_Swar_sp_&quot;,  
## &quot;Faba_Tach_brac&quot;, &quot;Faba_Tach_guia&quot;, &quot;Faba_Tach_meli&quot;, &quot;Faba_Tach_pani&quot;,  
## &quot;Faba_Tach_para&quot;, &quot;Faba_Vata_eryt&quot;, &quot;Faba_Vata_suri&quot;, &quot;Faba_Voua_amer&quot;,  
## &quot;Faba_Zygi_race&quot;, &quot;Faba_Zygi_tetr&quot;, &quot;Humi_Humi_subc&quot;, &quot;Humi_Saco_guia&quot;,  
## &quot;Humi_Vant_parv&quot;, &quot;Icac_Dend_boli&quot;, &quot;Icac_Emmo_fagi&quot;, &quot;Icac_Pora_guia&quot;,  
## &quot;Ixon_Cyri_para&quot;, &quot;Laur_Aiou_long&quot;, &quot;Laur_Anib_host&quot;, &quot;Laur_Anib_term&quot;,  
## &quot;Laur_Endl_meli&quot;, &quot;Laur_IND_sp_1&quot;, &quot;Laur_IND_sp_2&quot;, &quot;Laur_IND_sp_3&quot;,  
## &quot;Laur_IND_sp_4&quot;, &quot;Laur_IND_sp_5&quot;, &quot;Laur_IND_sp_6&quot;, &quot;Laur_IND_sp_7&quot;,  
## &quot;Laur_IND_sp_8&quot;, &quot;Laur_IND_sp_9&quot;, &quot;Laur_IND_sp_10&quot;, &quot;Laur_IND_sp_11&quot;,  
## &quot;Laur_IND_sp_12&quot;, &quot;Laur_IND_sp_13&quot;, &quot;Laur_IND_sp_14&quot;, &quot;Laur_IND_sp_15&quot;,  
## &quot;Laur_IND_sp_16&quot;, &quot;Laur_IND_sp_17&quot;, &quot;Laur_IND_sp_18&quot;, &quot;Laur_IND_sp_19&quot;,  
## &quot;Laur_IND_sp_20&quot;, &quot;Laur_Lica_cann&quot;, &quot;Laur_Lica_chry&quot;, &quot;Laur_Lica_guia&quot;,  
## &quot;Laur_Ocot_amaz&quot;, &quot;Laur_Ocot_argy&quot;, &quot;Laur_Ocot_indi&quot;, &quot;Laur_Ocot_perc&quot;,  
## &quot;Laur_Ocot_sp_&quot;, &quot;Laur_Ocot_subt&quot;, &quot;Laur_Rhod_gran&quot;, &quot;Laur_Rhod_kunt&quot;,  
## &quot;Laur_Rhod_rufo&quot;, &quot;Laur_Sext_rubr&quot;, &quot;Lecy_Cour_caly&quot;, &quot;Lecy_Cour_glor&quot;,  
## &quot;Lecy_Cour_guia&quot;, &quot;Lecy_Cour_mult&quot;, &quot;Lecy_Cour_oblo&quot;, &quot;Lecy_Esch_char&quot;,  
## &quot;Lecy_Esch_cong&quot;, &quot;Lecy_Esch_cori&quot;, &quot;Lecy_Esch_deco&quot;, &quot;Lecy_Esch_gran&quot;,  
## &quot;Lecy_Esch_micr&quot;, &quot;Lecy_Esch_pedi&quot;, &quot;Lecy_Esch_prae&quot;, &quot;Lecy_Esch_sago&quot;,  
## &quot;Lecy_Esch_simi&quot;, &quot;Lecy_Esch_squa&quot;, &quot;Lecy_Gust_hexa&quot;, &quot;Lecy_IND_sp_&quot;,  
## &quot;Lecy_Lecy_char&quot;, &quot;Lecy_Lecy_corr&quot;, &quot;Lecy_Lecy_holc&quot;, &quot;Lecy_Lecy_idat&quot;,  
## &quot;Lecy_Lecy_pers&quot;, &quot;Lecy_Lecy_poit&quot;, &quot;Lecy_Lecy_zabu&quot;, &quot;Lina_Hebe_humi&quot;,  
## &quot;Loga_Anto_ovat&quot;, &quot;Loga_Stry_IND&quot;, &quot;Malp_Bunc_sp_&quot;, &quot;Malv_Apei_glab&quot;,  
## &quot;Malv_Apei_peto&quot;, &quot;Malv_Cato_frag&quot;, &quot;Malv_Erio_long&quot;, &quot;Malv_Erio_sp_1&quot;,  
## &quot;Malv_Erio_sp_2&quot;, &quot;Malv_IND_sp_1&quot;, &quot;Malv_IND_sp_2&quot;, &quot;Malv_Lueh_rugo&quot;,  
## &quot;Malv_Pach_doli&quot;, &quot;Malv_Quar_duck&quot;, &quot;Malv_Ster_mult&quot;, &quot;Malv_Ster_prur&quot;,  
## &quot;Malv_Ster_spec&quot;, &quot;Malv_Theo_subi&quot;, &quot;Marc_Nora_IND&quot;, &quot;Mela_Henr_flav&quot;,  
## &quot;Mela_Mico_acum&quot;, &quot;Mela_Mico_sp_&quot;, &quot;Mela_Mico_tsch&quot;, &quot;Mela_Mour_cras&quot;,  
## &quot;Mela_Mour_hube&quot;, &quot;Meli_Cara_proc&quot;, &quot;Meli_Guar_guid&quot;, &quot;Meli_Guar_silv&quot;,  
## &quot;Meli_Tric_cipo&quot;, &quot;Meli_Tric_pall&quot;, &quot;Meli_Tric_suri&quot;, &quot;Moni_Sipa_cris&quot;,  
## &quot;Moni_Sipa_deci&quot;, &quot;Moni_Sipa_pach&quot;, &quot;Mora_Baga_guia&quot;, &quot;Mora_Bros_guia&quot;,  
## &quot;Mora_Bros_rube&quot;, &quot;Mora_Bros_util&quot;, &quot;Mora_Ficu_sp_&quot;, &quot;Mora_Heli_pedu&quot;,  
## &quot;Mora_Heli_tome&quot;, &quot;Mora_Maqu_calo&quot;, &quot;Mora_Maqu_guia&quot;, &quot;Mora_Nauc_guia&quot;,  
## &quot;Mora_Pere_guia&quot;, &quot;Mora_Pere_rubr&quot;, &quot;Mora_Trym_amaz&quot;, &quot;Mora_Trym_olig&quot;,  
## &quot;Myri_Irya_host&quot;, &quot;Myri_Irya_sago&quot;, &quot;Myri_Viro_kwat&quot;, &quot;Myri_Viro_mich&quot;,  
## &quot;Myrt_Euge_coff&quot;, &quot;Myrt_Euge_cucu&quot;, &quot;Myrt_Euge_cupu&quot;, &quot;Myrt_Euge_macr&quot;,  
## &quot;Myrt_Euge_patr&quot;, &quot;Myrt_Euge_pseu&quot;, &quot;Myrt_Euge_sp_1&quot;, &quot;Myrt_Euge_sp_2&quot;,  
## &quot;Myrt_Euge_sp_3&quot;, &quot;Myrt_Euge_tetr&quot;, &quot;Myrt_IND_IND&quot;, &quot;Myrt_IND_sp_&quot;,  
## &quot;Myrt_Myrc_deco&quot;, &quot;Myrt_Myrc_magn&quot;, &quot;Nyct_Neea_flor&quot;, &quot;Nyct_Neea_sp_&quot;,  
## &quot;Olac_Chau_kapp&quot;, &quot;Olac_Heis_dens&quot;, &quot;Olac_Minq_guia&quot;, &quot;Olac_Ptyc_olac&quot;,  
## &quot;Opil_Agon_silv&quot;, &quot;Poly_Cocc_moll&quot;, &quot;Quii_Lacu_cren&quot;, &quot;Quii_Lacu_jenm&quot;,  
## &quot;Quii_Quii_guia&quot;, &quot;Rubi_Amai_guia&quot;, &quot;Rubi_Chim_turb&quot;, &quot;Rubi_Duro_aqua&quot;,  
## &quot;Rubi_Duro_erio&quot;, &quot;Rubi_Duro_long&quot;, &quot;Rubi_Fara_pedu&quot;, &quot;Rubi_Guet_acre&quot;,  
## &quot;Rubi_IND_IND&quot;, &quot;Rubi_Poso_lati&quot;, &quot;Rubi_Psyc_mapo&quot;, &quot;Sali_Case_deca&quot;,  
## &quot;Sali_Case_javi&quot;, &quot;Sali_Case_sylv&quot;, &quot;Sapi_Allo_angu&quot;, &quot;Sapi_Cupa_diph&quot;,  
## &quot;Sapi_Cupa_rubi&quot;, &quot;Sapi_Cupa_scro&quot;, &quot;Sapi_Meli_pedi&quot;, &quot;Sapi_Tali_micr&quot;,  
## &quot;Sapi_Tali_prae&quot;, &quot;Sapi_Tali_sima&quot;, &quot;Sapi_Voua_guia&quot;, &quot;Sapo_Chry_arge&quot;,  
## &quot;Sapo_Chry_exim&quot;, &quot;Sapo_Chry_luce&quot;, &quot;Sapo_Chry_prie&quot;, &quot;Sapo_Chry_sang&quot;,  
## &quot;Sapo_Dipl_cusp&quot;, &quot;Sapo_Eccl_rami&quot;, &quot;Sapo_Elae_nuda&quot;, &quot;Sapo_Elae_sp_&quot;,  
## &quot;Sapo_Mani_bide&quot;, &quot;Sapo_Mani_hube&quot;, &quot;Sapo_Micr_caye&quot;, &quot;Sapo_Micr_egen&quot;,  
## &quot;Sapo_Micr_guya&quot;, &quot;Sapo_Micr_long&quot;, &quot;Sapo_Micr_obsc&quot;, &quot;Sapo_Micr_porp&quot;,  
## &quot;Sapo_Micr_sanc&quot;, &quot;Sapo_Micr_venu&quot;, &quot;Sapo_Pout_ambe&quot;, &quot;Sapo_Pout_bang&quot;,  
## &quot;Sapo_Pout_bena&quot;, &quot;Sapo_Pout_bilo&quot;, &quot;Sapo_Pout_clad&quot;, &quot;Sapo_Pout_deco&quot;,  
## &quot;Sapo_Pout_euge&quot;, &quot;Sapo_Pout_fili&quot;, &quot;Sapo_Pout_fimb&quot;, &quot;Sapo_Pout_gong&quot;,  
## &quot;Sapo_Pout_guia&quot;, &quot;Sapo_Pout_hisp&quot;, &quot;Sapo_Pout_jari&quot;, &quot;Sapo_Pout_mela&quot;,  
## &quot;Sapo_Pout_retic&quot;, &quot;Sapo_Pout_retin&quot;, &quot;Sapo_Pout_sing&quot;, &quot;Sapo_Pout_sp_1&quot;,  
## &quot;Sapo_Pout_sp_2&quot;, &quot;Sapo_Pout_sp_3&quot;, &quot;Sapo_Pout_tort&quot;, &quot;Sapo_Pout_veno&quot;,  
## &quot;Sapo_Prad_coch&quot;, &quot;Sapo_Prad_ptyc&quot;, &quot;Sima_Sima_cedr&quot;, &quot;Sima_Sima_more&quot;,  
## &quot;Sima_Sima_poly&quot;, &quot;Sima_Sima_amar&quot;, &quot;Styr_Styr_sp_&quot;, &quot;Symp_Symp_mart&quot;,  
## &quot;Urti_Cecr_obtu&quot;, &quot;Urti_Pour_bico&quot;, &quot;Urti_Pour_meli&quot;, &quot;Urti_Pour_tome&quot;,  
## &quot;Urti_Pour_vill&quot;, &quot;Viol_Amph_long&quot;, &quot;Viol_Leon_glyc&quot;, &quot;Voch_Eris_flor&quot;,  
## &quot;Voch_Eris_unci&quot;, &quot;Voch_IND_sp_&quot;, &quot;Voch_Qual_rose&quot;, &quot;Voch_Ruiz_albi&quot; ))
##  with correction: Best
## Phylogenetic or functional entropy was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Entropy is normalized
## 
## Entropy equals: 4.003384</code></pre>
<pre class="r"><code>plot(e)</code></pre>
<p><img src="rd_files/figure-html/PhyloEntropy_id_22-2.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#tsallis>Tsallis</a></code>, <code><a href=#phylodiversity>PhyloDiversity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="rao-rao-bcrao-rao.probavector-rao.abdvector-rao.integer-rao.numeric" class="section level2">
<h2>Rao: Rao, bcRao, Rao.ProbaVector, Rao.AbdVector, Rao.integer, Rao.numeric</h2>
<a id="Rao_alias"></a>
<h3>
Rao Quadratic Entropy of a Community
</h3>
<p class="rd-p">
Calculates Rao’s quadratic entropy of a community described by a probability vector and a phylogenetic / functional tree.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Rao(NorP, Tree, ...)
bcRao(Ns, Tree, Correction="Lande", CheckArguments&nbsp;=&nbsp;TRUE)
"Rao"(NorP, Tree, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"Rao"(NorP, Tree, Correction&nbsp;=&nbsp;"Lande", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Rao"(NorP, Tree, Correction&nbsp;=&nbsp;"Lande", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Rao"(NorP, Tree, Correction&nbsp;=&nbsp;"Lande", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections accepted by <code><a href=#tsallis>bcTsallis</a></code> or <code>“Lande”</code>, the default value (equivalent to <code>“Best”</code>).
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Bias correction requires the number of individuals. Use <code>bcRao</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
The unbiased estimator of Raos entropy is identical to that of Simpsons entropy because Raos entropy is a linear sum of Simson entropies, all of them calculated from the same number of individuals (Marcon and Herault, 2014). It equals the plug-in etimator multiplied by n/(n-1) where n is the total number of individuals.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Tsallis</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcTsallis</code> is called. Explicit calls to <code>bcTsallis</code> (with bias correction) or to <code>Tsallis.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated entropy. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Rao, C. R. (1982). Diversity and dissimilarity coefficients: a unified approach. <em>Theoretical Population Biology</em> 21: 24-43.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Calculate Rao&#39;s quadratic entropy of the plot
Rao(Ps, Paracou618.Taxonomy)</code></pre>
<pre><code>##     None 
## 2.878133</code></pre>
<h4>
See also
</h4>
<p><code><a href=#phylodiversity>bcPhyloDiversity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="richness-bcrichness-richness-richness.probavector-richness.abdvector-richness.integer-richness.numeric" class="section level2">
<h2>Richness: bcRichness, Richness, Richness.ProbaVector, Richness.AbdVector, Richness.integer, Richness.numeric</h2>
<a id="Richness_alias"></a>
<h3>
Number of species of a community
</h3>
<p class="rd-p">
Calculates the number of species from probability vector. The name is that of the estimator (the bias correction) used.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Richness(NorP, ...)
bcRichness(Ns, Correction&nbsp;=&nbsp;"Chao1", Alpha&nbsp;=&nbsp;0.05, JackOver&nbsp;=&nbsp;FALSE,  CheckArguments&nbsp;=&nbsp;TRUE)
"Richness"(NorP, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"Richness"(NorP, Correction&nbsp;=&nbsp;"Chao1", Alpha&nbsp;=&nbsp;0.05, JackOver&nbsp;=&nbsp;FALSE,  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Richness"(NorP, Correction&nbsp;=&nbsp;"Chao1", Alpha&nbsp;=&nbsp;0.05, JackOver&nbsp;=&nbsp;FALSE,  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Richness"(NorP, Correction&nbsp;=&nbsp;"Chao1", Alpha&nbsp;=&nbsp;0.05, JackOver&nbsp;=&nbsp;FALSE,  ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: <code>“None”</code> (no correction), <code>“Jackknife”</code>, <code>“iChao1”</code>, or <code>“Chao1”</code>, the default value.
</dd>
<dt>
Alpha
</dt>
<dd class="rd-dd">
The risk level, 5% by default, used to optimize the jackknife order.
</dd>
<dt>
JackOver
</dt>
<dd class="rd-dd">
If <code>TRUE</code>, retain the jackknife order immediately superior to the optimal one, usually resulting in the overestimation of the number of species. Default is <code>FALSE</code>.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Bias correction requires the number of individuals. Use <code>bcRichness</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
Chao correction techniques are from Chao (1984) and Chiu <em>et al.</em> (2015). The Jackknife estimator is calculating by a straight adaptation of the code by Ji-Ping Wang (<code><a href=http://www.rdocumentation.org/packages/SPECIES/topics/jackknife>jackknife</a></code> in package <code>SPECIES</code>). The optimal order is selected according to Burnham and Overton (1978; 1979). The argument <code>JackOver</code> allows selecting one order over the optimal one. Many other estimators are available elsewhere, the ones implemented here are necessary for other entropy estimations.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Richness</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcRichness</code> is called. Explicit calls to <code>bcRichness</code> (with bias correction) or to <code>Richness.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the estimated number of species.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Burnham, K. P., and Overton,W. S. (1978), Estimation of the Size of a Closed Population When Capture Probabilities Vary Among Animals. <em>Biometrika</em>, 65:625-633.
</p>
<p class="rd-p">
Burnham, K. P., and Overton,W. S. (1979), Robust Estimation of Population Size When Capture Probabilities Vary Among Animals. <em>Ecology</em> 60:927-936.
</p>
<p class="rd-p">
Chao, A. (1984) Nonparametric estimation of the number of classes in a population. <em>Scandinavian Journal of Statistics</em> 11:265-270.
</p>
<p class="rd-p">
Chiu, C.-H., Wang, Y.-T., Walther, B. A., Chao, A. (2014) An Improved Nonparametric Lower Bound of Species Richness via a Modified Good-Turing Frequency Formula. <em>Biometrics</em> 70(3):671-682.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)</code></pre>
<p><img src="rd_files/figure-html/Richness_id_24-1.png" width="624" /></p>
<pre class="r"><code># Number of observed species
Richness(Ps)</code></pre>
<pre><code>## None 
##  229</code></pre>
<pre class="r"><code># Estimate the actual number of species
bcRichness(Ns, Correction = &quot;Chao1&quot;)</code></pre>
<pre><code>##    Chao1 
## 314.9348</code></pre>
<pre class="r"><code>bcRichness(Ns, Correction = &quot;iChao1&quot;)</code></pre>
<pre><code>##   iChao1 
## 333.7466</code></pre>
<pre class="r"><code>bcRichness(Ns, Correction = &quot;Jackknife&quot;)</code></pre>
<pre><code>## Jackknife 2 
##         359</code></pre>
<pre class="r"><code>bcRichness(Ns, Correction = &quot;Jackknife&quot;, JackOver=TRUE)</code></pre>
<pre><code>## Jackknife 3 
##         381</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="shannon-bcshannon-shannon-shannon.probavector-shannon.abdvector-shannon.integer-shannon.numeric" class="section level2">
<h2>Shannon: bcShannon, Shannon, Shannon.ProbaVector, Shannon.AbdVector, Shannon.integer, Shannon.numeric</h2>
<a id="Shannon_alias"></a>
<h3>
Shannon entropy of a community
</h3>
<p class="rd-p">
Calculates the Shannon entropy of a probability vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Shannon(NorP, ...)
bcShannon(Ns, Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"Shannon"(NorP, ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"Shannon"(NorP, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Shannon"(NorP, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Shannon"(NorP, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: <code>“None”</code> (no correction), <code>“ChaoShen”</code>, <code>“GenCov”</code>, <code>“Grassberger”</code>, <code>“Grassberger2003”</code>, <code>“Schurmann”</code>, <code>“Holste”</code>, <code>“Bonachela”</code>, <code>“Miller”</code>, <code>“ZhangHz”</code>, <code>“ChaoWangJost”</code>, <code>“Marcon”</code>, <code>“UnveilC”</code>, <code>“UnveiliC”</code>, <code>“UnveilJ”</code> or <code>“Best”</code>, the default value. Currently, <code>“Best”</code> is <code>“ChaoWangJost”</code>.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcShannon</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
Correction techniques are from Miller (1955), Chao and Shen (2003), Grassberger (1988), Grassberger (2003), Schurmann (2003), Holste <em>et al.</em> (1998), Bonachela <em>et al.</em> (2008), Zhang (2012), Chao, Wang and Jost (2013). More estimators can be found in the <code>entropy</code> package.
</p>
<p class="rd-p">
Using <code><a href=#metacommunity>MetaCommunity</a></code> mutual information, Chao, Wang and Jost (2013) calculate reduced-bias Shannon beta entropy (see the last example below) with better results than the Chao and Shen estimator, but community weights cannot be arbitrary: they must be proportional to the number of individuals.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Shannon</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcShannon</code> is called. Explicit calls to <code>bcShannon</code> (with bias correction) or to <code>Shannon.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated entropy. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Bonachela, J. A., Hinrichsen, H. and Munoz, M. A. (2008). Entropy estimates of small data sets. <em>Journal of Physics A: Mathematical and Theoretical</em> 41(202001): 1-9.
</p>
<p class="rd-p">
Chao, A. and Shen, T. J. (2003). Nonparametric estimation of Shannons index of diversity when there are unseen species in sample. <em>Environmental and Ecological Statistics</em> 10(4): 429-443.
</p>
<p class="rd-p">
Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11):1091-1100.
</p>
<p class="rd-p">
Grassberger, P. (1988). Finite sample corrections to entropy and dimension estimates. <em>Physics Letters A</em> 128(6-7): 369-373.
</p>
<p class="rd-p">
Grassberger, P. (2003). Entropy Estimates from Insufficient Samplings. <em>ArXiv Physics e-prints</em> 0307138.
</p>
<p class="rd-p">
Holste, D., Grosse, I. and Herzel, H. (1998). Bayes estimators of generalized entropies. <em>Journal of Physics A: Mathematical and General</em> 31(11): 2551-2566.
</p>
<p class="rd-p">
Miller, G. (1955) Note on the bias of information estimates. In: Quastler, H., editor. <em>Information Theory in Psychology: Problems and Methods</em>: 95-100.
</p>
<p class="rd-p">
Shannon, C. E. (1948). A Mathematical Theory of Communication. <em>The Bell System Technical Journal</em> 27: 379-423, 623-656.
</p>
<p class="rd-p">
Schurmann, T. (2004). Bias analysis in entropy estimation. <em>Journal of Physics A: Mathematical and Theoretical</em> 37(27): L295-L301.
</p>
<p class="rd-p">
Tsallis, C. (1988). Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em> 52(1): 479-487.
</p>
<p class="rd-p">
Zhang, Z. (2012). Entropy Estimation in Turings Perspective. <em>Neural Computation</em> 24(5): 1368-1389.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)</code></pre>
<p><img src="rd_files/figure-html/Shannon_id_25-1.png" width="624" /></p>
<pre class="r"><code># Calculate Shannon entropy
Shannon(Ps)</code></pre>
<pre><code>##     None 
## 4.736023</code></pre>
<pre class="r"><code># Calculate the best estimator of Shannon entropy
Shannon(Ns)</code></pre>
<pre><code>## ChaoWangJost 
##     4.892159</code></pre>
<pre class="r"><code># Use metacommunity data to calculate reduced-bias Shannon beta as mutual information
(bcShannon(Paracou618.MC$Ns) + bcShannon(colSums(Paracou618.MC$Nsi))
- bcShannon(Paracou618.MC$Nsi))</code></pre>
<pre><code>## ChaoWangJost 
##    0.3701823</code></pre>
<h4>
See also
</h4>
<pre><code>&lt;code&gt;&lt;a href=#shannon&gt;bcShannon&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#tsallis&gt;Tsallis&lt;/a&gt;&lt;/code&gt;</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="shannonbeta-shannonbeta-bcshannonbeta-shannonbeta.probavector-shannonbeta.abdvector-shannonbeta.integer-shannonbeta.numeric" class="section level2">
<h2>ShannonBeta: ShannonBeta, bcShannonBeta, ShannonBeta.ProbaVector, ShannonBeta.AbdVector, ShannonBeta.integer, ShannonBeta.numeric</h2>
<a id="ShannonBeta_alias"></a>
<h3>
Shannon beta entropy of a community
</h3>
<p class="rd-p">
Calculates the Shannon beta entropy of a community belonging to a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>ShannonBeta(NorP, NorPexp&nbsp;=&nbsp;NULL, ...)
bcShannonBeta(Ns, Nexp, Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"ShannonBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL)
"ShannonBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"ShannonBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"ShannonBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, Correction&nbsp;=&nbsp;"Best", ..., CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
The probability vector of species of the community.
</dd>
<dt>
Pexp
</dt>
<dd class="rd-dd">
The probability vector of species of the metacommunity.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the community.
</dd>
<dt>
Nexp
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the metacommunity.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</dd>
<dt>
NorPexp
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: currently, <code>“ChaoShen”</code> (Marcon <em>et al.</em>, 2012) equivalent to <code>“Best”</code>, and <code>“ZhangGrabchak”</code> (Zhang and Grabchak, 2014).
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The derivation of Shannon beta entropy can be found in Marcon <em>et al.</em> (2012).
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcShannonBeta</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>ShannonBeta</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcShannonBeta</code> is called. Explicit calls to <code>bcShannonBeta</code> (with bias correction) or to <code>ShannonBeta.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A number equal to the calculated entropy.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannons Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p class="rd-p">
Zhang, Z. and Grabchak M. (2014). Nonparametric Estimation of Kullback-Leibler Divergence. <em>Neural computation</em> 26(11): 2570-2593.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Probability distribution of the first plot
Ps1 &lt;- as.ProbaVector(Paracou618.MC$Psi[, 1])
# Shannon beta entropy of the plot
ShannonBeta(Ps1, Ps)</code></pre>
<pre><code>##      None 
## 0.3499358</code></pre>
<pre class="r"><code># Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Abundances in the first plot
Ns1 &lt;- as.AbdVector(Paracou618.MC$Nsi[, 1])
# Reduced-bias estimator of Shannon beta entropy of the plot
bcShannonBeta(Ns1, Ns)</code></pre>
<pre><code>##      Best 
## 0.2949188</code></pre>
<h4>
See also
</h4>
<p><code><a href=#shannonbeta>bcShannonBeta</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="simpson-simpson-bcsimpson-simpson.probavector-simpson.abdvector-simpson.integer-simpson.numeric" class="section level2">
<h2>Simpson: Simpson, bcSimpson, Simpson.ProbaVector, Simpson.AbdVector, Simpson.integer, Simpson.numeric</h2>
<a id="Simpson_alias"></a>
<h3>
Simpson entropy of a community
</h3>
<p class="rd-p">
Calculates the Simpson entropy of a probability vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Simpson(NorP, ...)
bcSimpson(Ns, Correction&nbsp;=&nbsp;"Lande", CheckArguments&nbsp;=&nbsp;TRUE)
"Simpson"(NorP, ..., CheckArguments&nbsp;=&nbsp;TRUE,  Ps&nbsp;=&nbsp;NULL)
"Simpson"(NorP, Correction="Lande",  ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Simpson"(NorP, Correction="Lande", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Simpson"(NorP, Correction="Lande", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections accepted by <code><a href=#tsallis>bcTsallis</a></code> or <code>“Lande”</code>, the default value (equivalent to <code>“Best”</code>).
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Landes correction has been derived (Lande, 1996; Good, 1953) especially for Simpson entropy, while other corrections are for generalized Tsallis entropy. It is identical to the unbiased estimator proposed by Simpson, although arguments were different. It equals the plug-in etimator multiplied by n/(n-1) where n is the total number of individuals.
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcSimpson</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Simpson</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcSimpson</code> is called. Explicit calls to <code>bcSimpson</code> (with bias correction) or to <code>Simpson.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated entropy. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Good, I. J. (1953). On the Population Frequency of Species and the Estimation of Population Parameters. <em>Biometrika</em> 40(3/4): 237-264.
</p>
<p class="rd-p">
Lande, R. (1996). Statistics and partitioning of species diversity, and similarity among multiple communities. <em>Oikos</em> 76: 5-13.
</p>
<p class="rd-p">
Simpson, E. H. (1949). Measurement of diversity. <em>Nature</em> 163(4148): 688.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)</code></pre>
<p><img src="rd_files/figure-html/Simpson_id_27-1.png" width="624" /></p>
<pre class="r"><code># Calculate an unbiased estimator of Simpson&#39;s index of diversity
Simpson(Ns)</code></pre>
<pre><code>##    Lande 
## 0.986326</code></pre>
<h4>
See also
</h4>
<p><code><a href=#tsallis>Tsallis</a></code>, <code><a href=#simpson>bcSimpson</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="simpsonbeta-simpsonbeta-bcsimpsonbeta-simpsonbeta.probavector-simpsonbeta.abdvector-simpsonbeta.integer-simpsonbeta.numeric" class="section level2">
<h2>SimpsonBeta: SimpsonBeta, bcSimpsonBeta, SimpsonBeta.ProbaVector, SimpsonBeta.AbdVector, SimpsonBeta.integer, SimpsonBeta.numeric</h2>
<a id="SimpsonBeta_alias"></a>
<h3>
Simpson beta entropy of a community
</h3>
<p class="rd-p">
Calculates the Simpson beta entropy of a community belonging to a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>SimpsonBeta(NorP, NorPexp&nbsp;=&nbsp;NULL, ...)
bcSimpsonBeta(Ns, Nexp, Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"SimpsonBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL)
"SimpsonBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"SimpsonBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"SimpsonBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
The probability vector of species of the community.
</dd>
<dt>
Pexp
</dt>
<dd class="rd-dd">
The probability vector of species of the metacommunity.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the community.
</dd>
<dt>
Nexp
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the metacommunity.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</dd>
<dt>
NorPexp
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: currently, only <code>“ChaoShen”</code>, identical to <code>“Best”</code>.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The derivation of Tsallis beta entropy (Simpson is Tsallis of order 2) can be found in Marcon et al. (2014).
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcSimpsonBeta</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
Note that Simpson beta entropy value is related to Simpson alpha entropy value and cannot be compared accross communities (Jost, 2007). Beta entropy of a community is not meaningful in general, do rather calculate the <code><a href=#betadiversity>BetaDiversity</a></code> of order 2 of the metacommunity.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>SimpsonBeta</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcSimpsonBeta</code> is called. Explicit calls to <code>bcSimpsonBeta</code> (with bias correction) or to <code>SimpsonBeta.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated entropy. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Jost (2007), Partitioning diversity into independent alpha and beta components. <em>Ecology</em> 88(10): 2427-2439.
</p>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ps)
# Probability distribution of the first plot
Ps1 &lt;- as.ProbaVector(Paracou618.MC$Psi[, 1])

# Simpson beta entropy of the plot
SimpsonBeta(Ps1, Ps)</code></pre>
<pre><code>##       None 
## 0.01004705</code></pre>
<pre class="r"><code># Transform into diversity
expq(SimpsonBeta(Ps1, Ps)/(1-Simpson(Ps1)), 2)</code></pre>
<pre><code>##     None 
## 1.583005</code></pre>
<pre class="r"><code># Ns is the vector of abundances of the metacommunity
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Abundances in the first plot
Ns1 &lt;- as.AbdVector(Paracou618.MC$Nsi[, 1])
# Reduced-bias Shannon beta entropy of the plot
bcSimpsonBeta(Ns1, Ns)</code></pre>
<pre><code>##        Best 
## 0.007566555</code></pre>
<h4>
See also
</h4>
<p><code><a href=#simpson>Simpson</a></code>, <code><a href=#simpsonbeta>bcSimpsonBeta</a></code>, <code><a href=#betadiversity>BetaDiversity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="tsallis-tsallis-bctsallis-tsallis.probavector-tsallis.abdvector-tsallis.integer-tsallis.numeric" class="section level2">
<h2>Tsallis: Tsallis, bcTsallis, Tsallis.ProbaVector, Tsallis.AbdVector, Tsallis.integer, Tsallis.numeric</h2>
<a id="Tsallis_alias"></a>
<h3>
Tsallis (HCDT) Entropy of a community
</h3>
<p class="rd-p">
Calculates the HCDT, also known as Tsallis entropy of order <span class="math inline"><em>q</em></span> of a probability vector.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Tsallis(NorP, q&nbsp;=&nbsp;1, ...)
bcTsallis(Ns, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", SampleCoverage&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)
"Tsallis"(NorP, q&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL)
"Tsallis"(NorP, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Tsallis"(NorP, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL)
"Tsallis"(NorP, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
A probability vector, summing to 1.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of entropy. Some corrections allow only a positive number. Default is 1 for Shannon entropy.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: <code>“None”</code> (no correction), <code>“ChaoShen”</code>, <code>“GenCov”</code>, <code>“Grassberger”</code>, <code>“Holste”</code>, <code>“Bonachela”</code>, <code>“ZhangGrabchak”</code>, or <code>“ChaoWangJost”</code>, <code>“Marcon”</code>, <code>“UnveilC”</code>, <code>“UnveiliC”</code>, <code>“UnveilJ”</code> or <code>“Best”</code>, the default value. Currently, <code>“Best”</code> is <code>“ChaoWangJost”</code>.
</dd>
<dt>
SampleCoverage
</dt>
<dd class="rd-dd">
The sample coverage of <code>Ns</code> calculated elsewhere. Used to calculate the gamma diversity of meta-communities, see details.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Tsallis (Havrda and Charvat, 1967; Daroczy, 1970; Tsallis, 1988) generalized entropy is a generalized measure of diversity (Jost, 2006).
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcTsallis</code> and choose the <code>Correction</code>. Correction techniques are from Chao and Shen (2003), Grassberger (1988), Holste <em>et al.</em> (1998), Bonachela <em>et al.</em> (2008), (Marcon <em>et al.</em>, 2014), which is actually the max value of <code>“ChaoShen”</code> and <code>“Grassberger”</code>, Zhang and Grabchak (2014), Chao and Jost (2015) and Marcon (2015).
</p>
<p class="rd-p">
Currently, the <code>“Best”</code> correction is <code>“ChaoWangJost”</code> (Chao, Wang and Jost, 2013 for <span class="math inline"><em>q</em> = 1</span>; Chao and Jost, 2015). This estimator contains an unbiased part concerning observed species, equal to that of Zhang and Grabchak (2014), and a (biased) estimator of the remaining bias based on the estimation of the species-accumulation curve. It is very efficient but very slow if the number of individuals is more than a few hundreds.
</p>
<p class="rd-p">
The unveiled estimators rely on Chao <em>et al.</em> (2015), completed by Marcon (2015). The actual probabilities of observed species are estimated and completed by a geometric distribution of the probabilities of unobserved species. The number of unobserved species is estimated by the Chao1 estimator (<code>“UnveilC”</code>), following Chao <em>et al.</em> (2015), or by the iChao1 (<code>“UnveiliC”</code>) or the jacknife (<code>“UnveilJ”</code>). The <code>“UnveilJ”</code> correction often has a lower bias but a greater variance (Marcon, 2015).
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>Tsallis</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcTsallis</code> is called. Explicit calls to <code>bcTsallis</code> (with bias correction) or to <code>Tsallis.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<p class="rd-p">
The size of a metacommunity (see <code><a href=#metacommunity>MetaCommunity</a></code>) is unknown so it has to be set according to a rule which does not ensure that its abundances are integer values. Then, classical bias-correction methods do not apply. Providing the <code>SampleCoverage</code> argument allows applying the <code>“ChaoShen”</code> and <code>“Grassberger”</code> corrections to estimate quite well the entropy. <code><a href=#divpart>DivPart</a></code> and <code><a href=#gammaentropy>GammaEntropy</a></code> functions use this tweak.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated entropy. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Chao, A. and Jost, L. (2015) Estimating diversity and entropy profiles via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 6(8): 873-882.
</p>
<p class="rd-p">
Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<p class="rd-p">
Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11):1091-1100.
</p>
<p class="rd-p">
Havrda, J. and Charvat, F. (1967). Quantification method of classification processes. Concept of structural a-entropy. <em>Kybernetika</em> 3(1): 30-35.
</p>
<p class="rd-p">
Daroczy, Z. (1970). Generalized information functions. <em>Information and Control</em> 16(1): 36-51.
</p>
<p class="rd-p">
Jost, L. (2006). Entropy and diversity. <em>Oikos</em> 113(2): 363-375.
</p>
<p class="rd-p">
Marcon, E. (2015) Practical Estimation of Diversity from Abundance Data. <em>HAL</em> 01212435: 1-27.
</p>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Tsallis, C. (1988). Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em> 52(1): 479-487.
</p>
<p class="rd-p">
Zhang, Z., and Grabchak, M. (2016). Entropic Representation and Estimation of Diversity Indices. <em>Journal of Nonparametric Statistics</em>, 28(3): 563-575.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Species probabilities
Ps &lt;- as.ProbaVector(Paracou618.MC$Ns)
# Whittaker plot
plot(Ns)</code></pre>
<p><img src="rd_files/figure-html/Tsallis_id_29-1.png" width="624" /></p>
<pre class="r"><code># Calculate entropy of order 1, i.e. Shannon&#39;s entropy
Tsallis(Ps, 1)</code></pre>
<pre><code>##     None 
## 4.736023</code></pre>
<pre class="r"><code># Calculate it with estimation bias correction
Tsallis(Ns, 1)</code></pre>
<pre><code>## ChaoWangJost 
##     4.892159</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="tsallisbeta-tsallisbeta-bctsallisbeta-tsallisbeta.probavector-tsallisbeta.abdvector-tsallisbeta.integer-tsallisbeta.numeric" class="section level2">
<h2>TsallisBeta: TsallisBeta, bcTsallisBeta, TsallisBeta.ProbaVector, TsallisBeta.AbdVector, TsallisBeta.integer, TsallisBeta.numeric</h2>
<a id="TsallisBeta_alias"></a>
<h3>
Tsallis beta entropy of a community
</h3>
<p class="rd-p">
Calculates the Tsallis beta entropy of order <span class="math inline"><em>q</em></span> of a community belonging to a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>TsallisBeta(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, ...)
bcTsallisBeta(Ns, Nexp&nbsp;=&nbsp;NULL, q, Correction&nbsp;=&nbsp;"Best", CheckArguments&nbsp;=&nbsp;TRUE)
"TsallisBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL)
"TsallisBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"TsallisBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ns&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)
"TsallisBeta"(NorP, NorPexp&nbsp;=&nbsp;NULL, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", ...,  CheckArguments&nbsp;=&nbsp;TRUE, Ps&nbsp;=&nbsp;NULL, Ns&nbsp;=&nbsp;NULL, Pexp&nbsp;=&nbsp;NULL, Nexp&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
The probability vector of species of the community.
</dd>
<dt>
Pexp
</dt>
<dd class="rd-dd">
The probability vector of species of the metacommunity.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the community.
</dd>
<dt>
Nexp
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances of the metacommunity.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the community.
</dd>
<dt>
NorPexp
</dt>
<dd class="rd-dd">
A numeric vector, an integer vector, an abundance vector (<code><a href=#speciesdistribution>AbdVector</a></code>) or a probability vector (<code><a href=#speciesdistribution>ProbaVector</a></code>). Contains either abundances or probabilities of the metacommunity.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of entropy. Default is 1 for Shannon entropy.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections: currently, only <code>“ChaoShen”</code> or <code>“None”</code>. <code>“Best”</code> is the default value, it is equivalent to <code>“ChaoShen”</code>.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments. Unused.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The derivation of Tsallis beta entropy can be found in Marcon et al. (2014).
</p>
<p class="rd-p">
Bias correction requires the number of individuals to estimate sample <code><a href=#coverage>Coverage</a></code>. Use <code>bcTsallisBeta</code> and choose the <code>Correction</code>.
</p>
<p class="rd-p">
Note that beta entropy value is related to alpha entropy (if <span class="math inline"><em>q</em></span> is not 1) and cannot be compared accross communities (Jost, 2007). Beta entropy of a community is not meaningful in general, do rather calculate the <code><a href=#betadiversity>BetaDiversity</a></code> of the metacommunity.
</p>
<p class="rd-p">
The functions are designed to be used as simply as possible. <code>TsallisBeta</code> is a generic method. If its first argument is an abundance vector, an integer vector or a numeric vector which does not sum to 1, the bias corrected function <code>bcTsallisBeta</code> is called. Explicit calls to <code>bcTsallisBeta</code> (with bias correction) or to <code>TsallisBeta.ProbaVector</code> (without correction) are possible to avoid ambiguity. The <code>.integer</code> and <code>.numeric</code> methods accept <code>Ps</code> or <code>Ns</code> arguments instead of <code>NorP</code> for backward compatibility.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A named number equal to the calculated entropy. The name is that of the bias correction used.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Jost (2007), Partitioning diversity into independent alpha and beta components. <em>Ecology</em> 88(10): 2427-2439.
</p>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps
# Probability distribution of the first plot
Ps1 &lt;- Paracou618.MC$Psi[, 1]
# Divergence of order 2 between plot 1 and the whole forest
TsallisBeta(Ps1, Ps, 2)</code></pre>
<pre><code>##       None 
## 0.01004705</code></pre>
<pre class="r"><code># Ns is the vector of abundances of the metacommunity
Ns &lt;- Paracou618.MC$Ns
# Abundances in the first plot
Ns1 &lt;- Paracou618.MC$Nsi[, 1]
# Divergence of order 2 between plot 1 and the whole forest, with bias correction
bcTsallisBeta(Ns1, Ns, 2)</code></pre>
<pre><code>##        Best 
## 0.007566555</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
</div>
<div id="metacommunity" class="section level1">
<h1>Metacommunity</h1>
<div id="alphadiversity" class="section level2">
<h2>AlphaDiversity</h2>
<a id="AlphaDiversity_alias"></a>
<h3>
Reduced-bias alpha diversity of a metacommunity
</h3>
<p class="rd-p">
Calculates the eeduced-bias total alpha diversity of order <span class="math inline"><em>q</em></span> of communities.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>AlphaDiversity(MC, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", Tree&nbsp;=&nbsp;NULL, Normalize&nbsp;=&nbsp;TRUE,  Z&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1 for Shannon diversity.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections accepted by <code><a href=#alphaentropy>AlphaEntropy</a></code> or <code>“None”</code> or <code>“Best”</code>, the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), diversity is not affected by the height of the tree. If <code>FALSE</code>, diversity is proportional to the height of the tree.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Entropy is calculated by <code><a href=#alphaentropy>AlphaEntropy</a></code> and transformed into diversity.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An <code><a href=#mcdiversity>MCdiversity</a></code> object containing diversity values of each community and of the metacommunity.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Calculate Simpson alpha diversity
summary(AlphaDiversity(Paracou618.MC, 2))</code></pre>
<pre><code>## Neutral alpha diversity of order 2 of metaCommunity Paracou618.MC 
## with correction: Best 
## 
## Diversity of communities: 
##     P006     P018 
## 38.81215 54.04494 
## Average diversity of the communities: 
## [1] 44.13559</code></pre>
<pre class="r"><code># Compare without correction
summary(AlphaDiversity(Paracou618.MC, 2, Correction = &quot;None&quot;))</code></pre>
<pre><code>## Neutral alpha diversity of order 2 of metaCommunity Paracou618.MC 
## with correction: None 
## 
## Diversity of communities: 
##     P006     P018 
## 36.65653 48.67684 
## Average diversity of the communities: 
## [1] 40.98793</code></pre>
<pre class="r"><code># Estimate phylogenetic Simpson alpha diversity
summary(AlphaDiversity(Paracou618.MC, 2, Tree = Paracou618.Taxonomy) -&gt; e)</code></pre>
<pre><code>## HCDT alpha diversity of order 2 of metaCommunity Paracou618.MC 
## with correction: Best 
## 
## Phylogenetic or functional diversity was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Diversity is normalized 
## 
## Diversity of communities: 
## P006.Best P018.Best 
##  17.16735  25.50972 
## Average diversity of the communities: 
## [1] 19.96079</code></pre>
<pre class="r"><code>plot(e)  </code></pre>
<p><img src="rd_files/figure-html/AlphaDiversity_id_31-1.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#alphaentropy>AlphaEntropy</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="alphaentropy" class="section level2">
<h2>AlphaEntropy</h2>
<a id="AlphaEntropy_alias"></a>
<h3>
Reduced-bias alpha entropy of a metacommunity
</h3>
<p class="rd-p">
Calculates the reduced-bias total alpha entropy of order <span class="math inline"><em>q</em></span> of communities.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>AlphaEntropy(MC, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", Tree&nbsp;=&nbsp;NULL, Normalize&nbsp;=&nbsp;TRUE, Z&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1 for Shannon entropy.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections accepted by the bias-corrected entropy function (see details) or <code>“None”</code> or <code>“Best”</code>, the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), the entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice). If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
If <code>Tree</code> is not <code>NULL</code>, then phylogenetic entropy is calculated by <code><a href=#phyloentropy>bcPhyloEntropy</a></code>; else, if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated by <code><a href=#hqz>bcHqz</a></code>; else, neutral entropy is calculated by <code><a href=#tsallis>bcTsallis</a></code>.
</p>
<p class="rd-p">
The alpha entropy of each community is calculated and summed according to community weights.
</p>
<p class="rd-p">
The possible corrections are detailed in <code><a href=#tsallis>Tsallis</a></code>.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An <code><a href=#mcentropy>MCentropy</a></code> object containing entropy values of each community and of the metacommunity.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Calculate Simpson alpha entropy
summary(AlphaEntropy(Paracou618.MC, 2))</code></pre>
<pre><code>## Neutral alpha entropy of order 2 of metaCommunity Paracou618.MC 
## with correction: Best 
## 
## Entropy of communities: 
##      P006      P018 
## 0.9742349 0.9814969 
## Average entropy of the communities: 
## [1] 0.9773425</code></pre>
<pre class="r"><code># Compare without correction
summary(AlphaEntropy(Paracou618.MC, 2, Correction = &quot;None&quot;))</code></pre>
<pre><code>## Neutral alpha entropy of order 2 of metaCommunity Paracou618.MC 
## with correction: None 
## 
## Entropy of communities: 
##      P006      P018 
## 0.9727197 0.9794563 
## Average entropy of the communities: 
## [1] 0.9756026</code></pre>
<pre class="r"><code># Estimate phylogenetic Simpson alpha entropy
summary(AlphaEntropy(Paracou618.MC, 2, Tree = Paracou618.Taxonomy) -&gt; e)</code></pre>
<pre><code>## HCDT alpha entropy of order 2 of metaCommunity Paracou618.MC 
## with correction: Best 
## 
## Phylogenetic or functional entropy was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Entropy is normalized
## Entropy of communities: 
## P006.Best P018.Best 
## 0.9417499 0.9607993 
## Average entropy of the communities: 
## [1] 0.9499018</code></pre>
<pre class="r"><code>plot(e)</code></pre>
<p><img src="rd_files/figure-html/AlphaEntropy_id_32-1.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#tsallis>bcTsallis</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="betadiversity" class="section level2">
<h2>BetaDiversity</h2>
<a id="BetaDiversity_alias"></a>
<h3>
Reduced-bias beta diversity of a metacommunity
</h3>
<p class="rd-p">
Calculates the reduced-bias beta diversity of order <span class="math inline"><em>q</em></span> between communities.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>BetaDiversity(MC, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", Tree&nbsp;=&nbsp;NULL, Normalize&nbsp;=&nbsp;TRUE,  Z&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1 for Shannon diversity.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections accepted by <code><a href=#tsallisbeta>bcTsallisBeta</a></code> or <code>“None”</code> or <code>“Best”</code>, the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), diversity is not affected by the height of the tree. If <code>FALSE</code>, diversity is proportional to the height of the tree.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Entropy is calculated by <code><a href=#betaentropy>BetaEntropy</a></code> and transformed into diversity.
</p>
<p class="rd-p">
Diversity values of communities are not defined: community entropies are averaged to obtain the metacommunity entropy wich is transformed into diversity (Marcon et al., 2014).
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An <code><a href=#mcdiversity>MCdiversity</a></code> object containing diversity value of the metacommunity.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon beta diversity
summary(BetaDiversity(Paracou618.MC, 1))</code></pre>
<pre><code>## Neutral beta diversity of order 1 of metaCommunity Paracou618.MC 
## with correction: Best 
## 
## Average diversity of the communities: 
## [1] 1.436039</code></pre>
<pre class="r"><code># Compare without correction
summary(BetaDiversity(Paracou618.MC, 1, Correction = &quot;None&quot;))</code></pre>
<pre><code>## Neutral beta diversity of order 1 of metaCommunity Paracou618.MC 
## with correction: None 
## 
## Average diversity of the communities: 
## [1] 1.563888</code></pre>
<pre class="r"><code># Estimate phylogenetic Shannon beta diversity
summary(BetaDiversity(Paracou618.MC, 1, Tree = Paracou618.Taxonomy) -&gt; e)</code></pre>
<pre><code>## HCDT beta diversity of order 1 of metaCommunity Paracou618.MC 
## with correction: Best 
## 
## Phylogenetic or functional diversity was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Diversity is normalized 
## 
## Average diversity of the communities: 
## [1] 1.289993</code></pre>
<h4>
See also
</h4>
<p><code><a href=#betaentropy>BetaEntropy</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="betaentropy" class="section level2">
<h2>BetaEntropy</h2>
<a id="BetaEntropy_alias"></a>
<h3>
Reduced-bias beta entropy of a metacommunity
</h3>
<p class="rd-p">
Calculates the reduced-bias beta entropy of order <span class="math inline"><em>q</em></span> between communities.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>BetaEntropy(MC, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", Tree&nbsp;=&nbsp;NULL, Normalize&nbsp;=&nbsp;TRUE,  Z&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1 for Shannon entropy.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections accepted by the bias-corrected entropy function (see details) or <code>“None”</code> or <code>“Best”</code>, the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), the entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice). If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
If <code>Tree</code> is not <code>NULL</code>, then phylogenetic entropy is calculated by <code><a href=#phylobetaentropy>bcPhyloBetaEntropy</a></code>; else, if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated by <code><a href=#hqzbeta>bcHqzBeta</a></code>; else, neutral entropy is calculated by <code><a href=#tsallisbeta>bcTsallisBeta</a></code>.
</p>
<p class="rd-p">
The reduced-bias beta entropy of each community is calculated and summed according to community weights.
</p>
<p class="rd-p">
Note that beta entropy is related to alpha entropy (if <span class="math inline"><em>q</em></span> is not 1) and cannot be compared accross communities (Jost, 2007). Do rather calculate the <code><a href=#betadiversity>BetaDiversity</a></code> of the metacommunity.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An <code><a href=#mcentropy>MCentropy</a></code> object containing entropy values of each community and of the metacommunity.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon beta entropy
summary(BetaEntropy(Paracou618.MC, 1))</code></pre>
<pre><code>## Neutral beta entropy of order 1 of metaCommunity Paracou618.MC 
## with correction: Best 
## 
## Entropy of communities: 
##      P006      P018 
## 0.2949188 0.4514132 
## Average entropy of the communities: 
## [1] 0.3618884</code></pre>
<pre class="r"><code># Compare without correction
summary(BetaEntropy(Paracou618.MC, 1, Correction = &quot;None&quot;))</code></pre>
<pre><code>## Neutral beta entropy of order 1 of metaCommunity Paracou618.MC 
## with correction: None 
## 
## Entropy of communities: 
##      P006      P018 
## 0.3499358 0.5771645 
## Average entropy of the communities: 
## [1] 0.4471751</code></pre>
<pre class="r"><code># Estimate phylogenetic Shannon beta entropy
summary(BetaEntropy(Paracou618.MC, 1, Tree = Paracou618.Taxonomy) -&gt; e)</code></pre>
<pre><code>## HCDT beta entropy of order 1 of metaCommunity Paracou618.MC 
## with correction: Best 
## 
## Phylogenetic or functional entropy was calculated according to the tree 
## Paracou618.Taxonomy 
## 
## Entropy is normalized
## Entropy of communities: 
##      P006      P018 
## 0.2049819 0.3210147 
## Average entropy of the communities: 
## [1] 0.2546365</code></pre>
<pre class="r"><code>plot(e)  </code></pre>
<p><img src="rd_files/figure-html/BetaEntropy_id_34-1.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#tsallisbeta>bcTsallisBeta</a></code>, <code><a href=#betadiversity>BetaDiversity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="divest-divest-is.divest-plot.divest-summary.divest" class="section level2">
<h2>DivEst: DivEst, is.DivEst, plot.DivEst, summary.DivEst</h2>
<a id="DivEst_alias"></a>
<h3>
Diversity Estimation of a metacommunity
</h3>
<p class="rd-p">
Estimates diversity of a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>DivEst(q&nbsp;=&nbsp;0, MC, Biased&nbsp;=&nbsp;TRUE, Correction&nbsp;=&nbsp;"Best", Tree&nbsp;=&nbsp;NULL,  Normalize&nbsp;=&nbsp;TRUE, Z&nbsp;=&nbsp;NULL, Simulations&nbsp;=&nbsp;100, CheckArguments&nbsp;=&nbsp;TRUE)
is.DivEst(x)
"plot"(x, ..., main&nbsp;=&nbsp;NULL, Which&nbsp;=&nbsp;"All")
"summary"(object, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity.
</dd>
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
Biased
</dt>
<dd class="rd-dd">
Logical; if <code>FALSE</code>, a bias correction is appplied.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections. The correction must be accepted by <code><a href=#divpart>DivPart</a></code>. <code>“Best”</code> is the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), diversity is not affected by the height of the tree.. If <code>FALSE</code>, diversity is proportional to the height of the tree.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
Simulations
</dt>
<dd class="rd-dd">
The number of simulations to build confidence intervals.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted.
</dd>
<dt>
main
</dt>
<dd class="rd-dd">
The title of the plot.
</dd>
<dt>
Which
</dt>
<dd class="rd-dd">
May be <code>“Alpha”</code>, <code>“Beta”</code> or <code>“Gamma”</code> to respectively plot the metacommunitys alpha, beta or gamma diversity. If <code>“All”</code> (default), all three plots are shown.
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>MCdiversity</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
<code>Divest</code> estimates the diversity of the metacommunity and partitions it into alpha and beta components.
</p>
<p class="rd-p">
If <code>Tree</code> is provided, the phylogenetic diversity is calculated else if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated.
</p>
<p class="rd-p">
Bootstrap confidence intervals are calculated by drawing simulated communities from a multinomial distribution following the observed frequencies (Marcon et al, 2012; 2014).
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A <code>Divest</code> object which is a <code><a href=#divpart>DivPart</a></code> object with an additional item in its list:
<dt>
SimulatedDiversity
</dt>
<dd>
A matrix containing the simulated values of alpha, beta and gamma diversity.
</dd>
</p>
<p class="rd-p">
<code>Divest</code> objects can be summarized and plotted.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannons Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon diversity.
Estimation &lt;- DivEst(q = 1, Paracou618.MC, Biased = FALSE, Correction = &quot;UnveilJ&quot;, 
Simulations = 20)</code></pre>
<pre><code>## ===========================================================================</code></pre>
<pre class="r"><code>plot(Estimation)</code></pre>
<p><img src="rd_files/figure-html/DivEst_id_35-1.png" width="624" /></p>
<pre class="r"><code>summary(Estimation)</code></pre>
<pre><code>## Diversity partitioning of order 1 of MetaCommunity Paracou618.MC
##  with correction: UnveilJ
## Alpha diversity of communities: 
##      P006      P018 
##  84.52352 119.50807 
## Total alpha diversity of the communities: 
## [1] 98.02742
## Beta diversity of the communities: 
##  UnveilJ 
## 1.416315 
## Gamma diversity of the metacommunity: 
##  UnveilJ 
## 138.8377 
## Quantiles of simulations (alpha, beta and gamma diversity):
##        0%        1%      2.5%        5%       10%       25%       50% 
##  87.71962  89.06564  91.08467  94.44973  95.19942  95.79974  98.15608 
##       75%       90%       95%     97.5%       99%      100% 
## 100.69514 101.64469 104.46201 104.57988 104.65061 104.69775 
##       0%       1%     2.5%       5%      10%      25%      50%      75% 
## 1.371849 1.372998 1.374720 1.377591 1.387194 1.401543 1.417173 1.434595 
##      90%      95%    97.5%      99%     100% 
## 1.441651 1.443495 1.449411 1.452961 1.455327 
##       0%       1%     2.5%       5%      10%      25%      50%      75% 
## 123.7825 125.3852 127.7894 131.7963 132.9678 137.0769 139.6239 141.8761 
##      90%      95%    97.5%      99%     100% 
## 143.4939 145.6163 148.2699 149.8620 150.9235</code></pre>
<h4>
See also
</h4>
<p><code><a href=#divpart>DivPart</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a> and Bruno Herault <a href="mailto:Bruno.Herault@ecofog.gf">Bruno.Herault@ecofog.gf</a></p>
</div>
<div id="divpart-divpart-is.divpart-plot.divpart-summary.divpart" class="section level2">
<h2>DivPart: DivPart, is.DivPart, plot.DivPart, summary.DivPart</h2>
<a id="DivPart_alias"></a>
<h3>
Diversity Partition of a metacommunity
</h3>
<p class="rd-p">
Partitions the diversity of a metacommunity into alpha and beta components.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>DivPart(q&nbsp;=&nbsp;1, MC, Biased&nbsp;=&nbsp;TRUE, Correction&nbsp;=&nbsp;"Best", Tree&nbsp;=&nbsp;NULL, Normalize&nbsp;=&nbsp;TRUE, Z&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)
is.DivPart(x)
"plot"(x, ...)
"summary"(object, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1.
</dd>
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
Biased
</dt>
<dd class="rd-dd">
Logical; if <code>FALSE</code>, a bias correction is appplied.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
<p>A string containing one of the possible corrections.</p>
The correction must be accepted by <code><a href=#alphaentropy>AlphaEntropy</a></code>, <code><a href=#betaentropy>BetaEntropy</a></code> and <code><a href=#gammaentropy>GammaEntropy</a></code>. <code>“Best”</code> is the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), diversity is not affected by the height of the tree. If <code>FALSE</code>, diversity is proportional to the height of the tree.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted.
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>MCdiversity</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
<code>DivPart</code> partitions the diversity of the metacommunity into alpha and beta components. It supports estimation-bias correction.
</p>
<p class="rd-p">
If <code>Tree</code> is provided, the phylogenetic diversity is calculated else if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated.
</p>
<p class="rd-p">
Beta diversity/entropy is calculated from Gamma and Alpha when bias correction is required, so community values are not available.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A <code>DivPart</code> object. It is a list:
<dt>
MetaCommunity
</dt>
<dd>
The name of the <code><a href=#metacommunity>MetaCommunity</a></code> object containing inventory data.
</dd>
</p>
<p class="rd-p">
<dt>
Order
</dt>
<dd>
The value of <code>q</code>.
</dd>
</p>
<p class="rd-p">
<dt>
Biased
</dt>
<dd>
Logical. If <code>FALSE</code>, bias corrected values of diversity have been computed.
</dd>
</p>
<p class="rd-p">
<dt>
Correction
</dt>
<dd>
The estimation bias correction used to calculate diversity.
</dd>
</p>
<p class="rd-p">
<dt>
Method
</dt>
<dd>
The method used to calculate entropy (“HCDT”, “Similarity-based”).
</dd>
</p>
<p class="rd-p">
<dt>
Tree
</dt>
<dd>
The phylogenetic or functional tree used to calculate phylodiversity.
</dd>
</p>
<p class="rd-p">
<dt>
Normalized
</dt>
<dd>
Logical. Indicates whether phylodiversity is normalized or proportional to the height of the tree.
</dd>
</p>
<p class="rd-p">
<dt>
Z
</dt>
<dd>
The matrix used to calculate similarity-based entropy.
</dd>
</p>
<p class="rd-p">
<dt>
TotalAlphaDiversity
</dt>
<dd>
The alpha diversity of communities.
</dd>
</p>
<p class="rd-p">
<dt>
TotalBetaDiversity
</dt>
<dd>
The beta diversity of communities.
</dd>
</p>
<p class="rd-p">
<dt>
GammaDiversity
</dt>
<dd>
The gamma diversity of the metacommunity.
</dd>
</p>
<p class="rd-p">
<dt>
CommunityAlphaDiversities
</dt>
<dd>
A vector containing the alpha diversity of each community.
</dd>
</p>
<p class="rd-p">
<dt>
TotalAlphaEntropy
</dt>
<dd>
The alpha entropy of communities.
</dd>
</p>
<p class="rd-p">
<dt>
TotalBetaEntropy
</dt>
<dd>
The beta entropy of communities.
</dd>
</p>
<p class="rd-p">
<dt>
GammaEntropy
</dt>
<dd>
The gamma entropy of the metacommunity.
</dd>
</p>
<p class="rd-p">
<dt>
CommunityAlphaEntropies
</dt>
<dd>
A vector containing the alpha entropy of each community.
</dd>
</p>
<p class="rd-p">
<code>DivPart</code> objects can be summarized and plotted.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannons Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate Shannon diversity.
summary(DivPart(q = 1, Paracou618.MC, Biased = FALSE) -&gt; dp)</code></pre>
<pre><code>## HCDT diversity partitioning of order 1 of metaCommunity Paracou618.MC
##  with correction: Best
## Alpha diversity of communities: 
##      P006      P018 
##  80.20125 110.66525 
## Total alpha diversity of the communities: 
## [1] 92.04908
## Beta diversity of the communities: 
## ChaoWangJost 
##     1.447498 
## Gamma diversity of the metacommunity: 
## ChaoWangJost 
##     133.2409</code></pre>
<pre class="r"><code>plot(dp)</code></pre>
<p><img src="rd_files/figure-html/DivPart_id_36-1.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#divprofile>DivProfile</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a> and Bruno Herault <a href="mailto:Bruno.Herault@ecofog.gf">Bruno.Herault@ecofog.gf</a></p>
</div>
<div id="divprofile-divprofile-is.divprofile-plot.divprofile-summary.divprofile" class="section level2">
<h2>DivProfile: DivProfile, is.DivProfile, plot.DivProfile, summary.DivProfile</h2>
<a id="DivProfile_alias"></a>
<h3>
Diversity Profile of a metacommunity
</h3>
<p class="rd-p">
Calculate the diversity profiles (alpha, beta, gamma) of a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>DivProfile(q.seq&nbsp;=&nbsp;seq(0, 2, 0.1), MC, Biased&nbsp;=&nbsp;TRUE, Correction&nbsp;=&nbsp;"Best",  Tree&nbsp;=&nbsp;NULL, Normalize&nbsp;=&nbsp;TRUE, Z&nbsp;=&nbsp;NULL,  NumberOfSimulations&nbsp;=&nbsp;0, Alpha&nbsp;=&nbsp;0.05, CheckArguments&nbsp;=&nbsp;TRUE)
is.DivProfile(x)
"plot"(x, ..., main&nbsp;=&nbsp;NULL, xlab&nbsp;=&nbsp;"Order of Diversity", ylab&nbsp;=&nbsp;NULL, Which&nbsp;=&nbsp;"All",  LineWidth&nbsp;=&nbsp;2, ShadeColor&nbsp;=&nbsp;"grey75", BorderColor&nbsp;=&nbsp;"red")
"summary"(object, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
q.seq
</dt>
<dd class="rd-dd">
A numeric vector.
</dd>
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
Biased
</dt>
<dd class="rd-dd">
Logical; if <code>FALSE</code>, a bias correction is appplied.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
<p>A string containing one of the possible corrections.</p>
The correction must be accepted by <code><a href=#alphaentropy>AlphaEntropy</a></code>, <code><a href=#betaentropy>BetaEntropy</a></code> and <code><a href=#gammaentropy>GammaEntropy</a></code>. <code>“Best”</code> is the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), diversity is not affected by the height of the tree. If <code>FALSE</code>, diversity is proportional to the height of the tree.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
NumberOfSimulations
</dt>
<dd class="rd-dd">
The number of simulations to run, 0 by default.
</dd>
<dt>
Alpha
</dt>
<dd class="rd-dd">
The risk level, 5% by default.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted.
</dd>
<dt>
main
</dt>
<dd class="rd-dd">
The main title of the plot. Ignored if <code>Which = “All”</code>.
</dd>
<dt>
xlab
</dt>
<dd class="rd-dd">
The x axis label of the plots.
</dd>
<dt>
ylab
</dt>
<dd class="rd-dd">
The y axis label of the plot. Ignored if <code>Which = “All”</code>.
</dd>
<dt>
Which
</dt>
<dd class="rd-dd">
May be <code>“Communities”</code>, <code>“Alpha”</code>, <code>“Beta”</code> or <code>“Gamma”</code> to respectively plot the alpha diversity of communities or the metacommunitys alpha, beta or gamma diversity. If <code>“All”</code> (default), all four plots are shown.
</dd>
<dt>
LineWidth
</dt>
<dd class="rd-dd">
The width of the line that represents the actual profile.
</dd>
<dt>
ShadeColor
</dt>
<dd class="rd-dd">
The color of the shaded confidence envelope.
</dd>
<dt>
BorderColor
</dt>
<dd class="rd-dd">
The color of the bounds of the confidence envelope.
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>MCdiversity</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
If <code>Tree</code> is provided, the phylogenetic diversity is calculated.
</p>
<p class="rd-p">
<code>DivPart</code> partitions the diversity of the metacommunity into alpha and beta components. It supports estimation-bias correction.
</p>
<p class="rd-p">
If <code>Tree</code> is provided, the phylogenetic diversity is calculated else if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated.
</p>
<p class="rd-p">
Beta diversity/entropy is calculated from Gamma and Alpha when bias correction is required, so community values are not available.
</p>
<p class="rd-p">
If <code>NumberOfSimulations</code> is greater than 0, a bootstrap confidence interval is produced by simulating communities from a multinomial distribution following the observed frequencies (Marcon et al, 2012; 2014) and calculating their profiles.
</p>
<p class="rd-p">
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A <code>DivProfile</code> object. It is a list:
<dt>
MetaCommunity
</dt>
<dd>
The name of the <code><a href=#metacommunity>MetaCommunity</a></code> object containing inventory data.
</dd>
</p>
<p class="rd-p">
<dt>
Order
</dt>
<dd>
A vector containing the values of <code>q</code>.
</dd>
</p>
<p class="rd-p">
<dt>
Biased
</dt>
<dd>
Logical. If <code>FALSE</code>, bias corrected values of diversity have been computed.
</dd>
</p>
<p class="rd-p">
<dt>
Correction
</dt>
<dd>
The estimation bias correction used to calculate diversity.
</dd>
</p>
<p class="rd-p">
<dt>
Method
</dt>
<dd>
The method used to calculate entropy (“HCDT”, “Similarity-based”).
</dd>
</p>
<p class="rd-p">
<dt>
Tree
</dt>
<dd>
The phylogenetic or functional tree used to calculate phylodiversity.
</dd>
</p>
<p class="rd-p">
<dt>
Normalized
</dt>
<dd>
Logical. Indicates whether phylodiversity is normalized or proportional to the height of the tree.
</dd>
</p>
<p class="rd-p">
<dt>
Z
</dt>
<dd>
The matrix used to calculate similarity-based entropy.
</dd>
</p>
<p class="rd-p">
<dt>
CommunityAlphaDiversities
</dt>
<dd>
A matrix containing the alpha diversity of each community.
</dd>
</p>
<p class="rd-p">
<dt>
TotalAlphaDiversity
</dt>
<dd>
A vector containing the alpha diversity of communities for each order.
</dd>
</p>
<p class="rd-p">
<dt>
BetaDiversity
</dt>
<dd>
A vector containing the beta diversity of communities for each order.
</dd>
</p>
<p class="rd-p">
<dt>
GammaDiversity
</dt>
<dd>
A vector containing the gamma diversity of the metacommunity for each order.
</dd>
</p>
<p class="rd-p">
<dt>
CommunityAlphaEntropies
</dt>
<dd>
A matrix containing the alpha entropy of each community.
</dd>
</p>
<p class="rd-p">
<dt>
TotalAlphaEntropy
</dt>
<dd>
A vector containing the alpha entropy of communities for each order.
</dd>
</p>
<p class="rd-p">
<dt>
BetaEntropy
</dt>
<dd>
A vector containing the beta entropy of communities for each order.
</dd>
</p>
<p class="rd-p">
<dt>
GammaEntropy
</dt>
<dd>
A vector containing the gamma entropy of the metacommunity for each order.
</dd>
</p>
<p class="rd-p">
<dt>
confidence envelopes
</dt>
<dd>
Total Alpha, Beta and Gamma Entropy and Diversity may come with a confidence envelope whose value is stored in twelve more vectors named suffixed Low or High, such as <code>GammaEntropyLow</code>
</dd>
</p>
<p class="rd-p">
<code>DivProfile</code> objects can be summarized and plotted.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannons Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Estimate diversity.
Profile &lt;- DivProfile(q.seq = seq(0, 2, 0.1), Paracou618.MC, Biased = FALSE)
plot(Profile)</code></pre>
<p><img src="rd_files/figure-html/DivProfile_id_37-1.png" width="624" /></p>
<pre class="r"><code>summary(Profile)</code></pre>
<pre><code>## Diversity profile of MetaCommunity Paracou618.MC
##  with correction: Best
## Diversity against its order:
##              Order Alpha Diversity Beta Diversity Gamma Diversity
## ChaoWangJost   0.0       238.36351       1.321238       314.93484
## ChaoWangJost   0.1       221.29193       1.320894       292.30317
## ChaoWangJost   0.2       204.17972       1.322729       270.07441
## ChaoWangJost   0.3       187.24324       1.327199       248.50910
## ChaoWangJost   0.4       170.72117       1.334724       227.86565
## ChaoWangJost   0.5       154.85926       1.345620       208.38174
## ChaoWangJost   0.6       139.89024       1.360036       190.25572
## ChaoWangJost   0.7       126.01236       1.377889       173.63105
## ChaoWangJost   0.8       113.37058       1.398840       158.58725
## ChaoWangJost   0.9       102.04503       1.422300       145.13862
## ChaoWangJost   1.0        92.04908       1.447498       133.24089
## ChaoWangJost   1.1        83.33700       1.473576       122.80337
## ChaoWangJost   1.2        75.81819       1.499692       113.70393
## ChaoWangJost   1.3        69.37405       1.525118       105.80358
## ChaoWangJost   1.4        63.87372       1.549289        98.95886
## ChaoWangJost   1.5        59.18644       1.571829        93.03093
## ChaoWangJost   1.6        55.18979       1.592530        87.89138
## ChaoWangJost   1.7        51.77425       1.611327        83.42525
## ChaoWangJost   1.8        48.84485       1.628258        79.53203
## ChaoWangJost   1.9        46.32106       1.643427        76.12530
## ChaoWangJost   2.0        44.13559       1.656977        73.13163</code></pre>
<h4>
See also
</h4>
<p><code><a href=#divpart>DivPart</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a> and Bruno Herault <a href="mailto:Bruno.Herault@ecofog.gf">Bruno.Herault@ecofog.gf</a></p>
</div>
<div id="gammadiversity" class="section level2">
<h2>GammaDiversity</h2>
<a id="GammaDiversity_alias"></a>
<h3>
Reduced-bias gamma diversity of a metacommunity
</h3>
<p class="rd-p">
Calculates the reduced-bias diversity of order <span class="math inline"><em>q</em></span> of a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>GammaDiversity(MC, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", Tree&nbsp;=&nbsp;NULL, Normalize&nbsp;=&nbsp;TRUE,  Z&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of diversity. Default is 1.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections accepted by <code><a href=#alphaentropy>AlphaEntropy</a></code> or <code>“None”</code> or <code>“Best”</code>, the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), diversity is not affected by the height of the tree. If <code>FALSE</code>, diversity is proportional to the height of the tree.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Entropy is calculated by <code><a href=#gammaentropy>GammaEntropy</a></code> and transformed into diversity.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
The metacommunitys gamma entropy.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Calculate Simpson gamma diversity
GammaDiversity(Paracou618.MC, 2)</code></pre>
<pre><code>## ChaoWangJost 
##     73.13163</code></pre>
<pre class="r"><code># Compare without correction
GammaDiversity(Paracou618.MC, 2, Correction = &quot;None&quot;)</code></pre>
<pre><code>##    None 
## 68.7215</code></pre>
<pre class="r"><code># Estimate phylogenetic Simpson gamma diversity
GammaDiversity(Paracou618.MC, 2, Tree = Paracou618.Taxonomy)   </code></pre>
<pre><code>##    Best 
## 25.1458</code></pre>
<h4>
See also
</h4>
<p><code><a href=#gammaentropy>GammaEntropy</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="gammaentropy" class="section level2">
<h2>GammaEntropy</h2>
<a id="GammaEntropy_alias"></a>
<h3>
Reduced-bias gamma entropy of a metacommunity
</h3>
<p class="rd-p">
Calculates the reduced-bias Tsallis entropy of order <span class="math inline"><em>q</em></span> of a metacommunity.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>GammaEntropy(MC, q&nbsp;=&nbsp;1, Correction&nbsp;=&nbsp;"Best", Tree&nbsp;=&nbsp;NULL, Normalize&nbsp;=&nbsp;TRUE,  Z&nbsp;=&nbsp;NULL, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
MC
</dt>
<dd class="rd-dd">
A <code><a href=#metacommunity>MetaCommunity</a></code> object.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of entropy. Default is 1.
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections accepted by the bias-corrected entropy function (see details) or <code>“None”</code> or <code>“Best”</code>, the default value.
</dd>
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), the entropy returned by the function is normalized by the height of the tree (it is the weighted average value of the entropy in each slice). If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</dd>
<dt>
Z
</dt>
<dd class="rd-dd">
A relatedness matrix, <em>i.e.</em> a square matrix whose terms are all positive, strictly positive on the diagonal. Generally, the matrix is a similarity matrix, <em>i.e.</em> the diagonal terms equal 1 and other terms are between 0 and 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
If <code>Tree</code> is not <code>NULL</code>, then phylogenetic entropy is calculated by <code><a href=#phyloentropy>bcPhyloEntropy</a></code>.
</p>
<p class="rd-p">
Else, if <code>Z</code> is not <code>NULL</code>, then similarity-based entropy is calculated by <code><a href=#hqz>bcHqz</a></code>.
</p>
<p class="rd-p">
Else, neutral entropy is calculated by <code><a href=#tsallis>bcTsallis</a></code>.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A number equal to the calculated entropy.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Calculate Simpson gamma entropy
GammaEntropy(Paracou618.MC, 2)</code></pre>
<pre><code>## ChaoWangJost 
##     0.986326</code></pre>
<pre class="r"><code># Compare without correction
GammaEntropy(Paracou618.MC, 2, Correction = &quot;None&quot;)</code></pre>
<pre><code>##      None 
## 0.9854485</code></pre>
<pre class="r"><code># Estimate phylogenetic Simpson gamma entropy
GammaEntropy(Paracou618.MC, 2, Tree = Paracou618.Taxonomy)   </code></pre>
<pre><code>##      Best 
## 0.9602319</code></pre>
<h4>
See also
</h4>
<p><code><a href=#tsallis>bcTsallis</a></code>, <code><a href=#phyloentropy>bcPhyloEntropy</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
</div>
<div id="metacommunity-utilities" class="section level1">
<h1>Metacommunity utilities</h1>
<div id="mergemc-mergemc-mergec-shufflemc" class="section level2">
<h2>MergeMC: MergeMC, MergeC, ShuffleMC</h2>
<a id="MergeMC_alias"></a>
<h3>
Manipulation of meta-communities
</h3>
<p class="rd-p">
Tools to manipulate meta-communities. From a list of meta-communities, <code>MergeMC</code> creates a metacommunity whose communities are each original metacommunity. <code>MergeC</code> creates a metacommunity whose communities are each original community. <code>ShuffleMC</code> randomly assigns original communities to a metacommunity, keeping original weights, and returns a list of meta-communities.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>MergeMC(MClist, Weights&nbsp;=&nbsp;rep(1, length(MClist)), CheckArguments&nbsp;=&nbsp;TRUE)
MergeC(MClist, Weights&nbsp;=&nbsp;rep(1, length(MClist)), CheckArguments&nbsp;=&nbsp;TRUE)
ShuffleMC(MClist, Weights&nbsp;=&nbsp;rep(1, length(MClist)), CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
MClist
</dt>
<dd class="rd-dd">
A list of <code>MetaCommunity</code> objects.
</dd>
<dt>
Weights
</dt>
<dd class="rd-dd">
A vector of numbers containing the weight of each metacommunity of the list. It does not have to be normalized to sum to 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
<code>MergeMC</code> is used for hierarchical partitioning of diversity. The gamma diversity of communities of the list becomes alpha diversity of the merged meta-community.
</p>
<p class="rd-p">
<code>MergeC</code> creates a new meta-community by mixing original ones. Original communities are kept, their new weight is the product of their original weight and the weight of their original meta-community.
</p>
<p class="rd-p">
<code>ShuffleMC</code> is used for simulations of the null hypothesis that all metacommunities of the list are identical.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
<code>MergeMC</code> and <code>MergeC</code> return a <code><a href=#metacommunity>MetaCommunity</a></code>.
</p>
<p class="rd-p">
<code>ShuffleMC</code> returns a <code><a href=http://www.rdocumentation.org/packages/base/topics/list>list</a></code> of <code><a href=#metacommunity>MetaCommunity</a></code> objects.
</dl>
</p>
<h4>
Examples
</h4>
<pre class="r"><code># First meta-community
(df &lt;- data.frame(C1 = c(10, 10, 10, 10), C2 = c(0, 20, 35, 5),
  C3 = c(25, 15, 0, 2), row.names = c(&quot;sp1&quot;, &quot;sp2&quot;, &quot;sp3&quot;, &quot;sp4&quot;)))</code></pre>
<pre><code>##     C1 C2 C3
## sp1 10  0 25
## sp2 10 20 15
## sp3 10 35  0
## sp4 10  5  2</code></pre>
<pre class="r"><code>w &lt;- c(1, 2, 1)
MC1 &lt;- MetaCommunity(Abundances = df, Weights = w)
# Second meta-community
(df &lt;- data.frame(C1 = c(10, 4), C2 = c(3, 4), row.names = c(&quot;sp1&quot;, &quot;sp5&quot;)))</code></pre>
<pre><code>##     C1 C2
## sp1 10  3
## sp5  4  4</code></pre>
<pre class="r"><code>w &lt;- c(3, 2)
MC2 &lt;- MetaCommunity(Abundances = df, Weights = w)

# Merge communities
plot(MergeC(list(MC1, MC2)), main=&quot;Merged communities&quot;)</code></pre>
<p><img src="rd_files/figure-html/MergeMC_id_40-1.png" width="624" /></p>
<pre class="r"><code># Merge metacommunities
plot(MergeMC(list(MC1, MC2)), main=&quot;Merged meta-communities&quot;)</code></pre>
<p><img src="rd_files/figure-html/MergeMC_id_40-2.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#metacommunity>MetaCommunity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="metacommunity-metacommunity-is.metacommunity-plot.metacommunity-summary.metacommunity" class="section level2">
<h2>MetaCommunity: MetaCommunity, is.MetaCommunity, plot.MetaCommunity, summary.MetaCommunity</h2>
<a id="MetaCommunity_alias"></a>
<h3>
Metacommunity class
</h3>
<p class="rd-p">
Methods for objects of type “<code>MetaCommunity</code>”.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>MetaCommunity(Abundances, Weights&nbsp;=&nbsp;rep(1, ncol(Abundances)))
is.MetaCommunity(x)
"summary"(object, ...)
"plot"(x, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Abundances
</dt>
<dd class="rd-dd">
A dataframe containing the number of observations (lines are species, columns are communities). The first column of the dataframe may contain the species names.
</dd>
<dt>
Weights
</dt>
<dd class="rd-dd">
A vector of positive numbers equal to community weights or a dataframe containing a vector named <code>Weights</code>. It does not have to be normalized. Weights are equal by default.
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted.
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>MetaCommunity</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
In the entropart package, individuals of different “species” are counted in several “communities” which are agregated to define a “metacommunity”.
</p>
<p class="rd-p">
This is a naming convention, which may correspond to plots in a forest inventory or any data organized the same way.
</p>
<p class="rd-p">
Alpha and beta entropies of communities are summed according to <code>Weights</code> and the probability to find a species in the metacommunity is the weighted average of probabilities in communities.
</p>
<p class="rd-p">
The simplest way to import data is to organize it into two text files. The first file should contain abundance data: the first column named <code>Species</code> for species names, and a column for each community.
</p>
<p class="rd-p">
The second file should contain the community weights in two columns. The first one, named <code>Communities</code> should contain their names and the second one, named <code>Weights</code>, their weights.
</p>
<p class="rd-p">
Files can be read and data imported by code such as:
</p>
<p class="rd-p">
<pre>
Abundances <- read.csv(file="Abundances.csv", row.names = 1)
Weights <- read.csv(file="Weights.csv")
MC <- MetaCommunity(Abundances, Weights)
</pre>
</p>
<p class="rd-p">
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An object of class <strong>MetaCommunity</strong> is a list:
<dt>
Nsi
</dt>
<dd>
A matrix containing abundance data, species in line, communities in column.
</dd>
</p>
<p class="rd-p">
<dt>
Ns
</dt>
<dd>
A vector containing the number of individuals of each species.
</dd>
</p>
<p class="rd-p">
<dt>
Ni
</dt>
<dd>
A vector containing the number of individuals of each community.
</dd>
</p>
<p class="rd-p">
<dt>
N
</dt>
<dd>
The total number of individuals.
</dd>
</p>
<p class="rd-p">
<dt>
Psi
</dt>
<dd>
A matrix whose columns are the probability vectors of communities (each of them sums to 1).
</dd>
</p>
<p class="rd-p">
<dt>
Wi
</dt>
<dd>
A vector containing the normalized community weights (sum to 1).
</dd>
</p>
<p class="rd-p">
<dt>
Ps
</dt>
<dd>
A vector containing the probability vector of the metacommunity.
</dd>
</p>
<p class="rd-p">
<dt>
Nspecies
</dt>
<dd>
The number of species.
</dd>
</p>
<p class="rd-p">
<dt>
Ncommunities
</dt>
<dd>
The number of communities.
</dd>
</p>
<p class="rd-p">
<dt>
SampleCoverage
</dt>
<dd>
The sample coverage of the metacommunity.
</dd>
</p>
<p class="rd-p">
<dt>
SampleCoverage.communities
</dt>
<dd>
A vector containing the sample coverages of each community.
</dd>
</p>
<p class="rd-p">
<code>is.MetaCommunity</code> returns <code>TRUE</code> if the object is of class <code>MetaCommunity</code>.
</p>
<p class="rd-p">
<code>summary.MetaCommunity</code> returns a summary of the objects value.
</p>
<p class="rd-p">
<code>plot.MetaCommunity</code> plots it.
</dl>
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Use BCI data from vegan package
if (require(vegan, quietly = TRUE)) {
  # Load BCI data (number of trees per species in each 1-ha plot of a tropical forest)
  data(BCI)
  # BCI dataframe must be transposed (its lines are plots, not species)
  BCI.df &lt;- as.data.frame(t(BCI))
  # Create a metacommunity object from a matrix of abundances and a vector of weights
  # (here, all plots have a weight equal to 1)
  MC &lt;- MetaCommunity(BCI.df)
}</code></pre>
<pre><code>## This is vegan 2.4-5</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
</div>
<div id="classes" class="section level1">
<h1>Classes</h1>
<div id="mcdiversity-mcdiversity-is.mcdiversity-plot.mcdiversity-summary.mcdiversity" class="section level2">
<h2>MCdiversity: MCdiversity, is.MCdiversity, plot.MCdiversity, summary.MCdiversity</h2>
<a id="MCdiversity_alias"></a>
<h3>
Meta-Community diversity class.
</h3>
<p class="rd-p">
Methods for objects of type “<code>MCdiversity</code>”.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>is.MCdiversity(x)
"plot"(x, ...)
"summary"(object, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted.
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>MCdiversity</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
Meta-community diversity objects are lists containing:
<dt>
MetaCommunity
</dt>
<dd>
The name of the <code><a href=#metacommunity>MetaCommunity</a></code> object containing inventory data.
</dd>
</p>
<p class="rd-p">
<dt>
Type
</dt>
<dd>
The type of diversity (“alpha”, “beta” or “gamma”).
</dd>
</p>
<p class="rd-p">
<dt>
Order
</dt>
<dd>
The order of diversity <span class="math inline"><em>q</em></span>.
</dd>
</p>
<p class="rd-p">
<dt>
Correction
</dt>
<dd>
The estimation bias correction used to calculate diversity.
</dd>
</p>
<p class="rd-p">
<dt>
Tree
</dt>
<dd>
The phylogenetic or functional tree used to calculate phylodiversity.
</dd>
</p>
<p class="rd-p">
<dt>
Normalized
</dt>
<dd>
Logical. Indicates whether phylodiversity is normalized or proportional to the height of the tree.
</dd>
</p>
<p class="rd-p">
<dt>
Weights
</dt>
<dd>
A vector containing the weights of communities.
</dd>
</p>
<p class="rd-p">
<dt>
Communities
</dt>
<dd>
A vector containing the diversity of communities.
</dd>
</p>
<p class="rd-p">
<dt>
Total
</dt>
<dd>
The total diversity.
</dd>
</p>
<p class="rd-p">
<code>is.MCdiversity</code> returns <code>TRUE</code> if the object is of class <code>MCdiversity</code>.
</p>
<p class="rd-p">
<code>summary.MCdiversity</code> returns a summary of the objects value.
</dl>
</p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="mcentropy-mcentropy-is.mcentropy-plot.mcentropy-summary.mcentropy" class="section level2">
<h2>MCentropy: MCentropy, is.MCentropy, plot.MCentropy, summary.MCentropy</h2>
<a id="MCentropy_alias"></a>
<h3>
Meta-Community entropy class.
</h3>
<p class="rd-p">
Methods for objects of type “<code>MCentropy</code>”.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>is.MCentropy(x)
"plot"(x, ...)
"summary"(object, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted.
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>MCentropy</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
Meta-community entropy objects are lists containing:
<dt>
MetaCommunity
</dt>
<dd>
The name of the <code><a href=#metacommunity>MetaCommunity</a></code> object containing inventory data.
</dd>
</p>
<p class="rd-p">
<dt>
Method
</dt>
<dd>
The method used to calculate entropy (“HCDT”, “Similarity-based”).
</dd>
</p>
<p class="rd-p">
<dt>
Type
</dt>
<dd>
The type of entropy (“alpha”, “beta” or “gamma”).
</dd>
</p>
<p class="rd-p">
<dt>
Order
</dt>
<dd>
The order of entropy <span class="math inline"><em>q</em></span>.
</dd>
</p>
<p class="rd-p">
<dt>
Correction
</dt>
<dd>
The estimation bias correction used to calculate entropy.
</dd>
</p>
<p class="rd-p">
<dt>
Tree
</dt>
<dd>
The phylogenetic or functional tree used to calculate phyloentropy.
</dd>
</p>
<p class="rd-p">
<dt>
Normalized
</dt>
<dd>
Logical. Indicates whether phyloentropy is normalized or proportional to the height of the tree.
</dd>
</p>
<p class="rd-p">
<dt>
Z
</dt>
<dd>
The matrix used to calculate similarity-based entropy.
</dd>
</p>
<p class="rd-p">
<dt>
Weights
</dt>
<dd>
A vector containing the weights of communities.
</dd>
</p>
<p class="rd-p">
<dt>
Communities
</dt>
<dd>
A vector containing the entropy of communities.
</dd>
</p>
<p class="rd-p">
<dt>
Total
</dt>
<dd>
The total entropy.
</dd>
</p>
<p class="rd-p">
<code>is.MCentropy</code> returns <code>TRUE</code> if the object is of class <code>MCentropy</code>.
</p>
<p class="rd-p">
<code>summary.MCentropy</code> returns a summary of the objects value.
</dl>
</p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="phylovalue-phylovalue-is.phylovalue-plot.phylovalue-summary.phylovalue" class="section level2">
<h2>PhyloValue: PhyloValue, is.PhyloValue, plot.PhyloValue, summary.PhyloValue</h2>
<a id="PhyloValue_alias"></a>
<h3>
Phylogenetic entropy of diversity.
</h3>
<p class="rd-p">
Entropy or diversity against the height of the phylogenetic or functional tree.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>is.PhyloValue(x)
"plot"(x, xlab&nbsp;=&nbsp;expression(italic("T")), ylab&nbsp;=&nbsp;NULL, main&nbsp;=&nbsp;NULL, ...)
"summary"(object, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
An object of class <code>PhyloValue</code>, including <code><a href=#phylodiversity>PhyloDiversity</a></code> and <code><a href=#phyloentropy>PhyloEntropy</a></code> objects.
</dd>
<dt>
xlab
</dt>
<dd class="rd-dd">
The X axis label, “T” by default for Time.
</dd>
<dt>
ylab
</dt>
<dd class="rd-dd">
The Y axis label. if <code>NULL</code> (by default), “Entropy” or “Diversity” or nothing is chosen according to the object class.
</dd>
<dt>
main
</dt>
<dd class="rd-dd">
The main title of the plot. if <code>NULL</code> (by default), a default value is used.
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>PhyloValue</code> object to be summarized.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to <code><a href=http://www.rdocumentation.org/packages/graphics/topics/plot>plot</a></code>.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
<code>PhyloValue</code> objects are the result of <code><a href=#phyloapply>PhyloApply</a></code>.
</p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="pptree-pptree-is.pptree-plot.pptree" class="section level2">
<h2>PPtree: PPtree, is.PPtree, plot.PPtree</h2>
<a id="PPtree_alias"></a>
<h3>
Preprocessed Trees.
</h3>
<p class="rd-p">
Methods for objects of type “<code>PPtree</code>”.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>is.PPtree(x)
"plot"(x, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.
</dd>
</dl>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An object of class <strong>PPtree</strong> is a list:
<dt>
phyTree
</dt>
<dd>
A <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code> tree
</dd>
</p>
<p class="rd-p">
<dt>
hTree
</dt>
<dd>
A <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code> tree
</dd>
</p>
<p class="rd-p">
<dt>
Height
</dt>
<dd>
The height of the tree, that is to say the distance between root and leaves
</dd>
</p>
<p class="rd-p">
<dt>
Cuts
</dt>
<dd>
A vector. Cut times of the tree (the distance from nodes to leaves)
</dd>
</p>
<p class="rd-p">
<dt>
Intervals
</dt>
<dd>
A vector. The lengths of intervals between cuts
</dd>
</p>
<p class="rd-p">
<code>is.PPtree</code> returns <code>TRUE</code> if the object is of class <code>PPtree</code>.
</p>
<p class="rd-p">
<code>plot.PPtree</code> plots it.
</dl>
</p>
<h4>
Note
</h4>
<p class="rd-p">
Versions up to 1.3 contained a <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> tree, now deprecated in <code>ade4</code>. A <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code> tree is now used.
</p>
<p class="rd-p">
See the dedicated vignette (<code>vignette(“Phylogenies”, package=“entropart”)</code>) for more details.
</p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="simtest-simtest-as.simtest-is.simtest-plot.simtest-summary.simtest" class="section level2">
<h2>SimTest: SimTest, as.SimTest, is.SimTest, plot.SimTest, summary.SimTest</h2>
<a id="SimTest_alias"></a>
<h3>
SimTest class
</h3>
<p class="rd-p">
Methods for objects of type “<code>SimTest</code>”, used to test a value against its distribution under a simulated null hypothesis.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>as.SimTest(RealValue, SimulatedValues)
is.SimTest(x)
"plot"(x, Quantiles&nbsp;=&nbsp;c(0.025, 0.975), ..., colValue&nbsp;=&nbsp;"red",lwdValue&nbsp;=&nbsp;2, ltyValue&nbsp;=&nbsp;2, colQuantiles&nbsp;=&nbsp;"black", lwdQuantiles&nbsp;=&nbsp;1, ltyQuantiles&nbsp;=&nbsp;2)
"summary"(object, Quantiles&nbsp;=&nbsp;c(0.025, 0.975), ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
RealValue
</dt>
<dd class="rd-dd">
A numeric Value (the actual one).
</dd>
<dt>
SimulatedValues
</dt>
<dd class="rd-dd">
A numeric vector containing the simulated values.
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
An object to be tested or plotted.
</dd>
<dt>
object
</dt>
<dd class="rd-dd">
A <code>SimTest</code> object to be summarized.
</dd>
<dt>
Quantiles
</dt>
<dd class="rd-dd">
A vector containing the quantiles of interest.
</dd>
<dt>
colValue
</dt>
<dd class="rd-dd">
The color of the line representing the real value on the plot.
</dd>
<dt>
lwdValue
</dt>
<dd class="rd-dd">
The width of the line representing the real value on the plot.
</dd>
<dt>
ltyValue
</dt>
<dd class="rd-dd">
The line type of the line representing the real value on the plot.
</dd>
<dt>
colQuantiles
</dt>
<dd class="rd-dd">
The color of the lines representing the quantiles on the plot.
</dd>
<dt>
lwdQuantiles
</dt>
<dd class="rd-dd">
The width of the lines representing the quantiles on the plot.
</dd>
<dt>
ltyQuantiles
</dt>
<dd class="rd-dd">
The line type of the lines representing the quantiles on the plot.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to the generic methods.<br />

</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Simulated values should be obtained by simulation. The actual value is compared to simulated quantiles. <code>SimTest</code> objects can be plotted and summarized.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
<code>SimTest</code> objects are lists containing:
<dt>
RealValue
</dt>
<dd>
The value to test.
</dd>
</p>
<p class="rd-p">
<dt>
SimulatedValues
</dt>
<dd>
A vector of simulated values, whose quantiles will be used for the test.
</dd>
</p>
<p class="rd-p">
<code>is.SimTest</code> returns <code>TRUE</code> if the object is of class <code>SimTest</code>.
</p>
<p class="rd-p">
<code>summary.SimTest</code> returns a summary of the object, including the empirical quantile of the real value in the simulated distributon.
</p>
<p class="rd-p">
</dl>
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Set the value to test
Real &lt;- 0.8
# Is it a realization of a Gaussian distribution?
Sims &lt;- rnorm(1000)
# Make a Simtest object
st &lt;- as.SimTest(Real, Sims)
plot(st)</code></pre>
<p><img src="rd_files/figure-html/SimTest_id_46-1.png" width="624" /></p>
<pre class="r"><code>summary(st)</code></pre>
<pre><code>## Real value:  0.8 
## Quantile in the simulated distribution:  0.794 
## Quantiles of simulations:
## 2.50% :  -1.947733 
## 97.50% :  1.911173 
## Mean simulated value:  0.01323043</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="speciesdistribution-speciesdistribution-as.speciesdistribution-as.speciesdistribution.data.frame-as.speciesdistribution.integer-as.speciesdistribution.numeric-is.speciesdistribution-plot.speciesdistribution-abdvector-as.abdvector-as.abdvector.data.frame-as.abdvector.integer-as.abdvector.numeric-is.abdvector-probavector-as.probavector-as.probavector.data.frame-as.probavector.integer-as.probavector.numeric-is.probavector" class="section level2">
<h2>SpeciesDistribution: SpeciesDistribution, as.SpeciesDistribution, as.SpeciesDistribution.data.frame, as.SpeciesDistribution.integer, as.SpeciesDistribution.numeric, is.SpeciesDistribution, plot.SpeciesDistribution, AbdVector, as.AbdVector, as.AbdVector.data.frame, as.AbdVector.integer, as.AbdVector.numeric, is.AbdVector, ProbaVector, as.ProbaVector, as.ProbaVector.data.frame, as.ProbaVector.integer, as.ProbaVector.numeric, is.ProbaVector</h2>
<a id="SpeciesDistribution_alias"></a>
<h3>
Species Distributions.
</h3>
<p class="rd-p">
A Species Distribution is a (preferably named) vector containing species abundances or probabilities.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>as.SpeciesDistribution(x, ...)
"as.SpeciesDistribution"(x, ...)
"as.SpeciesDistribution"(x, ...)
"as.SpeciesDistribution"(x, ...)
"plot"(x, ..., Distribution&nbsp;=&nbsp;NULL,  type&nbsp;=&nbsp;"b", log&nbsp;=&nbsp;"y", main&nbsp;=&nbsp;NULL, xlab&nbsp;=&nbsp;"Rank", ylab&nbsp;=&nbsp;NULL)
is.SpeciesDistribution(x)
as.ProbaVector(x, ...)
"as.ProbaVector"(x, ...)
"as.ProbaVector"(x, Correction&nbsp;=&nbsp;"None", Unveiling&nbsp;=&nbsp;"None",  RCorrection&nbsp;=&nbsp;"Chao1", JackOver&nbsp;=&nbsp;FALSE, CEstimator&nbsp;=&nbsp;"ZhangHuang",  ..., CheckArguments&nbsp;=&nbsp;TRUE)
"as.ProbaVector"(x, Correction&nbsp;=&nbsp;"None", Unveiling&nbsp;=&nbsp;"None",  RCorrection&nbsp;=&nbsp;"Chao1", JackOver&nbsp;=&nbsp;FALSE, CEstimator&nbsp;=&nbsp;"ZhangHuang",  ..., CheckArguments&nbsp;=&nbsp;TRUE)
is.ProbaVector(x)
as.AbdVector(x, ...)
"as.AbdVector"(x, Round&nbsp;=&nbsp;TRUE, ...)
"as.AbdVector"(x, ...)
"as.AbdVector"(x, Round&nbsp;=&nbsp;TRUE, ...)
is.AbdVector(x)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
An object.
</dd>
<dt>
Distribution
</dt>
<dd class="rd-dd">
The distribution to fit on the plot. May be <code>“lnorm”</code> (log-normal), <code>“lseries”</code> (log-series), <code>“geom”</code> (geometric) or <code>“bstick”</code> (broken stick). If <code>NULL</code>, no distribution is fitted. See <code><a href=#rcommunity>rCommunity</a></code> for the description of these distributions.
</dd>
<dt>
Round
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (by default), values of <code>x</code> are set to integer to create an <code>AbdVector</code>. This is useful if original abundances are not integers (this is often the case for <code><a href=#metacommunity>MetaCommunity</a></code> abundances which are the product of probabilities by the number of individuals) and integer values are required (for example to calculate the bootstrap confidence interval of a community profile).
</dd>
<dt>
Correction
</dt>
<dd class="rd-dd">
A string containing one of the possible corrections to estimate a probability distribution: <code>“None”</code> (no correction, the default value), <code>“Chao2013”</code>, <code>“Chao2015”</code> or <code>“ChaoShen”</code>.
</dd>
<dt>
Unveiling
</dt>
<dd class="rd-dd">
A string containing one of the possible unveiling methods to estimate the probabilities of the unobserved species: <code>“None”</code> (default, no species is added), <code>“unif”</code> (uniform: all unobserved species have the same probability) or <code>“geom”</code> (geometric: the unobserved species distribution is geometric).
</dd>
<dt>
RCorrection
</dt>
<dd class="rd-dd">
A string containing a correction recognized by <code><a href=#richness>Richness</a></code> to evaluate the total number of species. <code>“Chao1”</code> is the default value.
</dd>
<dt>
JackOver
</dt>
<dd class="rd-dd">
If <code>TRUE</code>, retain the jackknife order immediately superior to the optimal one, usually resulting in the overestimation of the number of species. Default is <code>FALSE</code>. Ignored if <code>RCorrection</code> is not <code>“Jackknife”</code>.
</dd>
<dt>
CEstimator
</dt>
<dd class="rd-dd">
A string containing an estimator recognized by <code><a href=#coverage>Coverage</a></code> to evaluate the sample coverage. <code>“ZhangHuang”</code> is the default value.
</dd>
<dt>
type
</dt>
<dd class="rd-dd">
The plot type, see <code><a href=http://www.rdocumentation.org/packages/graphics/topics/plot>plot</a></code>.
</dd>
<dt>
log
</dt>
<dd class="rd-dd">
The axis to plot in log scale, <em>e.g.</em> <code>“xy”</code> for both axes. Default is <code>“y”</code>.
</dd>
<dt>
main
</dt>
<dd class="rd-dd">
The main title of the plot. if <code>NULL</code> (by default), there is no title.
</dd>
<dt>
xlab
</dt>
<dd class="rd-dd">
The X axis label, “Rank” by default.
</dd>
<dt>
ylab
</dt>
<dd class="rd-dd">
The Y axis label. if <code>NULL</code> (by default), “Probability” or “Abundance” is chosen according to the object class.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to <code><a href=http://www.rdocumentation.org/packages/graphics/topics/plot>plot</a></code>. Unused elsewhere.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
<code>SpeciesDistribution</code> objects include <code>AbdVector</code> and <code>ProbaVector</code> objects.
</p>
<p class="rd-p">
<code>as.AbdVector</code> just sets the class of the numeric or integer <code>x</code> so that appropriate versions of community functions (generic methods such as <code><a href=#diversity>Diversity</a></code>) are applied. Abundance values are rounded (by default) to the nearest integer.
</p>
<p class="rd-p">
<code>as.ProbaVector</code> normalizes the vector so that it sums to 1. If <code>Correction</code> is not <code>“None”</code>, the observed abundance distribution is used to estimate the actual species distribution. The list of species will be changed: zero-abundance species will be cleared, and some unobserved species will be added. First, observed species probabilities are estimated folllowing Chao and Shen (2003), <em>i.e.</em> input probabilities are multiplied by the sample coverage, or according to more sophisticated models: Chao <em>et al.</em> (2013, single-parameter model), or Chao <em>et al.</em> (2015, two-parameter model). The total probability of observed species equals the sample coverage. Then, the distribution of unobserved species can be unveiled: their number is estimated according to <code>RCorrection</code> (if the Jackknife estimator is chosen, the <code>JackOver</code> argument allows using the order immediately over the optimal one). The coverage deficit (1 minus the sample coverage) is shared by the unobserved species equally (<code>Unveiling = “unif”</code>, Chao <em>et al.</em>, 2013) or according to a geometric distribution (<code>Unveiling = “geom”</code>, Chao <em>et al.</em>, 2015).
</p>
<p class="rd-p">
These functions can be applied to data frames to calculate the joint diversity (Gregorius, 2010).
</p>
<p class="rd-p">
<code>SpeciesDistribution</code> objects can be plotted. The <code>plot</code> method returns the estimated parameters of the fitted distribution. The broken stick has no parameter, so the maximum abundance is returned.
</p>
<h4>
Note
</h4>
<p class="rd-p">
Fishers alpha (Fisher <em>et al.</em>, 1943) is estimated to fit the log-series distribution. The estimation is done by the <code><a href=http://www.rdocumentation.org/packages/vegan/topics/diversity>fisher.alpha</a></code> function of package <code>vegan</code>. It may differ substantially from the estimation returned by <code>optimal.theta</code> from package <code>untb</code>.
</p>
<h4>
References
</h4>
<p class="rd-p">
Chao, A. and Shen, T. J. (2003). Nonparametric estimation of Shannons index of diversity when there are unseen species in sample. <em>Environmental and Ecological Statistics</em> 10(4): 429-443.
</p>
<p class="rd-p">
Chao, A., Wang, Y. T. and Jost, L. (2013). Entropy and the species accumulation curve: a novel entropy estimator via discovery rates of new species. <em>Methods in Ecology and Evolution</em> 4(11):1091-1100.
</p>
<p class="rd-p">
Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<p class="rd-p">
Fisher R.A., Corbet A.S., Williams C.B. (1943) The Relation Between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population. <em>Journal of Animal Ecology</em> 12: 42-58.
</p>
<p class="rd-p">
Gregorius H.-R. (2010) Linking Diversity and Differentiation. <em>Diversity</em> 2(3): 370-394.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ns is the total number of trees per species
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
# Whittaker plot, poorly fitted by a log-normal distribution
plot(Ns, Distribution = &quot;lnorm&quot;)</code></pre>
<p><img src="rd_files/figure-html/SpeciesDistribution_id_47-1.png" width="624" /></p>
<pre><code>## $mu
## [1] 0.9519812
## 
## $sigma
## [1] 1.011383</code></pre>
<h4>
See also
</h4>
<p><code><a href=http://www.rdocumentation.org/packages/stats/topics/Geometric>rgeom</a></code>, <code><a href=http://www.rdocumentation.org/packages/stats/topics/Lognormal>rlnorm</a></code>, <code><a href=#rcommunity>rCommunity</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a>, Bruno Herault <a href="mailto:Bruno.Herault@ecofog.gf">Bruno.Herault@ecofog.gf</a></p>
</div>
</div>
<div id="arithmetics" class="section level1">
<h1>Arithmetics</h1>
<div id="enq" class="section level2">
<h2>Enq</h2>
<a id="Enq_alias"></a>
<h3>
Grassberger’s expectation of n^q
</h3>
<p class="rd-p">
Expected value of <span class="math inline"><em>n</em><sup><em>q</em></sup></span> when <span class="math inline"><em>n</em></span> follows a Poisson law.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Enq(n, q)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
n
</dt>
<dd class="rd-dd">
A positive integer vector.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A positive number.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The expectation of <span class="math inline"><em>n</em><sup><em>q</em></sup></span> when <span class="math inline"><em>n</em></span> follows a Poisson ditribution has been derived by Grassberger (1988).
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A vector of the same length as <code>x</code> containing the transformed values.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Grassberger, P. (1988). Finite sample corrections to entropy and dimension estimates. Physics Letters A 128(6-7): 369-373.
</p>
<h4>
Note
</h4>
<p class="rd-p">
The function is computed using the <code><a href=http://www.rdocumentation.org/packages/base/topics/Special>beta</a></code>.function.
</p>
<p class="rd-p">
Its value is 0 for <span class="math inline"><em>n</em> − <em>q</em> + 1 &lt; 0</span>.
</p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="klq" class="section level2">
<h2>KLq</h2>
<a id="KLq_alias"></a>
<h3>
Generalized Kullback-Leibler divergence
</h3>
<p class="rd-p">
Calculates the generalized Kullback-Leibler divergence between an observed and an expected probability distribution.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>KLq(Ps, Pexp, q&nbsp;=&nbsp;1, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ps
</dt>
<dd class="rd-dd">
The observed probability vector.
</dd>
<dt>
Pexp
</dt>
<dd class="rd-dd">
The expected probability vector.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number: the order of entropy. Default is 1.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The generalized Kullback-Leibler divergence (Borland et al., 1998) converges to the Kullback-Leibler divergence (Kullback and Leibler, 1951) when <span class="math inline"><em>q</em></span> tends to 1. It is used to calculate the generalized beta entropy (Marcon et al., 2014).
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A number equal to the generalized Kullback-Leibler divergence between the probability distributions.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Borland, L., Plastino, A. R. and Tsallis, C. (1998). Information gain within nonextensive thermostatistics. <em>Journal of Mathematical Physics</em> 39(12): 6490-6501.
</p>
<p class="rd-p">
Kullback, S. and Leibler, R. A. (1951). On Information and Sufficiency. The Annals of Mathematical <em>Statistics</em> 22(1): 79-86.
</p>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Ps is the vector of probabilities
Ps &lt;- Paracou618.MC$Ps
# Probability distribution of the first plot
Ps1 &lt;- Paracou618.MC$Psi[, 1]
# Divergence of order 2 between the first plot and the whole forest
KLq(Ps1, Ps, 2)</code></pre>
<pre><code>## [1] 0.01004705</code></pre>
<h4>
See also
</h4>
<p><code><a href=#tsallisbeta>TsallisBeta</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="expq-expq-expq.communityprofile" class="section level2">
<h2>expq: expq, expq.CommunityProfile</h2>
<a id="expq_alias"></a>
<h3>
Exponential of order q
</h3>
<p class="rd-p">
Calculates the deformed exponential of order <span class="math inline"><em>q</em></span>.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>expq(x, q)
expq.CommunityProfile(Profile)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
A numeric vector.
</dd>
<dt>
Profile
</dt>
<dd class="rd-dd">
A <code><a href=#communityprofile>CommunityProfile</a></code>.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The deformed exponential is defined as <span class="math inline">$(x(1-q)+1)^{\frac{1}{(1-q)}}$</span>.
</p>
<p class="rd-p">
For <span class="math inline"><em>q</em> &gt; 1</span>, <span class="math inline">$\ln_q{(+\infty)}=\frac{1}{(q-1)}$</span> so <span class="math inline">exp<sub><em>q</em></sub>(<em>x</em>)</span> is not defined for <span class="math inline">$x&gt;\frac{1}{(q-1)}$</span>.
</p>
<p class="rd-p">
<code>expq.CommunityProfile</code> calculates the deformed exponential of a <code><a href=#communityprofile>CommunityProfile</a></code>. Its <code><span class="math inline"><em>x</em> &lt; /<em>c</em><em>o</em><em>d</em><em>e</em> &gt; <em>i</em><em>t</em><em>e</em><em>m</em>(<em>t</em><em>h</em><em>e</em><em>o</em><em>r</em><em>d</em><em>e</em><em>r</em><em>o</em><em>f</em><em>d</em><em>v</em><em>e</em><em>r</em><em>s</em><em>i</em><em>t</em><em>y</em>)<em>i</em><em>s</em><em>k</em><em>e</em><em>p</em><em>t</em><em>u</em><em>n</em><em>c</em><em>h</em><em>a</em><em>n</em><em>g</em><em>e</em><em>d</em><em>w</em><em>h</em><em>i</em><em>l</em><em>s</em><em>t</em><em>o</em><em>t</em><em>h</em><em>e</em><em>r</em><em>i</em><em>t</em><em>e</em><em>m</em><em>s</em><em>a</em><em>r</em><em>e</em><em>s</em><em>e</em><em>t</em><em>t</em><em>o</em><em>t</em><em>h</em><em>e</em><em>i</em><em>r</em><em>e</em><em>x</em><em>p</em><em>o</em><em>n</em><em>e</em><em>n</em><em>t</em><em>i</em><em>a</em><em>l</em><em>o</em><em>f</em><em>o</em><em>r</em><em>d</em><em>e</em><em>r</em> &lt; <em>c</em><em>o</em><em>d</em><em>e</em>&gt;</span>x</code>. Thus, an entropy profile is transformed into a diversity profile.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A vector of the same length as <code>x</code> containing the transformed values or a <code><a href=#communityprofile>CommunityProfile</a></code>.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Scotti, I., Herault, B., Rossi, V. and Lang, G. (2014). Generalization of the partitioning of Shannon diversity. <em>PLOS One</em> 9(3): e90289.
</p>
<p class="rd-p">
Tsallis, C. (1994). What are the numbers that experiments provide? <em>Quimica Nova</em> 17(6): 468-471.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>curve(exp(x), -5, 0, lty=3)  
curve(expq(x, 2), -5, 0, lty=2, add=TRUE)
curve(expq(x, 3), -5, 0, lty=1, add=TRUE)
legend(&quot;topleft&quot;, legend = c(&quot;exp(x)&quot;, &quot;exp2(x)&quot;, &quot;exp3(x)&quot;), lty = c(1, 2, 3), inset=0.02)</code></pre>
<p><img src="rd_files/figure-html/expq_id_50-1.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#expq>expq</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="lnq-lnq-lnq.communityprofile" class="section level2">
<h2>lnq: lnq, lnq.CommunityProfile</h2>
<a id="lnq_alias"></a>
<h3>
Logarithm of order q
</h3>
<p class="rd-p">
Calculates the deformed logarithm of order <span class="math inline"><em>q</em></span>.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>lnq(x, q)
lnq.CommunityProfile(Profile)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
A numeric vector.
</dd>
<dt>
Profile
</dt>
<dd class="rd-dd">
A <code><a href=#communityprofile>CommunityProfile</a></code>.
</dd>
<dt>
q
</dt>
<dd class="rd-dd">
A number.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The deformed logarithm is defined as <span class="math inline">$\ln_q{x}=\frac{(x^{(1-q)}-1)}{(1-q)}$</span>.
</p>
<p class="rd-p">
The shape of the deformed logarithm is similar to that of the regular one. <span class="math inline">ln<sub>1</sub><em>x</em> = log<em>x</em></span>.
</p>
<p class="rd-p">
For <span class="math inline"><em>q</em> &gt; 1</span>, <span class="math inline">$\ln_q{(+\infty)}=\frac{1}{(q-1)}$</span>.
</p>
<p class="rd-p">
<code>lnq.CommunityProfile</code> calculates the deformed logarithm of a <code><a href=#communityprofile>CommunityProfile</a></code>. Its <code><span class="math inline"><em>x</em> &lt; /<em>c</em><em>o</em><em>d</em><em>e</em> &gt; <em>i</em><em>t</em><em>e</em><em>m</em>(<em>t</em><em>h</em><em>e</em><em>o</em><em>r</em><em>d</em><em>e</em><em>r</em><em>o</em><em>f</em><em>d</em><em>v</em><em>e</em><em>r</em><em>s</em><em>i</em><em>t</em><em>y</em>)<em>i</em><em>s</em><em>k</em><em>e</em><em>p</em><em>t</em><em>u</em><em>n</em><em>c</em><em>h</em><em>a</em><em>n</em><em>g</em><em>e</em><em>d</em><em>w</em><em>h</em><em>i</em><em>l</em><em>s</em><em>t</em><em>o</em><em>t</em><em>h</em><em>e</em><em>r</em><em>i</em><em>t</em><em>e</em><em>m</em><em>s</em><em>a</em><em>r</em><em>e</em><em>s</em><em>e</em><em>t</em><em>t</em><em>o</em><em>t</em><em>h</em><em>e</em><em>i</em><em>r</em><em>l</em><em>o</em><em>g</em><em>a</em><em>r</em><em>i</em><em>t</em><em>h</em><em>m</em><em>o</em><em>f</em><em>o</em><em>r</em><em>d</em><em>e</em><em>r</em> &lt; <em>c</em><em>o</em><em>d</em><em>e</em>&gt;</span>x</code>. Thus, a diversity profile is transformed into an entropy profile.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A vector of the same length as <code>x</code> containing the transformed values or a <code><a href=#communityprofile>CommunityProfile</a></code>.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Tsallis, C. (1994). What are the numbers that experiments provide? <em>Quimica Nova</em> 17(6): 468-471.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>curve(log(x), 0, 1, lty=1)
curve(lnq(x, 2), 0, 1, lty=2, add=TRUE)
curve(lnq(x, 3), 0, 1, lty=3, add=TRUE)  
legend(&quot;topleft&quot;, legend = c(&quot;log(x)&quot;, &quot;ln2(x)&quot;, &quot;ln3(x)&quot;), lty = c(1, 2, 3), inset=0.02)</code></pre>
<p><img src="rd_files/figure-html/lnq_id_51-1.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#expq>expq</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
</div>
<div id="utilities" class="section level1">
<h1>Utilities</h1>
<div id="abdfreqcount" class="section level2">
<h2>AbdFreqCount</h2>
<a id="AbdFreqCount_alias"></a>
<h3>
Abundance Frequency Count of a Community
</h3>
<p class="rd-p">
Counts the number of species observed the same number of times.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>AbdFreqCount(Ns, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The Abundance Frequency Count (Chao <em>et al.</em>, 2015) is the number of species observed each number of times.
</p>
<p class="rd-p">
It is a way to summarize the species distribution.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A two-column matrix. The first column contains the number of observations, the second one the number of species observed this number of times.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Chao, A., Hsieh, T. C., Chazdon, R. L., Colwell, R. K., Gotelli, N. J. (2015) Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory. <em>Ecology</em> 96(5): 1189-1201.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Ns is the vector of abundances of the first plot
Ns &lt;- Paracou618.MC$Nsi[, 1]

# Return the abundance frequency count
(AbdFreqCount(Ns) -&gt; afc)</code></pre>
<pre><code>##       Abundance NbSpecies
##  [1,]         1        68
##  [2,]         2        29
##  [3,]         3        14
##  [4,]         4         5
##  [5,]         5         8
##  [6,]         6         3
##  [7,]         7         4
##  [8,]         9         1
##  [9,]        10         2
## [10,]        13         1
## [11,]        14         1
## [12,]        16         1
## [13,]        19         1
## [14,]        21         1
## [15,]        23         1
## [16,]        25         1
## [17,]        26         1
## [18,]        30         1
## [19,]        31         1
## [20,]        38         1
## [21,]        39         1
## [22,]        45         1</code></pre>
<pre class="r"><code>plot(afc, xlab=&quot;Number of observations&quot;, ylab=&quot;Number of species&quot;)
lines(afc)</code></pre>
<p><img src="rd_files/figure-html/AbdFreqCount_id_52-1.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#phyloentropy>PhyloEntropy</a></code>, <code><a href=#chaopd>ChaoPD</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="entropyci" class="section level2">
<h2>EntropyCI</h2>
<a id="EntropyCI_alias"></a>
<h3>
Entropy of Monte-Carlo simulated communities
</h3>
<p class="rd-p">
Resamples a community by Monte-Carlo simulations of a multinomial distribution and returns a vector of entropy values to calculate confidence intervals.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>EntropyCI(FUN, Simulations&nbsp;=&nbsp;100, Ns, BootstrapMethod&nbsp;=&nbsp;"Chao2015",  ..., CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
FUN
</dt>
<dd class="rd-dd">
The entropy function to be applied to each simulated community. May be any entropy function accepting a vector of species abundances, such as <code><a href=#tsallis>bcTsallis</a></code>, <code><a href=#shannon>bcShannon</a></code>, <code><a href=#simpson>bcSimpson</a></code> or <code><a href=#phyloentropy>bcPhyloEntropy</a></code>.
</dd>
<dt>
Simulations
</dt>
<dd class="rd-dd">
The number of simulations to build confidence intervals.
</dd>
<dt>
Ns
</dt>
<dd class="rd-dd">
A numeric vector containing species abundances.
</dd>
<dt>
BootstrapMethod
</dt>
<dd class="rd-dd">
The method used to obtain the probabilities to generate bootstrapped communities from observed abundances. See <code><a href=#rcommunity>rCommunity</a></code>.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Additional arguments to be passed to <code>FUN</code>.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This function is used to obtain the distribution of entropy and eventually calculate confidence intervals. It draws simulated communities according to a multinomial distribution with the same number of individuals and probabilities as the actual community. It calculates the entropy of each simulated community. Last, it recenters the distribution of entropy values arounf the actual value of entropy according to Marcon <em>et al.</em> (2012): the estimation bias of simulated communities entropy can not be corrected analytically, but it does not affect the distribution shape.
</p>
<p class="rd-p">
Diversity can not be recentered this way so diversity function should not be used. Unexpected results will be obtained if inappropriate functions are used.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A numeric vector containing the entropy value of each simulated community.
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Herault, B., Baraloto, C. and Lang, G. (2012). The Decomposition of Shannons Entropy and a Confidence Interval for Beta Diversity. <em>Oikos</em> 121(4): 516-522.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Abundance (all estimators will include bias corrrection)
Ns &lt;- as.AbdVector(Paracou618.MC$Ns)
q &lt;- 1
# Estimate entropy and transform it into diversity
RealEst &lt;- expq(Tsallis(Ns, q), q)
# Transform the distribution of Tsallis entropy into diversity
SimulatedDiversity &lt;- expq(EntropyCI(Tsallis, Simulations=50, Ns, q=q), q)</code></pre>
<pre><code>## ===========================================================================</code></pre>
<pre class="r"><code># Figure
plot(density(SimulatedDiversity), col=&quot;black&quot;, lwd=2, main=&quot;&quot;, xlab =&quot;Diversity&quot;)
abline(v=RealEst, col=&quot;red&quot;, lwd=2, lty=2)
abline(v=quantile(SimulatedDiversity, probs = 0.025), col=&quot;black&quot;, lwd=1, lty=3)
abline(v=quantile(SimulatedDiversity, probs = 0.975), col=&quot;black&quot;, lwd=1, lty=3)
legend(&quot;topright&quot;, c(&quot;Real value&quot;, &quot;Confidence interval&quot;), lty=c(2,3),
col=c(&quot;red&quot;, &quot;black&quot;), inset=0.01)</code></pre>
<p><img src="rd_files/figure-html/EntropyCI_id_53-1.png" width="624" /></p>
<pre class="r"><code># Print results
cat(&quot;Estimated Diversity:&quot;, RealEst)</code></pre>
<pre><code>## Estimated Diversity: 133.2409</code></pre>
<pre class="r"><code>quantile(SimulatedDiversity, probs = c(0.025, 0.975))</code></pre>
<pre><code>##     2.5%    97.5% 
## 123.6419 144.3974</code></pre>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="mergeandlabel" class="section level2">
<h2>mergeandlabel</h2>
<a id="mergeandlabel_alias"></a>
<h3>
Merge community data
</h3>
<p class="rd-p">
Merge two dataframes containing species abundances.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>mergeandlabel(x, y)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
A dataframe containing species abundances
</dd>
<dt>
y
</dt>
<dd class="rd-dd">
A dataframe containing species abundances
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Row names must contain species. The new dataframes keeps all species with abundance zero for species that were not found in orfginal communities.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A dataframe containing all lines and columns of the merged dataframes.
</dl>
</p>
<h4>
See also
</h4>
<p><code><a href=#mergemc>MergeC</a></code>, <code><a href=#mergemc>MergeMC</a></code>, <code><a href=#mergemc>ShuffleMC</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="optimal.similarity" class="section level2">
<h2>Optimal.Similarity</h2>
<a id="Optimal.Similarity_alias"></a>
<h3>
Optimal scale parameter to transform a distance matrix into a similarity matrix
</h3>
<p class="rd-p">
Calculates the scale parameter <span class="math inline"><em>u</em></span> that maximizes the variance of the similarity matrix <span class="math inline"><em>e</em><em>x</em><em>p</em>(−<em>u</em> * <em>D</em><em>i</em><em>s</em><em>t</em><em>a</em><em>n</em><em>c</em><em>e</em><em>M</em><em>a</em><em>t</em><em>r</em><em>i</em><em>x</em>)</span>.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Optimal.Similarity(Distance, CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Distance
</dt>
<dd class="rd-dd">
A distance matrix, <em>i.e.</em> a square matrix with zeros on its diagonal or a <code><a href=http://www.rdocumentation.org/packages/stats/topics/dist>dist</a></code> object.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The similarity matrix used by <code><a href=#dqz>Dqz</a></code>) can be optimized following Marcon <em>et al.</em> (2014) such that the variance of similarities between pairs of species is maximized. See the example.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
A list:
<dt>
u
</dt>
<dd>
The optimal scale <span class="math inline"><em>u</em></span>.
</dd>
</p>
<p class="rd-p">
<dt>
Matrix
</dt>
<dd>
The optimal similarity matrix <code>Z</code>.
</dd>
</p>
<p class="rd-p">
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Zhang, Z. and Herault, B. (2014). The decomposition of similarity-based diversity and its bias correction. <em>HAL</em> hal-00989454(version 3).
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest)
data(Paracou618)
# Prepare the similarity matrix. The square root of Paracou618.dist is euclidean.
optimal &lt;- Optimal.Similarity(sqrt(Paracou618.dist))
# Optimal scale
optimal$u</code></pre>
<pre><code>## [1] 2.348622</code></pre>
<pre class="r"><code># Calculate diversity of order 2
bcDqz(Paracou618.MC$Ns, 2, optimal$Matrix)</code></pre>
<pre><code>##     Best 
## 1.558321</code></pre>
<h4>
See also
</h4>
<p><code><a href=#dqz>Dqz</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="phyloapply" class="section level2">
<h2>PhyloApply</h2>
<a id="PhyloApply_alias"></a>
<h3>
Apply a Function over a Phylogenetic Tree
</h3>
<p class="rd-p">
Cuts the tree into slices separated by nodes, applies the function to each slice and returns the weighted (by slice lengths) sum of the results.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>PhyloApply(Tree, FUN, NorP, Normalize&nbsp;=&nbsp;TRUE, ..., CheckArguments&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Tree
</dt>
<dd class="rd-dd">
An object of class <code><a href=http://www.rdocumentation.org/packages/stats/topics/hclust>hclust</a></code>, <code><a href=http://www.rdocumentation.org/packages/ape/topics/read.tree>phylo</a></code>, <code><a href=http://www.rdocumentation.org/packages/ade4/topics/phylog>phylog</a></code> or <code><a href=#pptree>PPtree</a></code>. The tree must be ultrametric.
</dd>
<dt>
FUN
</dt>
<dd class="rd-dd">
The function to be applied to each interval of the tree.
</dd>
<dt>
NorP
</dt>
<dd class="rd-dd">
A numeric vector or a two-column matrix. Contains either abundances or probabilities. Two-column matrices should contain the observed abundances (or probabilities) in the first column and the expected ones in the second column, to allow using beta diversity functions.
</dd>
<dt>
Normalize
</dt>
<dd class="rd-dd">
If <code>TRUE</code> (default), the <code>Total</code> value returned by <code>Function</code> is normalized by the height of the tree (it is the weighted average value of the result in each slice). If <code>FALSE</code>, it is the unnormalized weighted sum of the results.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Further arguments to pass to <code>Function</code>.
</dd>
<dt>
CheckArguments
</dt>
<dd class="rd-dd">
Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This funtion is generally not used directly. It is a tool to calculate <code><a href=#phyloentropy>PhyloEntropy</a></code> and <code><a href=#phylodiversity>PhyloDiversity</a></code>.
</p>
<p class="rd-p">
Intervals separate two cuts in a tree: no node is found at heights contained in an interval.
</p>
<p class="rd-p">
Objects of class <strong>PPtree</strong> are returned by <code><a href=#preprocess.tree>Preprocess.Tree</a></code>.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An object of class <code>PhyloValue</code>. It is a list:
<dt>
Distribution
</dt>
<dd>
The distribution used to calculate the value
</dd>
</p>
<p class="rd-p">
<dt>
Function
</dt>
<dd>
The function used to calculate the value
</dd>
</p>
<p class="rd-p">
<dt>
Tree
</dt>
<dd>
The functional or phylogenetic tree used to calculate the value
</dd>
</p>
<p class="rd-p">
<dt>
Normalized
</dt>
<dd>
Logical. Indicates whether phylovalue is normalized or proportional to the height of the tree.
</dd>
</p>
<p class="rd-p">
<dt>
Cuts
</dt>
<dd>
A named vector containing values along the tree. Names are cut ends, <em>i.e.</em> the ends of intervals (the first interval starts at 0 for leaves, the max value is the height of the tree).
</dd>
</p>
<p class="rd-p">
<dt>
Total
</dt>
<dd>
A value equal the total value, multiplied by the tree height if <code>Normalize</code> is FALSE.
</dd>
</p>
<p class="rd-p">
</dl>
</p>
<h4>
References
</h4>
<p class="rd-p">
Marcon, E., Herault, B. (2015). Decomposing Phylodiversity. <em>Methods in Ecology and Evolution</em> 6(3): 333-339.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># Load Paracou data (number of trees per species in two 1-ha plot of a tropical forest
#      and their taxonomy)
data(Paracou618)
# Plot the taxonomy
plot(Paracou618.Taxonomy, type=&quot;fan&quot;, show.tip.label=FALSE)</code></pre>
<p><img src="rd_files/figure-html/PhyloApply_id_56-1.png" width="624" /></p>
<pre class="r"><code># Calculate the mean number of trees (individuals) per species 
# (Cuts are 1=species, 2=genus, 3=family)
PhyloApply(Paracou618.Taxonomy, mean, Paracou618.MC$Ns, TRUE)</code></pre>
<pre><code>## $Distribution
##   [1] &quot;Paracou618.MC$structure(c(3L, 0L, 3L, 4L, 1L, 2L, 0L, 0L, 0L, &quot;                     
##   [2] &quot;2L, 0L, 40L, 0L, 0L, 1L, 6L, 6L, 1L, 2L, 1L, 4L, 0L, 0L, 3L, &quot;                      
##   [3] &quot;0L, 2L, 0L, 1L, 4L, 1L, 14L, 4L, 5L, 0L, 0L, 1L, 0L, 0L, 0L, &quot;                      
##   [4] &quot;0L, 2L, 0L, 0L, 0L, 0L, 0L, 0L, 8L, 3L, 2L, 1L, 0L, 1L, 4L, 0L, &quot;                   
##   [5] &quot;4L, 2L, 9L, 0L, 4L, 0L, 1L, 5L, 1L, 2L, 3L, 0L, 1L, 1L, 0L, 1L, &quot;                   
##   [6] &quot;1L, 0L, 0L, 0L, 18L, 21L, 7L, 0L, 21L, 2L, 0L, 8L, 2L, 0L, 5L, &quot;                    
##   [7] &quot;0L, 1L, 4L, 2L, 0L, 0L, 14L, 1L, 11L, 0L, 26L, 1L, 6L, 28L, 5L, &quot;                   
##   [8] &quot;5L, 2L, 1L, 1L, 0L, 2L, 0L, 0L, 2L, 0L, 1L, 26L, 1L, 9L, 1L, &quot;                      
##   [9] &quot;0L, 0L, 3L, 1L, 0L, 2L, 0L, 6L, 2L, 5L, 11L, 1L, 1L, 9L, 0L, &quot;                      
##  [10] &quot;1L, 31L, 38L, 2L, 2L, 0L, 7L, 1L, 13L, 0L, 1L, 1L, 2L, 45L, 25L, &quot;                  
##  [11] &quot;0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 1L, 2L, 0L, 0L, &quot;                   
##  [12] &quot;7L, 3L, 1L, 1L, 1L, 0L, 0L, 2L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L, &quot;                   
##  [13] &quot;5L, 0L, 0L, 3L, 1L, 3L, 0L, 0L, 0L, 2L, 0L, 0L, 2L, 0L, 10L, &quot;                      
##  [14] &quot;0L, 2L, 1L, 2L, 1L, 0L, 2L, 4L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, &quot;                   
##  [15] &quot;0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 0L, &quot;                   
##  [16] &quot;0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 2L, 0L, 0L, 4L, 2L, 1L, &quot;                   
##  [17] &quot;1L, 8L, 0L, 0L, 4L, 33L, 23L, 0L, 0L, 0L, 0L, 31L, 0L, 0L, 29L, &quot;                   
##  [18] &quot;2L, 2L, 11L, 1L, 0L, 18L, 4L, 0L, 5L, 0L, 1L, 0L, 5L, 2L, 3L, &quot;                     
##  [19] &quot;1L, 1L, 1L, 0L, 0L, 2L, 3L, 0L, 0L, 3L, 3L, 8L, 0L, 1L, 5L, 0L, &quot;                   
##  [20] &quot;1L, 6L, 1L, 20L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 4L, 0L, &quot;                      
##  [21] &quot;2L, 0L, 0L, 0L, 0L, 3L, 1L, 0L, 0L, 1L, 0L, 14L, 26L, 0L, 3L, &quot;                     
##  [22] &quot;0L, 0L, 1L, 0L, 3L, 1L, 1L, 0L, 0L, 1L, 0L, 0L, 6L, 0L, 0L, 0L, &quot;                   
##  [23] &quot;3L, 1L, 0L, 0L, 0L, 1L, 0L, 1L, 0L, 1L, 3L, 0L, 0L, 2L, 1L, 0L, &quot;                   
##  [24] &quot;1L, 3L, 0L, 1L, 2L, 0L, 0L, 0L, 2L, 2L, 1L, 0L, 2L, 3L, 0L, 5L, &quot;                   
##  [25] &quot;0L, 0L, 4L, 1L, 0L, 0L, 1L, 1L, 4L, 0L, 0L, 2L, 4L, 0L, 1L, 0L, &quot;                   
##  [26] &quot;0L, 3L, 2L, 4L, 0L, 2L, 0L, 0L, 1L, 0L, 1L, 15L, 1L, 1L, 0L, &quot;                      
##  [27] &quot;2L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 11L, 0L, 9L, 1L, 0L, 1L, &quot;                      
##  [28] &quot;0L, 0L, 3L, 3L, 2L, 0L, 4L, 1L, 2L, 0L, 0L, 1L, 0L, 5L), class = c(\&quot;AbdVector\&quot;, &quot; 
##  [29] &quot;\&quot;SpeciesDistribution\&quot;, \&quot;integer\&quot;), .Names = c(\&quot;Anac_Anac_spru\&quot;, &quot;             
##  [30] &quot;\&quot;Anac_Astr_ulei\&quot;, \&quot;Anac_Tapi_guia\&quot;, \&quot;Anac_Thyr_guia\&quot;, \&quot;Anac_Thyr_pube\&quot;, &quot;   
##  [31] &quot;\&quot;Anno_Dugu_caly\&quot;, \&quot;Anno_Dugu_suri\&quot;, \&quot;Anno_Fusa_long\&quot;, \&quot;Anno_Guat_anth\&quot;, &quot;   
##  [32] &quot;\&quot;Anno_Guat_guia\&quot;, \&quot;Anno_Guat_wach\&quot;, \&quot;Anno_Oxan_asbe\&quot;, \&quot;Anno_Roll_elli\&quot;, &quot;   
##  [33] &quot;\&quot;Anno_Unon_perr\&quot;, \&quot;Anno_Unon_rufe\&quot;, \&quot;Anno_Xylo_niti\&quot;, \&quot;Apoc_Ambe_acid\&quot;, &quot;   
##  [34] &quot;\&quot;Apoc_Anar_meye\&quot;, \&quot;Apoc_Aspi_albu\&quot;, \&quot;Apoc_Aspi_crue\&quot;, \&quot;Apoc_Aspi_marc\&quot;, &quot;   
##  [35] &quot;\&quot;Apoc_Aspi_oblo\&quot;, \&quot;Apoc_Aspi_spru\&quot;, \&quot;Apoc_Coum_guia\&quot;, \&quot;Apoc_Hima_sp_\&quot;, &quot;    
##  [36] &quot;\&quot;Apoc_Lacm_acul\&quot;, \&quot;Aqui_Ilex_sp_\&quot;, \&quot;Aral_Sche_deca\&quot;, \&quot;Arec_Astr_scio\&quot;, &quot;    
##  [37] &quot;\&quot;Arec_Eute_oler\&quot;, \&quot;Arec_Jess_bata\&quot;, \&quot;Arec_Oeno_baca\&quot;, \&quot;Bign_Jaca_copa\&quot;, &quot;   
##  [38] &quot;\&quot;Bign_Tabe_sp_\&quot;, \&quot;Bora_Cord_IND\&quot;, \&quot;Bora_Cord_sago\&quot;, \&quot;Bora_Cord_sp_\&quot;, &quot;      
##  [39] &quot;\&quot;Bras_Capp_maro\&quot;, \&quot;Burs_Crep_goud\&quot;, \&quot;Burs_Dacr_cusp\&quot;, \&quot;Burs_Dacr_nite\&quot;, &quot;   
##  [40] &quot;\&quot;Burs_Dacr_sp_\&quot;, \&quot;Burs_Prot_apic\&quot;, \&quot;Burs_Prot_deca\&quot;, \&quot;Burs_Prot_gall\&quot;, &quot;    
##  [41] &quot;\&quot;Burs_Prot_guia\&quot;, \&quot;Burs_Prot_mori\&quot;, \&quot;Burs_Prot_opac\&quot;, \&quot;Burs_Prot_sago\&quot;, &quot;   
##  [42] &quot;\&quot;Burs_Prot_subs\&quot;, \&quot;Burs_Prot_tenu\&quot;, \&quot;Burs_Prot_trif\&quot;, \&quot;Burs_Tetr_alti\&quot;, &quot;   
##  [43] &quot;\&quot;Burs_Tetr_pana\&quot;, \&quot;Burs_Trat_deme\&quot;, \&quot;Cary_Cary_glab\&quot;, \&quot;Cela_Chei_cogn\&quot;, &quot;   
##  [44] &quot;\&quot;Cela_Goup_glab\&quot;, \&quot;Cela_IND_sp_\&quot;, \&quot;Cela_Mayt_oblo\&quot;, \&quot;Cela_Mayt_sp_1\&quot;, &quot;     
##  [45] &quot;\&quot;Cela_Mayt_sp_2\&quot;, \&quot;Chry_Coue_brac\&quot;, \&quot;Chry_Coue_cary\&quot;, \&quot;Chry_Coue_guia\&quot;, &quot;   
##  [46] &quot;\&quot;Chry_Coue_habr\&quot;, \&quot;Chry_Coue_joaq\&quot;, \&quot;Chry_Coue_magn\&quot;, \&quot;Chry_Coue_pari\&quot;, &quot;   
##  [47] &quot;\&quot;Chry_Hirt_arag\&quot;, \&quot;Chry_Hirt_glandi\&quot;, \&quot;Chry_Hirt_glandu\&quot;, \&quot;Chry_Hirt_IND\&quot;, &quot;
##  [48] &quot;\&quot;Chry_Hirt_suff\&quot;, \&quot;Chry_IND_IND\&quot;, \&quot;Chry_Lica_alba\&quot;, \&quot;Chry_Lica_cane\&quot;, &quot;     
##  [49] &quot;\&quot;Chry_Lica_hete\&quot;, \&quot;Chry_Lica_IND\&quot;, \&quot;Chry_Lica_laxi\&quot;, \&quot;Chry_Lica_lica\&quot;, &quot;    
##  [50] &quot;\&quot;Chry_Lica_maju\&quot;, \&quot;Chry_Lica_memb\&quot;, \&quot;Chry_Lica_micr\&quot;, \&quot;Chry_Lica_minu\&quot;, &quot;   
##  [51] &quot;\&quot;Chry_Lica_oval\&quot;, \&quot;Chry_Lica_sp_1\&quot;, \&quot;Chry_Lica_sp_2\&quot;, \&quot;Chry_Lica_spru\&quot;, &quot;   
##  [52] &quot;\&quot;Chry_Pari_camp\&quot;, \&quot;Chry_Pari_mont\&quot;, \&quot;Clus_Clus_gran\&quot;, \&quot;Clus_Moro_cocc\&quot;, &quot;   
##  [53] &quot;\&quot;Clus_Plat_insi\&quot;, \&quot;Clus_Rhee_madr\&quot;, \&quot;Clus_Symp_glob\&quot;, \&quot;Clus_Symp_sp_\&quot;, &quot;    
##  [54] &quot;\&quot;Clus_Tovo_IND\&quot;, \&quot;Clus_Tovo_sp_1\&quot;, \&quot;Clus_Tovo_sp_2\&quot;, \&quot;Clus_Tovo_sp_3\&quot;, &quot;    
##  [55] &quot;\&quot;Clus_Tovo_sp_4\&quot;, \&quot;Clus_Tovo_sp_5\&quot;, \&quot;Clus_Tovo_sp_6\&quot;, \&quot;Clus_Tovo_sp_7\&quot;, &quot;   
##  [56] &quot;\&quot;Clus_Vism_caye\&quot;, \&quot;Comb_Buch_gran\&quot;, \&quot;Comb_Buch_guia\&quot;, \&quot;Comb_Buch_IND\&quot;, &quot;    
##  [57] &quot;\&quot;Comb_Buch_tetr\&quot;, \&quot;Comb_Term_guia\&quot;, \&quot;Dich_Tapu_amaz\&quot;, \&quot;Dich_Tapu_capi\&quot;, &quot;   
##  [58] &quot;\&quot;Eben_Dios_capr\&quot;, \&quot;Eben_Dios_carb\&quot;, \&quot;Elae_Sloa_brev\&quot;, \&quot;Elae_Sloa_garc\&quot;, &quot;   
##  [59] &quot;\&quot;Elae_Sloa_guia\&quot;, \&quot;Elae_Sloa_lati\&quot;, \&quot;Elae_Sloa_sp_1\&quot;, \&quot;Elae_Sloa_sp_2\&quot;, &quot;   
##  [60] &quot;\&quot;Elae_Sloa_sp_3\&quot;, \&quot;Elae_Sloa_sp_4\&quot;, \&quot;Euph_Chae_scho\&quot;, \&quot;Euph_Chae_sp_\&quot;, &quot;    
##  [61] &quot;\&quot;Euph_Conc_guia\&quot;, \&quot;Euph_Dryp_fans\&quot;, \&quot;Euph_Dryp_vari\&quot;, \&quot;Euph_Glyc_amaz\&quot;, &quot;   
##  [62] &quot;\&quot;Euph_Heve_guia\&quot;, \&quot;Euph_Hyer_alch\&quot;, \&quot;Euph_Mabe_piri\&quot;, \&quot;Euph_Pogo_scho\&quot;, &quot;   
##  [63] &quot;\&quot;Euph_Sand_guia\&quot;, \&quot;Faba_Abar_jupu\&quot;, \&quot;Faba_Abar_mata\&quot;, \&quot;Faba_Andi_IND\&quot;, &quot;    
##  [64] &quot;\&quot;Faba_Boco_prou\&quot;, \&quot;Faba_Cass_spru\&quot;, \&quot;Faba_Dico_guia\&quot;, \&quot;Faba_Dipl_purp\&quot;, &quot;   
##  [65] &quot;\&quot;Faba_Dipt_odor\&quot;, \&quot;Faba_Dipt_punc\&quot;, \&quot;Faba_Ente_scho\&quot;, \&quot;Faba_Eper_falc\&quot;, &quot;   
##  [66] &quot;\&quot;Faba_Eper_gran\&quot;, \&quot;Faba_Hyme_cour\&quot;, \&quot;Faba_Hyme_flav\&quot;, \&quot;Faba_IND_sp_\&quot;, &quot;     
##  [67] &quot;\&quot;Faba_Inga_acre\&quot;, \&quot;Faba_Inga_acro\&quot;, \&quot;Faba_Inga_alba\&quot;, \&quot;Faba_Inga_albi\&quot;, &quot;   
##  [68] &quot;\&quot;Faba_Inga_brac\&quot;, \&quot;Faba_Inga_fanc\&quot;, \&quot;Faba_Inga_grac\&quot;, \&quot;Faba_Inga_hube\&quot;, &quot;   
##  [69] &quot;\&quot;Faba_Inga_leio\&quot;, \&quot;Faba_Inga_long\&quot;, \&quot;Faba_Inga_loub\&quot;, \&quot;Faba_Inga_nour\&quot;, &quot;   
##  [70] &quot;\&quot;Faba_Inga_para\&quot;, \&quot;Faba_Inga_pezi\&quot;, \&quot;Faba_Inga_rubi\&quot;, \&quot;Faba_Inga_sarm\&quot;, &quot;   
##  [71] &quot;\&quot;Faba_Inga_stip\&quot;, \&quot;Faba_Ormo_stip\&quot;, \&quot;Faba_Papi_IND\&quot;, \&quot;Faba_Park_giga\&quot;, &quot;    
##  [72] &quot;\&quot;Faba_Park_niti\&quot;, \&quot;Faba_Park_pend\&quot;, \&quot;Faba_Park_sp_\&quot;, \&quot;Faba_Park_ulei\&quot;, &quot;    
##  [73] &quot;\&quot;Faba_Park_velu\&quot;, \&quot;Faba_Pelt_pani\&quot;, \&quot;Faba_Plat_pinn\&quot;, \&quot;Faba_Pseu_psil\&quot;, &quot;   
##  [74] &quot;\&quot;Faba_Pseu_suav\&quot;, \&quot;Faba_Reco_spec\&quot;, \&quot;Faba_Stry_mori\&quot;, \&quot;Faba_Swar_cane\&quot;, &quot;   
##  [75] &quot;\&quot;Faba_Swar_lebl\&quot;, \&quot;Faba_Swar_pana\&quot;, \&quot;Faba_Swar_poly\&quot;, \&quot;Faba_Swar_sp_\&quot;, &quot;    
##  [76] &quot;\&quot;Faba_Tach_brac\&quot;, \&quot;Faba_Tach_guia\&quot;, \&quot;Faba_Tach_meli\&quot;, \&quot;Faba_Tach_pani\&quot;, &quot;   
##  [77] &quot;\&quot;Faba_Tach_para\&quot;, \&quot;Faba_Vata_eryt\&quot;, \&quot;Faba_Vata_suri\&quot;, \&quot;Faba_Voua_amer\&quot;, &quot;   
##  [78] &quot;\&quot;Faba_Zygi_race\&quot;, \&quot;Faba_Zygi_tetr\&quot;, \&quot;Humi_Humi_subc\&quot;, \&quot;Humi_Saco_guia\&quot;, &quot;   
##  [79] &quot;\&quot;Humi_Vant_parv\&quot;, \&quot;Icac_Dend_boli\&quot;, \&quot;Icac_Emmo_fagi\&quot;, \&quot;Icac_Pora_guia\&quot;, &quot;   
##  [80] &quot;\&quot;Ixon_Cyri_para\&quot;, \&quot;Laur_Aiou_long\&quot;, \&quot;Laur_Anib_host\&quot;, \&quot;Laur_Anib_term\&quot;, &quot;   
##  [81] &quot;\&quot;Laur_Endl_meli\&quot;, \&quot;Laur_IND_sp_1\&quot;, \&quot;Laur_IND_sp_2\&quot;, \&quot;Laur_IND_sp_3\&quot;, &quot;      
##  [82] &quot;\&quot;Laur_IND_sp_4\&quot;, \&quot;Laur_IND_sp_5\&quot;, \&quot;Laur_IND_sp_6\&quot;, \&quot;Laur_IND_sp_7\&quot;, &quot;       
##  [83] &quot;\&quot;Laur_IND_sp_8\&quot;, \&quot;Laur_IND_sp_9\&quot;, \&quot;Laur_IND_sp_10\&quot;, \&quot;Laur_IND_sp_11\&quot;, &quot;     
##  [84] &quot;\&quot;Laur_IND_sp_12\&quot;, \&quot;Laur_IND_sp_13\&quot;, \&quot;Laur_IND_sp_14\&quot;, \&quot;Laur_IND_sp_15\&quot;, &quot;   
##  [85] &quot;\&quot;Laur_IND_sp_16\&quot;, \&quot;Laur_IND_sp_17\&quot;, \&quot;Laur_IND_sp_18\&quot;, \&quot;Laur_IND_sp_19\&quot;, &quot;   
##  [86] &quot;\&quot;Laur_IND_sp_20\&quot;, \&quot;Laur_Lica_cann\&quot;, \&quot;Laur_Lica_chry\&quot;, \&quot;Laur_Lica_guia\&quot;, &quot;   
##  [87] &quot;\&quot;Laur_Ocot_amaz\&quot;, \&quot;Laur_Ocot_argy\&quot;, \&quot;Laur_Ocot_indi\&quot;, \&quot;Laur_Ocot_perc\&quot;, &quot;   
##  [88] &quot;\&quot;Laur_Ocot_sp_\&quot;, \&quot;Laur_Ocot_subt\&quot;, \&quot;Laur_Rhod_gran\&quot;, \&quot;Laur_Rhod_kunt\&quot;, &quot;    
##  [89] &quot;\&quot;Laur_Rhod_rufo\&quot;, \&quot;Laur_Sext_rubr\&quot;, \&quot;Lecy_Cour_caly\&quot;, \&quot;Lecy_Cour_glor\&quot;, &quot;   
##  [90] &quot;\&quot;Lecy_Cour_guia\&quot;, \&quot;Lecy_Cour_mult\&quot;, \&quot;Lecy_Cour_oblo\&quot;, \&quot;Lecy_Esch_char\&quot;, &quot;   
##  [91] &quot;\&quot;Lecy_Esch_cong\&quot;, \&quot;Lecy_Esch_cori\&quot;, \&quot;Lecy_Esch_deco\&quot;, \&quot;Lecy_Esch_gran\&quot;, &quot;   
##  [92] &quot;\&quot;Lecy_Esch_micr\&quot;, \&quot;Lecy_Esch_pedi\&quot;, \&quot;Lecy_Esch_prae\&quot;, \&quot;Lecy_Esch_sago\&quot;, &quot;   
##  [93] &quot;\&quot;Lecy_Esch_simi\&quot;, \&quot;Lecy_Esch_squa\&quot;, \&quot;Lecy_Gust_hexa\&quot;, \&quot;Lecy_IND_sp_\&quot;, &quot;     
##  [94] &quot;\&quot;Lecy_Lecy_char\&quot;, \&quot;Lecy_Lecy_corr\&quot;, \&quot;Lecy_Lecy_holc\&quot;, \&quot;Lecy_Lecy_idat\&quot;, &quot;   
##  [95] &quot;\&quot;Lecy_Lecy_pers\&quot;, \&quot;Lecy_Lecy_poit\&quot;, \&quot;Lecy_Lecy_zabu\&quot;, \&quot;Lina_Hebe_humi\&quot;, &quot;   
##  [96] &quot;\&quot;Loga_Anto_ovat\&quot;, \&quot;Loga_Stry_IND\&quot;, \&quot;Malp_Bunc_sp_\&quot;, \&quot;Malv_Apei_glab\&quot;, &quot;     
##  [97] &quot;\&quot;Malv_Apei_peto\&quot;, \&quot;Malv_Cato_frag\&quot;, \&quot;Malv_Erio_long\&quot;, \&quot;Malv_Erio_sp_1\&quot;, &quot;   
##  [98] &quot;\&quot;Malv_Erio_sp_2\&quot;, \&quot;Malv_IND_sp_1\&quot;, \&quot;Malv_IND_sp_2\&quot;, \&quot;Malv_Lueh_rugo\&quot;, &quot;     
##  [99] &quot;\&quot;Malv_Pach_doli\&quot;, \&quot;Malv_Quar_duck\&quot;, \&quot;Malv_Ster_mult\&quot;, \&quot;Malv_Ster_prur\&quot;, &quot;   
## [100] &quot;\&quot;Malv_Ster_spec\&quot;, \&quot;Malv_Theo_subi\&quot;, \&quot;Marc_Nora_IND\&quot;, \&quot;Mela_Henr_flav\&quot;, &quot;    
## [101] &quot;\&quot;Mela_Mico_acum\&quot;, \&quot;Mela_Mico_sp_\&quot;, \&quot;Mela_Mico_tsch\&quot;, \&quot;Mela_Mour_cras\&quot;, &quot;    
## [102] &quot;\&quot;Mela_Mour_hube\&quot;, \&quot;Meli_Cara_proc\&quot;, \&quot;Meli_Guar_guid\&quot;, \&quot;Meli_Guar_silv\&quot;, &quot;   
## [103] &quot;\&quot;Meli_Tric_cipo\&quot;, \&quot;Meli_Tric_pall\&quot;, \&quot;Meli_Tric_suri\&quot;, \&quot;Moni_Sipa_cris\&quot;, &quot;   
## [104] &quot;\&quot;Moni_Sipa_deci\&quot;, \&quot;Moni_Sipa_pach\&quot;, \&quot;Mora_Baga_guia\&quot;, \&quot;Mora_Bros_guia\&quot;, &quot;   
## [105] &quot;\&quot;Mora_Bros_rube\&quot;, \&quot;Mora_Bros_util\&quot;, \&quot;Mora_Ficu_sp_\&quot;, \&quot;Mora_Heli_pedu\&quot;, &quot;    
## [106] &quot;\&quot;Mora_Heli_tome\&quot;, \&quot;Mora_Maqu_calo\&quot;, \&quot;Mora_Maqu_guia\&quot;, \&quot;Mora_Nauc_guia\&quot;, &quot;   
## [107] &quot;\&quot;Mora_Pere_guia\&quot;, \&quot;Mora_Pere_rubr\&quot;, \&quot;Mora_Trym_amaz\&quot;, \&quot;Mora_Trym_olig\&quot;, &quot;   
## [108] &quot;\&quot;Myri_Irya_host\&quot;, \&quot;Myri_Irya_sago\&quot;, \&quot;Myri_Viro_kwat\&quot;, \&quot;Myri_Viro_mich\&quot;, &quot;   
## [109] &quot;\&quot;Myrt_Euge_coff\&quot;, \&quot;Myrt_Euge_cucu\&quot;, \&quot;Myrt_Euge_cupu\&quot;, \&quot;Myrt_Euge_macr\&quot;, &quot;   
## [110] &quot;\&quot;Myrt_Euge_patr\&quot;, \&quot;Myrt_Euge_pseu\&quot;, \&quot;Myrt_Euge_sp_1\&quot;, \&quot;Myrt_Euge_sp_2\&quot;, &quot;   
## [111] &quot;\&quot;Myrt_Euge_sp_3\&quot;, \&quot;Myrt_Euge_tetr\&quot;, \&quot;Myrt_IND_IND\&quot;, \&quot;Myrt_IND_sp_\&quot;, &quot;       
## [112] &quot;\&quot;Myrt_Myrc_deco\&quot;, \&quot;Myrt_Myrc_magn\&quot;, \&quot;Nyct_Neea_flor\&quot;, \&quot;Nyct_Neea_sp_\&quot;, &quot;    
## [113] &quot;\&quot;Olac_Chau_kapp\&quot;, \&quot;Olac_Heis_dens\&quot;, \&quot;Olac_Minq_guia\&quot;, \&quot;Olac_Ptyc_olac\&quot;, &quot;   
## [114] &quot;\&quot;Opil_Agon_silv\&quot;, \&quot;Poly_Cocc_moll\&quot;, \&quot;Quii_Lacu_cren\&quot;, \&quot;Quii_Lacu_jenm\&quot;, &quot;   
## [115] &quot;\&quot;Quii_Quii_guia\&quot;, \&quot;Rubi_Amai_guia\&quot;, \&quot;Rubi_Chim_turb\&quot;, \&quot;Rubi_Duro_aqua\&quot;, &quot;   
## [116] &quot;\&quot;Rubi_Duro_erio\&quot;, \&quot;Rubi_Duro_long\&quot;, \&quot;Rubi_Fara_pedu\&quot;, \&quot;Rubi_Guet_acre\&quot;, &quot;   
## [117] &quot;\&quot;Rubi_IND_IND\&quot;, \&quot;Rubi_Poso_lati\&quot;, \&quot;Rubi_Psyc_mapo\&quot;, \&quot;Sali_Case_deca\&quot;, &quot;     
## [118] &quot;\&quot;Sali_Case_javi\&quot;, \&quot;Sali_Case_sylv\&quot;, \&quot;Sapi_Allo_angu\&quot;, \&quot;Sapi_Cupa_diph\&quot;, &quot;   
## [119] &quot;\&quot;Sapi_Cupa_rubi\&quot;, \&quot;Sapi_Cupa_scro\&quot;, \&quot;Sapi_Meli_pedi\&quot;, \&quot;Sapi_Tali_micr\&quot;, &quot;   
## [120] &quot;\&quot;Sapi_Tali_prae\&quot;, \&quot;Sapi_Tali_sima\&quot;, \&quot;Sapi_Voua_guia\&quot;, \&quot;Sapo_Chry_arge\&quot;, &quot;   
## [121] &quot;\&quot;Sapo_Chry_exim\&quot;, \&quot;Sapo_Chry_luce\&quot;, \&quot;Sapo_Chry_prie\&quot;, \&quot;Sapo_Chry_sang\&quot;, &quot;   
## [122] &quot;\&quot;Sapo_Dipl_cusp\&quot;, \&quot;Sapo_Eccl_rami\&quot;, \&quot;Sapo_Elae_nuda\&quot;, \&quot;Sapo_Elae_sp_\&quot;, &quot;    
## [123] &quot;\&quot;Sapo_Mani_bide\&quot;, \&quot;Sapo_Mani_hube\&quot;, \&quot;Sapo_Micr_caye\&quot;, \&quot;Sapo_Micr_egen\&quot;, &quot;   
## [124] &quot;\&quot;Sapo_Micr_guya\&quot;, \&quot;Sapo_Micr_long\&quot;, \&quot;Sapo_Micr_obsc\&quot;, \&quot;Sapo_Micr_porp\&quot;, &quot;   
## [125] &quot;\&quot;Sapo_Micr_sanc\&quot;, \&quot;Sapo_Micr_venu\&quot;, \&quot;Sapo_Pout_ambe\&quot;, \&quot;Sapo_Pout_bang\&quot;, &quot;   
## [126] &quot;\&quot;Sapo_Pout_bena\&quot;, \&quot;Sapo_Pout_bilo\&quot;, \&quot;Sapo_Pout_clad\&quot;, \&quot;Sapo_Pout_deco\&quot;, &quot;   
## [127] &quot;\&quot;Sapo_Pout_euge\&quot;, \&quot;Sapo_Pout_fili\&quot;, \&quot;Sapo_Pout_fimb\&quot;, \&quot;Sapo_Pout_gong\&quot;, &quot;   
## [128] &quot;\&quot;Sapo_Pout_guia\&quot;, \&quot;Sapo_Pout_hisp\&quot;, \&quot;Sapo_Pout_jari\&quot;, \&quot;Sapo_Pout_mela\&quot;, &quot;   
## [129] &quot;\&quot;Sapo_Pout_retic\&quot;, \&quot;Sapo_Pout_retin\&quot;, \&quot;Sapo_Pout_sing\&quot;, \&quot;Sapo_Pout_sp_1\&quot;, &quot; 
## [130] &quot;\&quot;Sapo_Pout_sp_2\&quot;, \&quot;Sapo_Pout_sp_3\&quot;, \&quot;Sapo_Pout_tort\&quot;, \&quot;Sapo_Pout_veno\&quot;, &quot;   
## [131] &quot;\&quot;Sapo_Prad_coch\&quot;, \&quot;Sapo_Prad_ptyc\&quot;, \&quot;Sima_Sima_cedr\&quot;, \&quot;Sima_Sima_more\&quot;, &quot;   
## [132] &quot;\&quot;Sima_Sima_poly\&quot;, \&quot;Sima_Sima_amar\&quot;, \&quot;Styr_Styr_sp_\&quot;, \&quot;Symp_Symp_mart\&quot;, &quot;    
## [133] &quot;\&quot;Urti_Cecr_obtu\&quot;, \&quot;Urti_Pour_bico\&quot;, \&quot;Urti_Pour_meli\&quot;, \&quot;Urti_Pour_tome\&quot;, &quot;   
## [134] &quot;\&quot;Urti_Pour_vill\&quot;, \&quot;Viol_Amph_long\&quot;, \&quot;Viol_Leon_glyc\&quot;, \&quot;Voch_Eris_flor\&quot;, &quot;   
## [135] &quot;\&quot;Voch_Eris_unci\&quot;, \&quot;Voch_IND_sp_\&quot;, \&quot;Voch_Qual_rose\&quot;, \&quot;Voch_Ruiz_albi\&quot;&quot;       
## [136] &quot;))&quot;                                                                                 
## 
## $Function
## [1] &quot;mean&quot;
## 
## $Tree
## [1] &quot;Paracou618.Taxonomy&quot;
## 
## $Normalized
## [1] TRUE
## 
## $Cuts
##         1         2         3 
##  2.644706  6.108696 22.039216 
## 
## $Total
## [1] 10.26421
## 
## attr(,&quot;class&quot;)
## [1] &quot;PhyloValue&quot;</code></pre>
<h4>
See also
</h4>
<p><code><a href=#preprocess.tree>Preprocess.Tree</a></code></p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
<div id="preprocess.mc" class="section level2">
<h2>Preprocess.MC</h2>
<a id="Preprocess.MC_alias"></a>
<h3>
Preprocessing of metacommunity data
</h3>
<p class="rd-p">
Calculates summary statistics of a metacommunity
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>Preprocess.MC(Nsi, Wi)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
Nsi
</dt>
<dd class="rd-dd">
A matrix containing abundance data, species in line, communities in column.
</dd>
<dt>
Wi
</dt>
<dd class="rd-dd">
Normalized community weights (sum to 1).
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This is an internal function. It is used by <code><a href=#metacommunity>MetaCommunity</a></code> for real data and <code><a href=#divest>DivEst</a></code> for simulations.
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
An object of class <strong>MetaCommunity</strong>. It is a list:
<dt>
Nsi
</dt>
<dd>
A matrix containing abundance data, species in line, communities in column
</dd>
</p>
<p class="rd-p">
<dt>
Nspecies
</dt>
<dd>
The number of species
</dd>
</p>
<p class="rd-p">
<dt>
Ncommunities
</dt>
<dd>
The number of communities
</dd>
</p>
<p class="rd-p">
<dt>
Wi
</dt>
<dd>
Normalized community weights (sum to 1)
</dd>
</p>
<p class="rd-p">
<dt>
N
</dt>
<dd>
The total number of individuals
</dd>
</p>
<p class="rd-p">
<dt>
Ni
</dt>
<dd>
A vector containing the number of individuals of each community
</dd>
</p>
<p class="rd-p">
<dt>
Ns
</dt>
<dd>
A vector containing the number of individuals of each species
</dd>
</p>
<p class="rd-p">
<dt>
Psi
</dt>
<dd>
A matrix whose columns are the probability vectors of communities (each of them sums to 1)
</dd>
</p>
<p class="rd-p">
<dt>
Ps
</dt>
<dd>
A vector containing the probability vector of the metacommunity
</dd>
</p>
<p class="rd-p">
<dt>
SampleCoverage
</dt>
<dd>
The sample coverage of the metacommunity
</dd>
</p>
<p class="rd-p">
<dt>
SampleCoverage.communities
</dt>
<dd>
A vector containing the sample coverages of each community
</dd>
</p>
<p class="rd-p">
</dl>
</p>
<h4>
Author
</h4>
<p>Eric Marcon <a href="mailto:Eric.Marcon@ecofog.gf">Eric.Marcon@ecofog.gf</a></p>
</div>
</div>


      </div>
    </div>
  </div>

  <div id="footer">
    <div class="container">
      <div class="col-md-6">
                <p>&copy; Eric Marcon, 2018</p>
              </div>
      <div class="col-md-6">
        <p class="pull-right">created with <a href="https://github.com/hafen/packagedocs">packagedocs</a>
                  </p>
      </div>
    </div>
  </div>

  
</body>
</html>
