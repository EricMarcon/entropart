<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asymptotic Estimation, Interpolation and Extrapolation • entropart</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Asymptotic Estimation, Interpolation and Extrapolation">
<meta property="og:description" content="">
<meta property="og:image" content="https://ericmarcon.github.io/entropart/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">entropart</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.5.3.9011</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/entropart.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/extrapolation.html">Asymptotic Estimation, Interpolation and Extrapolation </a>
    </li>
    <li>
      <a href="../../articles/articles/phylogenies.html">Phylogenies in entropart</a>
    </li>
    <li>
      <a href="../../articles/articles/reference.html">entropart Package Reference</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EricMarcon/entropart">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Asymptotic Estimation, Interpolation and Extrapolation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EricMarcon/entropart/blob/master/vignettes/articles/extrapolation.Rmd"><code>vignettes/articles/extrapolation.Rmd</code></a></small>
      <div class="hidden name"><code>extrapolation.Rmd</code></div>

    </div>

    
    
<p>Estimation of diversity in <em>entropart</em> relies on classical assumptions that are recalled here. The observed data is a sample of a community (or several communities if data is a meta-community). All “reduced-bias estimator” are asymptotic estimators of the community diversity: if the sample size could be extended infinitely, diversity would tend to the diversity of the whole (asymptotic) community. In hyperdiverse ecosystems such as evergreen forests, the asymptotic community generally does not exist in the field because of environmental variations: increasing the size of the sample results in sampling in different communities. Thus, the asymptotic estimators of diversity correspond to theoretical aymptotic communities that do not necessarily exist. In other words, the asymptotic diversity is that of a community that would provide the observed sample.</p>
<p>Diversity is accumulated as a function of sample size. HCDT entropy (thus Hill numbers and phylodiversity) can be estimated at any sample size, by interpolation down from the actual sample size and by extrapolation up to infinite sample size, i.e. the asymptotic estimator. Alternatively, sample size may be replaced by sample coverage, by interpolation from arbitrary small sample coverages to that of the actual sample, and by extrapolation up to the asymptotic estimator whose sample coverage is 1.</p>
<div id="asymptotic-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#asymptotic-estimation" class="anchor"></a>Asymptotic estimation</h1>
<p>If community data is a vector of probabilities, sample size is unknown so the only available estimation is that of the actual sample.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"entropart"</span>)</code></pre></div>
<pre><code>## Le chargement a nécessité le package : ggplot2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"Paracou618"</span>)
<span class="co"># 2 ha of tropical forest, distribution of probabilities</span>
ParacouP &lt;-<span class="st"> </span>Paracou618.MC<span class="op">$</span>Ps
<span class="co"># Diversity of order 1, no reduce-bias estimator used.</span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouP, <span class="dt">q=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>##   None 
## 113.98</code></pre>
<p>Further estimation requires abundance vectors, i.e. the number of individuals per species. Then, the default estimator is the asymptotic one.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 2 ha of tropical forest, distribution of abundances</span>
ParacouN &lt;-<span class="st"> </span>Paracou618.MC<span class="op">$</span>Ns
<span class="co"># Diversity of order 1, best asymptotic estimator used.</span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>##  UnveilJ 
## 138.1078</code></pre>
<p>Several asymptotic estimators are available in the literature and implemented in <em>entropart</em>. For consistency, <em>entropart</em> uses the jackknife estimator of richness and the unveiled jackknife estimator for entropy. The advantage of these estimators is that they provide reliable estimations even though the sampling effort is low: then, the estimation variance increases but its bias remains acceptable because the order of the jackknife estimator is chosen according to the data. Poorly-sampled communities are estimated by a higher-order jackknife, resulting in higher estimation variance.</p>
<p>For well-sampled communities, i.e. in the domain of validity of the jacknife of order 1, The Chao1 estimator of diversity and the Chao-Jost estimator of entropy are the best choices because they have the best mathematical support, but they will severely underestimate the diversity of poorly-sampled communities. They also are more computer-intensive.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Estimation of richness relies on jackknife 2 (poor sampling)</span>
<span class="kw"><a href="../../reference/Richness.html">Richness</a></span>(ParacouN)</code></pre></div>
<pre><code>## Jackknife 2 
##         359</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Richness is underestimated by Chao1 estimator</span>
<span class="kw"><a href="../../reference/Richness.html">Richness</a></span>(ParacouN, <span class="dt">Correction=</span><span class="st">"Chao1"</span>)</code></pre></div>
<pre><code>##    Chao1 
## 314.9348</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Diversity of order 1 underestimated by Chao-Jost estimator</span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>, <span class="dt">Correction=</span><span class="st">"ChaoJost"</span>)</code></pre></div>
<pre><code>## ChaoJost 
## 133.2409</code></pre>
</div>
<div id="choosing-the-estimation-level" class="section level1">
<h1 class="hasAnchor">
<a href="#choosing-the-estimation-level" class="anchor"></a>Choosing the estimation level</h1>
<p>Asymptotic estimation is not always the best choice, for example when comparing the diversity of poorly-sampled communities: a lower sampe coverage can be chosen to limit the uncertainty of estimation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Actual sample coverage</span>
<span class="kw"><a href="../../reference/Coverage.html">Coverage</a></span>(ParacouN)</code></pre></div>
<pre><code>## ZhangHuang 
##  0.9226675</code></pre>
<p>The estimation level may be a sample size or a sample coverage that is converted internally into a sample size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Diversity at half the sample size (interpolated)</span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>, <span class="dt">Level=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(ParacouN)<span class="op">/</span><span class="dv">2</span>))</code></pre></div>
<pre><code>##  Interp 
## 100.016</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Sample size corresponding to 90% coverage</span>
<span class="kw"><a href="../../reference/Coverage.html">Coverage2Size</a></span>(ParacouN, <span class="dt">SampleCoverage=</span><span class="fl">0.9</span>)</code></pre></div>
<pre><code>## [1] 861</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Diversity at 90% sample coverage</span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>, <span class="dt">Level=</span><span class="fl">0.9</span>)</code></pre></div>
<pre><code>##   Interp 
## 109.1493</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Equal to </span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>, <span class="dt">Level=</span><span class="kw"><a href="../../reference/Coverage.html">Coverage2Size</a></span>(ParacouN, <span class="dt">SampleCoverage=</span><span class="fl">0.9</span>))</code></pre></div>
<pre><code>##   Interp 
## 109.1493</code></pre>
<p>If the sample size is smaller than the actual sample, entropy is interpolated.</p>
<p>If it is higher, entropy must be extrapolated. For diversity orders equal to 0 (richness), 1 (Shannon) or 2 (Simpson), explicit, almost unbiased estimators are used. Continuity of the estimation of diversity around the actual sample size is guaranted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simpson diversity at levels from 0.9 to 1.1 times the sample size</span>
Accumulation2 &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/Accumulation.html">DivAC</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">2</span>, <span class="dt">n.seq=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="fl">0.9</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(ParacouN))<span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(ParacouN)))</code></pre></div>
<pre><code>## ===========================================================================</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(Accumulation2)</code></pre></div>
<p><img src="extrapolation_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>For non-integer orders, things get more complicated. In <em>entropart</em>, asymptotic entropy is estimated by the unveiled jackknife estimator and rarefied down to the actual sample size. There is no reason for it to correspond exactly to the observed entropy. The asymptotic richness is the less robust part of the estimation thus it is adjusted iteratively until the rarefied entropy equals the actual sample’s entropy, ensuring continuity between interpolation and extrapolation.</p>
</div>
<div id="diversity-accumulation" class="section level1">
<h1 class="hasAnchor">
<a href="#diversity-accumulation" class="anchor"></a>Diversity accumulation</h1>
<p>Diversity Accumulation Curves (DAC) are a generalization of the well-known Species Accumumulation Curves (SAC). They represent diversity as a function of sample size.</p>
<p>The <code>DivAc()</code>function allows to build them. A bootstrap confindence interval can be calculated around the estimated DAC by simulating random multinomial draws of the asymtpotic distribution at each sample size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Diversity at levels from 1 to twice the sample size</span>
Accumulation &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/Accumulation.html">DivAC</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>, <span class="dt">n.seq=</span><span class="dv">1</span><span class="op">:</span>(<span class="fl">1.1</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(ParacouN)), <span class="dt">NumberOfSimulations =</span> <span class="dv">1000</span>)</code></pre></div>
<pre><code>## ===========================================================================
                                                                           
===========================================================================</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(Accumulation)</code></pre></div>
<p><img src="extrapolation_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>To ensure continuity of the DAC around the actual sample, the asymptotic diversity is estimated by unveiling the aysmptotic distribution, choosing the number of species such that the rarefied diversity at the observed sample size is the observed diversity. This means that the extrapolated diversity at a high sample coverage will differ from the best asymptotic estimation, sometimes quite much if sampling level is poor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extrapolation at 99.99% sample coverage</span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>, <span class="dt">Level=</span><span class="fl">0.9999</span>)</code></pre></div>
<pre><code>##     Best 
## 128.3196</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Unveiled Jaccknife asymptotic estimator</span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>##  UnveilJ 
## 138.1078</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Chao-Jost estimator</span>
<span class="kw"><a href="../../reference/Diversity.html">Diversity</a></span>(ParacouN, <span class="dt">q=</span><span class="dv">1</span>, <span class="dt">Correction=</span><span class="st">"ChaoJost"</span>)</code></pre></div>
<pre><code>## ChaoJost 
## 133.2409</code></pre>
</div>
<div id="diversity-profiles-at-a-sampling-level" class="section level1">
<h1 class="hasAnchor">
<a href="#diversity-profiles-at-a-sampling-level" class="anchor"></a>Diversity profiles at a sampling level</h1>
<p>Diversity profiles are usually asymptotic but they can be calculated at any coverage of sampling level.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Diversity at levels from 1 to twice the sample size</span>
Profile &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/CommunityProfile.html">CommunityProfile</a></span>(Diversity, ParacouN, <span class="dt">Level=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(ParacouN)<span class="op">*</span><span class="fl">1.5</span>)
<span class="kw">autoplot</span>(Profile)</code></pre></div>
<p><img src="extrapolation_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Extrapolated diversity is estimated at each order such that it is continuous at the observed sample size.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#asymptotic-estimation">Asymptotic estimation</a></li>
      <li><a href="#choosing-the-estimation-level">Choosing the estimation level</a></li>
      <li><a href="#diversity-accumulation">Diversity accumulation</a></li>
      <li><a href="#diversity-profiles-at-a-sampling-level">Diversity profiles at a sampling level</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Eric Marcon, Bruno Herault.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
